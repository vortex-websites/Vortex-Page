{
  "version": 3,
  "sources": ["../../posthog-js/src/config.ts", "../../posthog-js/src/utils.ts", "../../posthog-js/src/autocapture-utils.ts", "../../posthog-js/src/extensions/rageclick.ts", "../../posthog-js/src/storage.ts", "../../posthog-js/src/posthog-persistence.ts", "../../posthog-js/src/autocapture.ts", "../../posthog-js/src/gdpr-utils.ts", "../../posthog-js/src/posthog-people.ts", "../../posthog-js/src/posthog-featureflags.ts", "../../posthog-js/src/extensions/sessionrecording-utils.ts", "../../posthog-js/src/extensions/sessionrecording.ts", "../../posthog-js/src/extensions/web-performance.ts", "../../posthog-js/src/decide.ts", "../../posthog-js/src/extensions/cloud.ts", "../../posthog-js/src/extensions/toolbar.ts", "../../posthog-js/src/base-request-queue.ts", "../../posthog-js/src/request-queue.ts", "../../posthog-js/src/capture-metrics.ts", "../../posthog-js/node_modules/fflate/esm/browser.js", "../../posthog-js/src/types.ts", "../../posthog-js/src/send-request.ts", "../../posthog-js/src/retry-queue.ts", "../../posthog-js/src/sessionid.ts", "../../posthog-js/src/extensions/sentry-integration.ts", "../../posthog-js/src/extensions/segment-integration.ts", "../../posthog-js/src/page-view-id.ts", "../../posthog-js/src/extensions/exceptions/type-checking.ts", "../../posthog-js/src/extensions/exceptions/stack-trace.ts", "../../posthog-js/src/extensions/exceptions/error-conversion.ts", "../../posthog-js/src/extensions/exceptions/exception-autocapture.ts", "../../posthog-js/src/posthog-core.ts", "../../posthog-js/src/compression.ts", "../../posthog-js/src/loader-module.ts", "dep:posthog-js"],
  "sourcesContent": ["import { version } from '../package.json'\n\n// overriden in posthog-core,\n// e.g.     Config.DEBUG = Config.DEBUG || instance.get_config('debug')\nconst Config = {\n    DEBUG: false,\n    LIB_VERSION: version,\n}\n\nexport default Config\n", "import Config from './config'\nimport { Breaker, EventHandler, Properties } from './types'\n\n/*\n * Saved references to long variable names, so that closure compiler can\n * minimize file size.\n */\n\nconst ArrayProto = Array.prototype\nconst ObjProto = Object.prototype\nconst toString = ObjProto.toString\nconst hasOwnProperty = ObjProto.hasOwnProperty\nconst win: Window & typeof globalThis = typeof window !== 'undefined' ? window : ({} as typeof window)\nconst navigator = win.navigator || { userAgent: '' }\nconst document = win.document || {}\nconst userAgent = navigator.userAgent\nconst localDomains = ['localhost', '127.0.0.1']\n\nconst nativeForEach = ArrayProto.forEach,\n    nativeIndexOf = ArrayProto.indexOf,\n    nativeIsArray = Array.isArray,\n    breaker: Breaker = {}\n\n// Console override\nconst logger = {\n    /** @type {function(...*)} */\n    log: function (...args: any[]) {\n        if (Config.DEBUG && !_isUndefined(window.console) && window.console) {\n            // Don't log PostHog debug messages in rrweb\n            const log =\n                '__rrweb_original__' in window.console.log\n                    ? (window.console.log as any)['__rrweb_original__']\n                    : window.console.log\n\n            try {\n                log.apply(window.console, args)\n            } catch (err) {\n                _eachArray(args, function (arg) {\n                    log(arg)\n                })\n            }\n        }\n    },\n    /** @type {function(...*)} */\n    error: function (..._args: any[]) {\n        if (Config.DEBUG && !_isUndefined(window.console) && window.console) {\n            const args = ['PostHog error:', ..._args]\n            // Don't log PostHog debug messages in rrweb\n            const error =\n                '__rrweb_original__' in window.console.error\n                    ? (window.console.error as any)['__rrweb_original__']\n                    : window.console.error\n            try {\n                error.apply(window.console, args)\n            } catch (err) {\n                _eachArray(args, function (arg) {\n                    error(arg)\n                })\n            }\n        }\n    },\n    /** @type {function(...*)} */\n    critical: function (..._args: any[]) {\n        if (!_isUndefined(window.console) && window.console) {\n            const args = ['PostHog error:', ..._args]\n            // Don't log PostHog debug messages in rrweb\n            const error =\n                '__rrweb_original__' in window.console.error\n                    ? (window.console.error as any)['__rrweb_original__']\n                    : window.console.error\n            try {\n                error.apply(window.console, args)\n            } catch (err) {\n                _eachArray(args, function (arg) {\n                    error(arg)\n                })\n            }\n        }\n    },\n}\n\n// UNDERSCORE\n// Embed part of the Underscore Library\nexport const _trim = function (str: string): string {\n    return str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '')\n}\n\nexport const _bind_instance_methods = function (obj: Record<string, any>): void {\n    for (const func in obj) {\n        if (typeof obj[func] === 'function') {\n            obj[func] = obj[func].bind(obj)\n        }\n    }\n}\n\nexport function _eachArray<E = any>(\n    obj: E[] | null | undefined,\n    iterator: (value: E, key: number) => void | Breaker,\n    thisArg?: any\n): void {\n    if (Array.isArray(obj)) {\n        if (nativeForEach && obj.forEach === nativeForEach) {\n            obj.forEach(iterator, thisArg)\n        } else if ('length' in obj && obj.length === +obj.length) {\n            for (let i = 0, l = obj.length; i < l; i++) {\n                if (i in obj && iterator.call(thisArg, obj[i], i) === breaker) {\n                    return\n                }\n            }\n        }\n    }\n}\n\n/**\n * @param {*=} obj\n * @param {function(...*)=} iterator\n * @param {Object=} thisArg\n */\nexport function _each(obj: any, iterator: (value: any, key: any) => void | Breaker, thisArg?: any): void {\n    if (obj === null || obj === undefined) {\n        return\n    }\n    if (Array.isArray(obj)) {\n        return _eachArray(obj, iterator, thisArg)\n    }\n    for (const key in obj) {\n        if (hasOwnProperty.call(obj, key)) {\n            if (iterator.call(thisArg, obj[key], key) === breaker) {\n                return\n            }\n        }\n    }\n}\n\nexport const _extend = function (obj: Record<string, any>, ...args: Record<string, any>[]): Record<string, any> {\n    _eachArray(args, function (source) {\n        for (const prop in source) {\n            if (source[prop] !== void 0) {\n                obj[prop] = source[prop]\n            }\n        }\n    })\n    return obj\n}\n\nexport const _isArray =\n    nativeIsArray ||\n    function (obj: any): obj is any[] {\n        return toString.call(obj) === '[object Array]'\n    }\n\n// from a comment on http://dbj.org/dbj/?p=286\n// fails on only one very rare and deliberate custom object:\n// let bomb = { toString : undefined, valueOf: function(o) { return \"function BOMBA!\"; }};\nexport const _isFunction = function (f: any): f is (...args: any[]) => any {\n    try {\n        return /^\\s*\\bfunction\\b/.test(f)\n    } catch (x) {\n        return false\n    }\n}\n\nexport const _include = function (\n    obj: null | string | Array<any> | Record<string, any>,\n    target: any\n): boolean | Breaker {\n    let found = false\n    if (obj === null) {\n        return found\n    }\n    if (nativeIndexOf && obj.indexOf === nativeIndexOf) {\n        return obj.indexOf(target) != -1\n    }\n    _each(obj, function (value) {\n        if (found || (found = value === target)) {\n            return breaker\n        }\n        return\n    })\n    return found\n}\n\nexport function _includes<T = any>(str: T[] | string, needle: T): boolean {\n    return (str as any).indexOf(needle) !== -1\n}\n\n/**\n * Object.entries() polyfill\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/entries\n */\nexport function _entries<T = any>(obj: Record<string, T>): [string, T][] {\n    const ownProps = Object.keys(obj)\n    let i = ownProps.length\n    const resArray = new Array(i) // preallocate the Array\n\n    while (i--) {\n        resArray[i] = [ownProps[i], obj[ownProps[i]]]\n    }\n    return resArray\n}\n\n// Underscore Addons\nexport const _isObject = function (obj: any): obj is Record<string, any> {\n    return obj === Object(obj) && !_isArray(obj)\n}\n\nexport const _isEmptyObject = function (obj: any): obj is Record<string, any> {\n    if (_isObject(obj)) {\n        for (const key in obj) {\n            if (hasOwnProperty.call(obj, key)) {\n                return false\n            }\n        }\n        return true\n    }\n    return false\n}\n\nexport const _isUndefined = function (obj: any): obj is undefined {\n    return obj === void 0\n}\n\nexport const _isString = function (obj: any): obj is string {\n    return toString.call(obj) == '[object String]'\n}\n\nexport const _isDate = function (obj: any): obj is Date {\n    return toString.call(obj) == '[object Date]'\n}\n\nexport const _isNumber = function (obj: any): obj is number {\n    return toString.call(obj) == '[object Number]'\n}\n\nexport const _encodeDates = function (obj: Properties): Properties {\n    _each(obj, function (v, k) {\n        if (_isDate(v)) {\n            obj[k] = _formatDate(v)\n        } else if (_isObject(v)) {\n            obj[k] = _encodeDates(v) // recurse\n        }\n    })\n    return obj\n}\n\nexport const _timestamp = function (): number {\n    Date.now =\n        Date.now ||\n        function () {\n            return +new Date()\n        }\n    return Date.now()\n}\n\nexport const _formatDate = function (d: Date): string {\n    // YYYY-MM-DDTHH:MM:SS in UTC\n    function pad(n: number) {\n        return n < 10 ? '0' + n : n\n    }\n    return (\n        d.getUTCFullYear() +\n        '-' +\n        pad(d.getUTCMonth() + 1) +\n        '-' +\n        pad(d.getUTCDate()) +\n        'T' +\n        pad(d.getUTCHours()) +\n        ':' +\n        pad(d.getUTCMinutes()) +\n        ':' +\n        pad(d.getUTCSeconds())\n    )\n}\n\nexport const _safewrap = function <F extends (...args: any[]) => any = (...args: any[]) => any>(f: F): F {\n    return function (...args) {\n        try {\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            return f.apply(this, args)\n        } catch (e) {\n            logger.critical('Implementation error. Please turn on debug and contact support@posthog.com.')\n            logger.critical(e)\n        }\n    } as F\n}\n\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport const _safewrap_class = function (klass: Function, functions: string[]): void {\n    for (let i = 0; i < functions.length; i++) {\n        klass.prototype[functions[i]] = _safewrap(klass.prototype[functions[i]])\n    }\n}\n\nexport const _safewrap_instance_methods = function (obj: Record<string, any>): void {\n    for (const func in obj) {\n        if (typeof obj[func] === 'function') {\n            obj[func] = _safewrap(obj[func])\n        }\n    }\n}\n\nexport const _strip_empty_properties = function (p: Properties): Properties {\n    const ret: Properties = {}\n    _each(p, function (v, k) {\n        if (_isString(v) && v.length > 0) {\n            ret[k] = v\n        }\n    })\n    return ret\n}\n\n/**\n * Deep copies an object.\n * It handles cycles by replacing all references to them with `undefined`\n * Also supports customizing native values\n *\n * @param value\n * @param customizer\n * @returns {{}|undefined|*}\n */\nfunction deepCircularCopy<T extends Record<string, any> = Record<string, any>>(\n    value: T,\n    customizer?: <K extends keyof T = keyof T>(value: T[K], key?: K) => T[K]\n): T | undefined {\n    const COPY_IN_PROGRESS_SET = new Set()\n\n    function internalDeepCircularCopy(value: T, key?: string): T | undefined {\n        if (value !== Object(value)) return customizer ? customizer(value as any, key) : value // primitive value\n\n        if (COPY_IN_PROGRESS_SET.has(value)) return undefined\n        COPY_IN_PROGRESS_SET.add(value)\n        let result: T\n\n        if (_isArray(value)) {\n            result = [] as any as T\n            _eachArray(value, (it) => {\n                result.push(internalDeepCircularCopy(it))\n            })\n        } else {\n            result = {} as T\n            _each(value, (val, key) => {\n                if (!COPY_IN_PROGRESS_SET.has(val)) {\n                    ;(result as any)[key] = internalDeepCircularCopy(val, key)\n                }\n            })\n        }\n        return result\n    }\n    return internalDeepCircularCopy(value)\n}\n\nconst LONG_STRINGS_ALLOW_LIST = ['$performance_raw']\n\nexport function _copyAndTruncateStrings<T extends Record<string, any> = Record<string, any>>(\n    object: T,\n    maxStringLength: number | null\n): T {\n    return deepCircularCopy(object, (value: any, key) => {\n        if (key && LONG_STRINGS_ALLOW_LIST.indexOf(key as string) > -1) {\n            return value\n        }\n        if (typeof value === 'string' && maxStringLength !== null) {\n            return (value as string).slice(0, maxStringLength)\n        }\n        return value\n    }) as T\n}\n\nexport function _base64Encode(data: null): null\nexport function _base64Encode(data: undefined): undefined\nexport function _base64Encode(data: string): string\nexport function _base64Encode(data: string | null | undefined): string | null | undefined {\n    const b64 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='\n    let o1,\n        o2,\n        o3,\n        h1,\n        h2,\n        h3,\n        h4,\n        bits,\n        i = 0,\n        ac = 0,\n        enc = ''\n    const tmp_arr: string[] = []\n\n    if (!data) {\n        return data\n    }\n\n    data = _utf8Encode(data)\n\n    do {\n        // pack three octets into four hexets\n        o1 = data.charCodeAt(i++)\n        o2 = data.charCodeAt(i++)\n        o3 = data.charCodeAt(i++)\n\n        bits = (o1 << 16) | (o2 << 8) | o3\n\n        h1 = (bits >> 18) & 0x3f\n        h2 = (bits >> 12) & 0x3f\n        h3 = (bits >> 6) & 0x3f\n        h4 = bits & 0x3f\n\n        // use hexets to index into b64, and append result to encoded string\n        tmp_arr[ac++] = b64.charAt(h1) + b64.charAt(h2) + b64.charAt(h3) + b64.charAt(h4)\n    } while (i < data.length)\n\n    enc = tmp_arr.join('')\n\n    switch (data.length % 3) {\n        case 1:\n            enc = enc.slice(0, -2) + '=='\n            break\n        case 2:\n            enc = enc.slice(0, -1) + '='\n            break\n    }\n\n    return enc\n}\n\nexport const _utf8Encode = function (string: string): string {\n    string = (string + '').replace(/\\r\\n/g, '\\n').replace(/\\r/g, '\\n')\n\n    let utftext = '',\n        start,\n        end\n    let stringl = 0,\n        n\n\n    start = end = 0\n    stringl = string.length\n\n    for (n = 0; n < stringl; n++) {\n        const c1 = string.charCodeAt(n)\n        let enc = null\n\n        if (c1 < 128) {\n            end++\n        } else if (c1 > 127 && c1 < 2048) {\n            enc = String.fromCharCode((c1 >> 6) | 192, (c1 & 63) | 128)\n        } else {\n            enc = String.fromCharCode((c1 >> 12) | 224, ((c1 >> 6) & 63) | 128, (c1 & 63) | 128)\n        }\n        if (enc !== null) {\n            if (end > start) {\n                utftext += string.substring(start, end)\n            }\n            utftext += enc\n            start = end = n + 1\n        }\n    }\n\n    if (end > start) {\n        utftext += string.substring(start, string.length)\n    }\n\n    return utftext\n}\n\nexport const _UUID = (function () {\n    // Time/ticks information\n    // 1*new Date() is a cross browser version of Date.now()\n    const T = function () {\n        const d = new Date().valueOf()\n        let i = 0\n\n        // this while loop figures how many browser ticks go by\n        // before 1*new Date() returns a new number, ie the amount\n        // of ticks that go by per millisecond\n        while (d == new Date().valueOf()) {\n            i++\n        }\n\n        return d.toString(16) + i.toString(16)\n    }\n\n    // Math.Random entropy\n    const R = function () {\n        return Math.random().toString(16).replace('.', '')\n    }\n\n    // User agent entropy\n    // This function takes the user agent string, and then xors\n    // together each sequence of 8 bytes.  This produces a final\n    // sequence of 8 bytes which it returns as hex.\n    const UA = function () {\n        const ua = userAgent\n        let i,\n            ch,\n            ret = 0,\n            buffer: number[] = []\n\n        function xor(result: number, byte_array: number[]) {\n            let j,\n                tmp = 0\n            for (j = 0; j < byte_array.length; j++) {\n                tmp |= buffer[j] << (j * 8)\n            }\n            return result ^ tmp\n        }\n\n        for (i = 0; i < ua.length; i++) {\n            ch = ua.charCodeAt(i)\n            buffer.unshift(ch & 0xff)\n            if (buffer.length >= 4) {\n                ret = xor(ret, buffer)\n                buffer = []\n            }\n        }\n\n        if (buffer.length > 0) {\n            ret = xor(ret, buffer)\n        }\n\n        return ret.toString(16)\n    }\n\n    return function () {\n        const se = typeof window !== 'undefined' ? (window.screen.height * window.screen.width).toString(16) : '0'\n        return T() + '-' + R() + '-' + UA() + '-' + se + '-' + T()\n    }\n})()\n\n// _.isBlockedUA()\n// This is to block various web spiders from executing our JS and\n// sending false capturing data\nexport const _isBlockedUA = function (ua: string): boolean {\n    if (\n        /(google web preview|baiduspider|yandexbot|bingbot|googlebot|yahoo! slurp|ahrefsbot|facebookexternalhit|facebookcatalog|applebot|semrushbot|duckduckbot|twitterbot|rogerbot|linkedinbot|mj12bot|sitebulb|bot.htm|bot.php|hubspot|crawler)/i.test(\n            ua\n        )\n    ) {\n        return true\n    }\n    return false\n}\n\n/**\n * @param {Object=} formdata\n * @param {string=} arg_separator\n */\nexport const _HTTPBuildQuery = function (formdata: Record<string, any>, arg_separator = '&'): string {\n    let use_val: string\n    let use_key: string\n    const tph_arr: string[] = []\n\n    _each(formdata, function (val, key) {\n        use_val = encodeURIComponent(val.toString())\n        use_key = encodeURIComponent(key)\n        tph_arr[tph_arr.length] = use_key + '=' + use_val\n    })\n\n    return tph_arr.join(arg_separator)\n}\n\nexport const _getQueryParam = function (url: string, param: string): string {\n    // Expects a raw URL\n\n    const cleanParam = param.replace(/[[]/, '\\\\[').replace(/[\\]]/, '\\\\]')\n    const regexS = '[\\\\?&]' + cleanParam + '=([^&#]*)'\n    const regex = new RegExp(regexS)\n    const results = regex.exec(url)\n    if (results === null || (results && typeof results[1] !== 'string' && (results[1] as any).length)) {\n        return ''\n    } else {\n        let result = results[1]\n        try {\n            result = decodeURIComponent(result)\n        } catch (err) {\n            logger.error('Skipping decoding for malformed query param: ' + result)\n        }\n        return result.replace(/\\+/g, ' ')\n    }\n}\n\nexport const _getHashParam = function (hash: string, param: string): string | null {\n    const matches = hash.match(new RegExp(param + '=([^&]*)'))\n    return matches ? matches[1] : null\n}\n\nexport const _register_event = (function () {\n    // written by Dean Edwards, 2005\n    // with input from Tino Zijdel - crisp@xs4all.nl\n    // with input from Carl Sverre - mail@carlsverre.com\n    // with input from PostHog\n    // http://dean.edwards.name/weblog/2005/10/add-event/\n    // https://gist.github.com/1930440\n\n    /**\n     * @param {Object} element\n     * @param {string} type\n     * @param {function(...*)} handler\n     * @param {boolean=} oldSchool\n     * @param {boolean=} useCapture\n     */\n    const register_event = function (\n        element: Element | Window | Document | Node,\n        type: string,\n        handler: EventHandler,\n        oldSchool?: boolean,\n        useCapture?: boolean\n    ) {\n        if (!element) {\n            logger.error('No valid element provided to register_event')\n            return\n        }\n\n        if (element.addEventListener && !oldSchool) {\n            element.addEventListener(type, handler, !!useCapture)\n        } else {\n            const ontype = 'on' + type\n            const old_handler = (element as any)[ontype] // can be undefined\n            ;(element as any)[ontype] = makeHandler(element, handler, old_handler)\n        }\n    }\n\n    function makeHandler(\n        element: Element | Window | Document | Node,\n        new_handler: EventHandler,\n        old_handlers: EventHandler\n    ) {\n        return function (event: Event): boolean | void {\n            event = event || fixEvent(window.event)\n\n            // this basically happens in firefox whenever another script\n            // overwrites the onload callback and doesn't pass the event\n            // object to previously defined callbacks.  All the browsers\n            // that don't define window.event implement addEventListener\n            // so the dom_loaded handler will still be fired as usual.\n            if (!event) {\n                return undefined\n            }\n\n            let ret = true\n            let old_result: any\n\n            if (_isFunction(old_handlers)) {\n                old_result = old_handlers(event)\n            }\n            const new_result = new_handler.call(element, event)\n\n            if (false === old_result || false === new_result) {\n                ret = false\n            }\n\n            return ret\n        }\n    }\n\n    function fixEvent(event: Event | undefined): Event | undefined {\n        if (event) {\n            event.preventDefault = fixEvent.preventDefault\n            event.stopPropagation = fixEvent.stopPropagation\n        }\n        return event\n    }\n    fixEvent.preventDefault = function () {\n        ;(this as any as Event).returnValue = false\n    }\n    fixEvent.stopPropagation = function () {\n        ;(this as any as Event).cancelBubble = true\n    }\n\n    return register_event\n})()\n\nexport const isLocalhost = (): boolean => {\n    return localDomains.includes(location.hostname)\n}\n\nexport function loadScript(scriptUrlToLoad: string, callback: (error?: string | Event, event?: Event) => void): void {\n    const addScript = () => {\n        const scriptTag = document.createElement('script')\n        scriptTag.type = 'text/javascript'\n        scriptTag.src = scriptUrlToLoad\n        scriptTag.onload = (event) => callback(undefined, event)\n        scriptTag.onerror = (error) => callback(error)\n\n        const scripts = document.querySelectorAll('body > script')\n        if (scripts.length > 0) {\n            scripts[0].parentNode?.insertBefore(scriptTag, scripts[0])\n        } else {\n            // In exceptional situations this call might load before the DOM is fully ready.\n            document.body.appendChild(scriptTag)\n        }\n    }\n\n    if (document.body) {\n        addScript()\n    } else {\n        document.addEventListener('DOMContentLoaded', addScript)\n    }\n}\n\nexport const _info = {\n    campaignParams: function (customParams?: string[]): Record<string, any> {\n        const campaign_keywords = [\n            'utm_source',\n            'utm_medium',\n            'utm_campaign',\n            'utm_content',\n            'utm_term',\n            'gclid',\n            'fbclid',\n            'msclkid',\n        ].concat(customParams || [])\n\n        const params: Record<string, any> = {}\n        _each(campaign_keywords, function (kwkey) {\n            const kw = _getQueryParam(document.URL, kwkey)\n            if (kw.length) {\n                params[kwkey] = kw\n            }\n        })\n\n        return params\n    },\n\n    searchEngine: function (): string | null {\n        const referrer = document.referrer\n        if (!referrer) {\n            return null\n        } else if (referrer.search('https?://(.*)google.([^/?]*)') === 0) {\n            return 'google'\n        } else if (referrer.search('https?://(.*)bing.com') === 0) {\n            return 'bing'\n        } else if (referrer.search('https?://(.*)yahoo.com') === 0) {\n            return 'yahoo'\n        } else if (referrer.search('https?://(.*)duckduckgo.com') === 0) {\n            return 'duckduckgo'\n        } else {\n            return null\n        }\n    },\n\n    searchInfo: function (): Record<string, any> {\n        const search = _info.searchEngine(),\n            param = search != 'yahoo' ? 'q' : 'p',\n            ret: Record<string, any> = {}\n\n        if (search !== null) {\n            ret['$search_engine'] = search\n\n            const keyword = _getQueryParam(document.referrer, param)\n            if (keyword.length) {\n                ret['ph_keyword'] = keyword\n            }\n        }\n\n        return ret\n    },\n\n    /**\n     * This function detects which browser is running this script.\n     * The order of the checks are important since many user agents\n     * include key words used in later checks.\n     */\n    browser: function (user_agent: string, vendor: string, opera?: any): string {\n        vendor = vendor || '' // vendor is undefined for at least IE9\n        if (opera || _includes(user_agent, ' OPR/')) {\n            if (_includes(user_agent, 'Mini')) {\n                return 'Opera Mini'\n            }\n            return 'Opera'\n        } else if (/(BlackBerry|PlayBook|BB10)/i.test(user_agent)) {\n            return 'BlackBerry'\n        } else if (_includes(user_agent, 'IEMobile') || _includes(user_agent, 'WPDesktop')) {\n            return 'Internet Explorer Mobile'\n        } else if (_includes(user_agent, 'SamsungBrowser/')) {\n            // https://developer.samsung.com/internet/user-agent-string-format\n            return 'Samsung Internet'\n        } else if (_includes(user_agent, 'Edge') || _includes(user_agent, 'Edg/')) {\n            return 'Microsoft Edge'\n        } else if (_includes(user_agent, 'FBIOS')) {\n            return 'Facebook Mobile'\n        } else if (_includes(user_agent, 'Chrome')) {\n            return 'Chrome'\n        } else if (_includes(user_agent, 'CriOS')) {\n            return 'Chrome iOS'\n        } else if (_includes(user_agent, 'UCWEB') || _includes(user_agent, 'UCBrowser')) {\n            return 'UC Browser'\n        } else if (_includes(user_agent, 'FxiOS')) {\n            return 'Firefox iOS'\n        } else if (_includes(vendor, 'Apple')) {\n            if (_includes(user_agent, 'Mobile')) {\n                return 'Mobile Safari'\n            }\n            return 'Safari'\n        } else if (_includes(user_agent, 'Android')) {\n            return 'Android Mobile'\n        } else if (_includes(user_agent, 'Konqueror')) {\n            return 'Konqueror'\n        } else if (_includes(user_agent, 'Firefox')) {\n            return 'Firefox'\n        } else if (_includes(user_agent, 'MSIE') || _includes(user_agent, 'Trident/')) {\n            return 'Internet Explorer'\n        } else if (_includes(user_agent, 'Gecko')) {\n            return 'Mozilla'\n        } else {\n            return ''\n        }\n    },\n\n    /**\n     * This function detects which browser version is running this script,\n     * parsing major and minor version (e.g., 42.1). User agent strings from:\n     * http://www.useragentstring.com/pages/useragentstring.php\n     */\n    browserVersion: function (userAgent: string, vendor: string, opera: string): number | null {\n        const browser = _info.browser(userAgent, vendor, opera)\n        const versionRegexs = {\n            'Internet Explorer Mobile': /rv:(\\d+(\\.\\d+)?)/,\n            'Microsoft Edge': /Edge?\\/(\\d+(\\.\\d+)?)/,\n            Chrome: /Chrome\\/(\\d+(\\.\\d+)?)/,\n            'Chrome iOS': /CriOS\\/(\\d+(\\.\\d+)?)/,\n            'UC Browser': /(UCBrowser|UCWEB)\\/(\\d+(\\.\\d+)?)/,\n            Safari: /Version\\/(\\d+(\\.\\d+)?)/,\n            'Mobile Safari': /Version\\/(\\d+(\\.\\d+)?)/,\n            Opera: /(Opera|OPR)\\/(\\d+(\\.\\d+)?)/,\n            Firefox: /Firefox\\/(\\d+(\\.\\d+)?)/,\n            'Firefox iOS': /FxiOS\\/(\\d+(\\.\\d+)?)/,\n            Konqueror: /Konqueror:(\\d+(\\.\\d+)?)/,\n            BlackBerry: /BlackBerry (\\d+(\\.\\d+)?)/,\n            'Android Mobile': /android\\s(\\d+(\\.\\d+)?)/,\n            'Samsung Internet': /SamsungBrowser\\/(\\d+(\\.\\d+)?)/,\n            'Internet Explorer': /(rv:|MSIE )(\\d+(\\.\\d+)?)/,\n            Mozilla: /rv:(\\d+(\\.\\d+)?)/,\n        }\n        const regex: RegExp | undefined = versionRegexs[browser as keyof typeof versionRegexs]\n        if (regex === undefined) {\n            return null\n        }\n        const matches = userAgent.match(regex)\n        if (!matches) {\n            return null\n        }\n        return parseFloat(matches[matches.length - 2])\n    },\n\n    browserLanguage: function (): string {\n        return (\n            navigator.language || // Any modern browser\n            (navigator as Record<string, any>).userLanguage // IE11\n        )\n    },\n\n    os: function (user_agent: string): { os_name: string; os_version: string } {\n        if (/Windows/i.test(user_agent)) {\n            if (/Phone/.test(user_agent) || /WPDesktop/.test(user_agent)) {\n                return { os_name: 'Windows Phone', os_version: '' }\n            }\n            const match = /Windows NT ([0-9.]+)/i.exec(user_agent)\n            if (match && match[1]) {\n                const version = match[1]\n                return { os_name: 'Windows', os_version: version }\n            }\n            return { os_name: 'Windows', os_version: '' }\n        } else if (/(iPhone|iPad|iPod)/.test(user_agent)) {\n            const match = /OS (\\d+)_(\\d+)_?(\\d+)?/i.exec(user_agent)\n            if (match && match[1]) {\n                const versionParts = [match[1], match[2], match[3] || '0']\n                return { os_name: 'iOS', os_version: versionParts.join('.') }\n            }\n            return { os_name: 'iOS', os_version: '' }\n        } else if (/Android/.test(user_agent)) {\n            const match = /Android (\\d+)\\.(\\d+)\\.?(\\d+)?/i.exec(user_agent)\n            if (match && match[1]) {\n                const versionParts = [match[1], match[2], match[3] || '0']\n                return { os_name: 'Android', os_version: versionParts.join('.') }\n            }\n            return { os_name: 'Android', os_version: '' }\n        } else if (/(BlackBerry|PlayBook|BB10)/i.test(user_agent)) {\n            return { os_name: 'BlackBerry', os_version: '' }\n        } else if (/Mac/i.test(user_agent)) {\n            const match = /Mac OS X (\\d+)[_.](\\d+)[_.]?(\\d+)?/i.exec(user_agent)\n            if (match && match[1]) {\n                const versionParts = [match[1], match[2], match[3] || '0']\n                return { os_name: 'Mac OS X', os_version: versionParts.join('.') }\n            }\n            return { os_name: 'Mac OS X', os_version: '' }\n        } else if (/Linux/.test(user_agent)) {\n            return { os_name: 'Linux', os_version: '' }\n        } else if (/CrOS/.test(user_agent)) {\n            return { os_name: 'Chrome OS', os_version: '' }\n        } else {\n            return { os_name: '', os_version: '' }\n        }\n    },\n\n    device: function (user_agent: string): string {\n        if (/Windows Phone/i.test(user_agent) || /WPDesktop/.test(user_agent)) {\n            return 'Windows Phone'\n        } else if (/iPad/.test(user_agent)) {\n            return 'iPad'\n        } else if (/iPod/.test(user_agent)) {\n            return 'iPod Touch'\n        } else if (/iPhone/.test(user_agent)) {\n            return 'iPhone'\n        } else if (/(BlackBerry|PlayBook|BB10)/i.test(user_agent)) {\n            return 'BlackBerry'\n        } else if (/Android/.test(user_agent) && !/Mobile/.test(user_agent)) {\n            return 'Android Tablet'\n        } else if (/Android/.test(user_agent)) {\n            return 'Android'\n        } else {\n            return ''\n        }\n    },\n\n    deviceType: function (user_agent: string): string {\n        const device = this.device(user_agent)\n        if (device === 'iPad' || device === 'Android Tablet') {\n            return 'Tablet'\n        } else if (device) {\n            return 'Mobile'\n        } else {\n            return 'Desktop'\n        }\n    },\n\n    referrer: function (): string {\n        return document.referrer || '$direct'\n    },\n\n    referringDomain: function (): string {\n        if (!document.referrer) {\n            return '$direct'\n        }\n        const parser = document.createElement('a') // Unfortunately we cannot use new URL due to IE11\n        parser.href = document.referrer\n        return parser.host\n    },\n\n    properties: function (): Properties {\n        const { os_name, os_version } = _info.os(userAgent)\n        return _extend(\n            _strip_empty_properties({\n                $os: os_name,\n                $os_version: os_version,\n                $browser: _info.browser(userAgent, navigator.vendor, (win as any).opera),\n                $device: _info.device(userAgent),\n                $device_type: _info.deviceType(userAgent),\n            }),\n            {\n                $current_url: win?.location.href,\n                $host: win?.location.host,\n                $pathname: win?.location.pathname,\n                $browser_version: _info.browserVersion(userAgent, navigator.vendor, (win as any).opera),\n                $browser_language: _info.browserLanguage(),\n                $screen_height: win?.screen.height,\n                $screen_width: win?.screen.width,\n                $viewport_height: win?.innerHeight,\n                $viewport_width: win?.innerWidth,\n                $lib: 'web',\n                $lib_version: Config.LIB_VERSION,\n                $insert_id: Math.random().toString(36).substring(2, 10) + Math.random().toString(36).substring(2, 10),\n                $time: _timestamp() / 1000, // epoch time in seconds\n            }\n        )\n    },\n\n    people_properties: function (): Properties {\n        const { os_name, os_version } = _info.os(userAgent)\n        return _extend(\n            _strip_empty_properties({\n                $os: os_name,\n                $os_version: os_version,\n                $browser: _info.browser(userAgent, navigator.vendor, (win as any).opera),\n            }),\n            {\n                $browser_version: _info.browserVersion(userAgent, navigator.vendor, (win as any).opera),\n            }\n        )\n    },\n}\n\nexport { win as window, userAgent, logger, document }\n", "/*\n * Get the className of an element, accounting for edge cases where element.className is an object\n * @param {Element} el - element to get the className of\n * @returns {string} the element's class\n */\nimport { AutocaptureConfig } from 'types'\nimport { _each, _includes, _isUndefined, _trim } from './utils'\n\nexport function getClassName(el: Element): string {\n    switch (typeof el.className) {\n        case 'string':\n            return el.className\n        // TODO: when is this ever used?\n        case 'object': // handle cases where className might be SVGAnimatedString or some other type\n            return ('baseVal' in el.className ? (el.className as any).baseVal : null) || el.getAttribute('class') || ''\n        default:\n            // future proof\n            return ''\n    }\n}\n\n/*\n * Get the direct text content of an element, protecting against sensitive data collection.\n * Concats textContent of each of the element's text node children; this avoids potential\n * collection of sensitive data that could happen if we used element.textContent and the\n * element had sensitive child elements, since element.textContent includes child content.\n * Scrubs values that look like they could be sensitive (i.e. cc or ssn number).\n * @param {Element} el - element to get the text of\n * @returns {string} the element's direct text content\n */\nexport function getSafeText(el: Element): string {\n    let elText = ''\n\n    if (shouldCaptureElement(el) && !isSensitiveElement(el) && el.childNodes && el.childNodes.length) {\n        _each(el.childNodes, function (child) {\n            if (isTextNode(child) && child.textContent) {\n                elText += _trim(child.textContent)\n                    // scrub potentially sensitive values\n                    .split(/(\\s+)/)\n                    .filter(shouldCaptureValue)\n                    .join('')\n                    // normalize whitespace\n                    .replace(/[\\r\\n]/g, ' ')\n                    .replace(/[ ]+/g, ' ')\n                    // truncate\n                    .substring(0, 255)\n            }\n        })\n    }\n\n    return _trim(elText)\n}\n\n/*\n * Check whether an element has nodeType Node.ELEMENT_NODE\n * @param {Element} el - element to check\n * @returns {boolean} whether el is of the correct nodeType\n */\nexport function isElementNode(el: Element | undefined | null): el is HTMLElement {\n    return !!el && el.nodeType === 1 // Node.ELEMENT_NODE - use integer constant for browser portability\n}\n\n/*\n * Check whether an element is of a given tag type.\n * Due to potential reference discrepancies (such as the webcomponents.js polyfill),\n * we want to match tagNames instead of specific references because something like\n * element === document.body won't always work because element might not be a native\n * element.\n * @param {Element} el - element to check\n * @param {string} tag - tag name (e.g., \"div\")\n * @returns {boolean} whether el is of the given tag type\n */\nexport function isTag(el: Element | undefined | null, tag: string): el is HTMLElement {\n    return !!el && !!el.tagName && el.tagName.toLowerCase() === tag.toLowerCase()\n}\n\n/*\n * Check whether an element has nodeType Node.TEXT_NODE\n * @param {Element} el - element to check\n * @returns {boolean} whether el is of the correct nodeType\n */\nexport function isTextNode(el: Element | undefined | null): el is HTMLElement {\n    return !!el && el.nodeType === 3 // Node.TEXT_NODE - use integer constant for browser portability\n}\n\n/*\n * Check whether an element has nodeType Node.DOCUMENT_FRAGMENT_NODE\n * @param {Element} el - element to check\n * @returns {boolean} whether el is of the correct nodeType\n */\nexport function isDocumentFragment(el: Element | ParentNode | undefined | null): el is DocumentFragment {\n    return !!el && el.nodeType === 11 // Node.DOCUMENT_FRAGMENT_NODE - use integer constant for browser portability\n}\n\nexport const autocaptureCompatibleElements = ['a', 'button', 'form', 'input', 'select', 'textarea', 'label']\n/*\n * Check whether a DOM event should be \"captured\" or if it may contain sentitive data\n * using a variety of heuristics.\n * @param {Element} el - element to check\n * @param {Event} event - event to check\n * @param {Object} autocaptureConfig - autocapture config\n * @returns {boolean} whether the event should be captured\n */\nexport function shouldCaptureDomEvent(\n    el: Element,\n    event: Event,\n    autocaptureConfig: AutocaptureConfig | undefined = undefined\n): boolean {\n    if (!el || isTag(el, 'html') || !isElementNode(el)) {\n        return false\n    }\n\n    if (autocaptureConfig?.url_allowlist) {\n        const url = window.location.href\n        const allowlist = autocaptureConfig.url_allowlist\n        if (allowlist && !allowlist.some((regex) => url.match(regex))) {\n            return false\n        }\n    }\n\n    if (autocaptureConfig?.dom_event_allowlist) {\n        const allowlist = autocaptureConfig.dom_event_allowlist\n        if (allowlist && !allowlist.some((eventType) => event.type === eventType)) {\n            return false\n        }\n    }\n\n    if (autocaptureConfig?.element_allowlist) {\n        const allowlist = autocaptureConfig.element_allowlist\n        if (allowlist && !allowlist.some((elementType) => el.tagName.toLowerCase() === elementType)) {\n            return false\n        }\n    }\n\n    if (autocaptureConfig?.css_selector_allowlist) {\n        const allowlist = autocaptureConfig.css_selector_allowlist\n        if (allowlist && !allowlist.some((selector) => el.matches(selector))) {\n            return false\n        }\n    }\n\n    let parentIsUsefulElement = false\n    const targetElementList: Element[] = [el] // TODO: remove this var, it's never queried\n    let parentNode: Element | boolean = true\n    let curEl: Element = el\n    while (curEl.parentNode && !isTag(curEl, 'body')) {\n        // If element is a shadow root, we skip it\n        if (isDocumentFragment(curEl.parentNode)) {\n            targetElementList.push((curEl.parentNode as any).host)\n            curEl = (curEl.parentNode as any).host\n            continue\n        }\n        parentNode = (curEl.parentNode as Element) || false\n        if (!parentNode) break\n        if (autocaptureCompatibleElements.indexOf(parentNode.tagName.toLowerCase()) > -1) {\n            parentIsUsefulElement = true\n        } else {\n            const compStyles = window.getComputedStyle(parentNode)\n            if (compStyles && compStyles.getPropertyValue('cursor') === 'pointer') {\n                parentIsUsefulElement = true\n            }\n        }\n\n        targetElementList.push(parentNode)\n        curEl = parentNode\n    }\n\n    const compStyles = window.getComputedStyle(el)\n    if (compStyles && compStyles.getPropertyValue('cursor') === 'pointer' && event.type === 'click') {\n        return true\n    }\n\n    const tag = el.tagName.toLowerCase()\n    switch (tag) {\n        case 'html':\n            return false\n        case 'form':\n            return event.type === 'submit'\n        case 'input':\n            return event.type === 'change' || event.type === 'click'\n        case 'select':\n        case 'textarea':\n            return event.type === 'change' || event.type === 'click'\n        default:\n            if (parentIsUsefulElement) return event.type === 'click'\n            return (\n                event.type === 'click' &&\n                (autocaptureCompatibleElements.indexOf(tag) > -1 || el.getAttribute('contenteditable') === 'true')\n            )\n    }\n}\n\n/*\n * Check whether a DOM element should be \"captured\" or if it may contain sentitive data\n * using a variety of heuristics.\n * @param {Element} el - element to check\n * @returns {boolean} whether the element should be captured\n */\nexport function shouldCaptureElement(el: Element): boolean {\n    for (let curEl = el; curEl.parentNode && !isTag(curEl, 'body'); curEl = curEl.parentNode as Element) {\n        const classes = getClassName(curEl).split(' ')\n        if (_includes(classes, 'ph-sensitive') || _includes(classes, 'ph-no-capture')) {\n            return false\n        }\n    }\n\n    if (_includes(getClassName(el).split(' '), 'ph-include')) {\n        return true\n    }\n\n    // don't include hidden or password fields\n    const type = (el as HTMLInputElement).type || ''\n    if (typeof type === 'string') {\n        // it's possible for el.type to be a DOM element if el is a form with a child input[name=\"type\"]\n        switch (type.toLowerCase()) {\n            case 'hidden':\n                return false\n            case 'password':\n                return false\n        }\n    }\n\n    // filter out data from fields that look like sensitive fields\n    const name = (el as HTMLInputElement).name || el.id || ''\n    // See https://github.com/posthog/posthog-js/issues/165\n    // Under specific circumstances a bug caused .replace to be called on a DOM element\n    // instead of a string, removing the element from the page. Ensure this issue is mitigated.\n    if (typeof name === 'string') {\n        // it's possible for el.name or el.id to be a DOM element if el is a form with a child input[name=\"name\"]\n        const sensitiveNameRegex =\n            /^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i\n        if (sensitiveNameRegex.test(name.replace(/[^a-zA-Z0-9]/g, ''))) {\n            return false\n        }\n    }\n\n    return true\n}\n\n/*\n * Check whether a DOM element is 'sensitive' and we should only capture limited data\n * @param {Element} el - element to check\n * @returns {boolean} whether the element should be captured\n */\nexport function isSensitiveElement(el: Element): boolean {\n    // don't send data from inputs or similar elements since there will always be\n    // a risk of clientside javascript placing sensitive data in attributes\n    const allowedInputTypes = ['button', 'checkbox', 'submit', 'reset']\n    if (\n        (isTag(el, 'input') && !allowedInputTypes.includes((el as HTMLInputElement).type)) ||\n        isTag(el, 'select') ||\n        isTag(el, 'textarea') ||\n        el.getAttribute('contenteditable') === 'true'\n    ) {\n        return true\n    }\n    return false\n}\n\n/*\n * Check whether a string value should be \"captured\" or if it may contain sentitive data\n * using a variety of heuristics.\n * @param {string} value - string value to check\n * @returns {boolean} whether the element should be captured\n */\nexport function shouldCaptureValue(value: string): boolean {\n    if (value === null || _isUndefined(value)) {\n        return false\n    }\n\n    if (typeof value === 'string') {\n        value = _trim(value)\n\n        // check to see if input value looks like a credit card number\n        // see: https://www.safaribooksonline.com/library/view/regular-expressions-cookbook/9781449327453/ch04s20.html\n        const ccRegex =\n            /^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$/\n        if (ccRegex.test((value || '').replace(/[- ]/g, ''))) {\n            return false\n        }\n\n        // check to see if input value looks like a social security number\n        const ssnRegex = /(^\\d{3}-?\\d{2}-?\\d{4}$)/\n        if (ssnRegex.test(value)) {\n            return false\n        }\n    }\n\n    return true\n}\n\n/*\n * Check whether an attribute name is an Angular style attr (either _ngcontent or _nghost)\n * These update on each build and lead to noise in the element chain\n * More details on the attributes here: https://angular.io/guide/view-encapsulation\n * @param {string} attributeName - string value to check\n * @returns {boolean} whether the element is an angular tag\n */\nexport function isAngularStyleAttr(attributeName: string): boolean {\n    if (typeof attributeName === 'string') {\n        return attributeName.substring(0, 10) === '_ngcontent' || attributeName.substring(0, 7) === '_nghost'\n    }\n    return false\n}\n\n/*\n * Iterate through children of a target element looking for span tags\n * and return the text content of the span tags, separated by spaces,\n * along with the direct text content of the target element\n * @param {Element} target - element to check\n * @returns {string} text content of the target element and its child span tags\n */\nexport function getDirectAndNestedSpanText(target: Element): string {\n    let text = getSafeText(target)\n    text = `${text} ${getNestedSpanText(target)}`.trim()\n    return shouldCaptureValue(text) ? text : ''\n}\n\n/*\n * Iterate through children of a target element looking for span tags\n * and return the text content of the span tags, separated by spaces\n * @param {Element} target - element to check\n * @returns {string} text content of span tags\n */\nexport function getNestedSpanText(target: Element): string {\n    let text = ''\n    if (target && target.childNodes && target.childNodes.length) {\n        _each(target.childNodes, function (child) {\n            if (child && child.tagName?.toLowerCase() === 'span') {\n                try {\n                    const spanText = getSafeText(child)\n                    text = `${text} ${spanText}`.trim()\n\n                    if (child.childNodes && child.childNodes.length) {\n                        text = `${text} ${getNestedSpanText(child)}`.trim()\n                    }\n                } catch (e) {\n                    console.error(e)\n                }\n            }\n        })\n    }\n    return text\n}\n", "// Naive rage click implementation: If mouse has not moved than RAGE_CLICK_THRESHOLD_PX\n// over RAGE_CLICK_CLICK_COUNT clicks with max RAGE_CLICK_TIMEOUT_MS between clicks, it's\n// counted as a rage click\n\nconst RAGE_CLICK_THRESHOLD_PX = 30\nconst RAGE_CLICK_TIMEOUT_MS = 1000\nconst RAGE_CLICK_CLICK_COUNT = 3\n\nexport default class RageClick {\n    clicks: { x: number; y: number; timestamp: number }[]\n    enabled: boolean\n\n    constructor(enabled: boolean) {\n        this.clicks = []\n        this.enabled = enabled\n    }\n\n    isRageClick(x: number, y: number, timestamp: number): boolean {\n        if (!this.enabled) {\n            return false\n        }\n\n        const lastClick = this.clicks[this.clicks.length - 1]\n        if (\n            lastClick &&\n            Math.abs(x - lastClick.x) + Math.abs(y - lastClick.y) < RAGE_CLICK_THRESHOLD_PX &&\n            timestamp - lastClick.timestamp < RAGE_CLICK_TIMEOUT_MS\n        ) {\n            this.clicks.push({ x, y, timestamp })\n\n            if (this.clicks.length === RAGE_CLICK_CLICK_COUNT) {\n                return true\n            }\n        } else {\n            this.clicks = [{ x, y, timestamp }]\n        }\n\n        return false\n    }\n}\n", "import { _extend, logger } from './utils'\nimport { PersistentStore, Properties } from './types'\nimport Config from './config'\n\nconst DOMAIN_MATCH_REGEX = /[a-z0-9][a-z0-9-]+\\.[a-z.]{2,6}$/i\n\n// Methods partially borrowed from quirksmode.org/js/cookies.html\nexport const cookieStore: PersistentStore = {\n    is_supported: () => true,\n\n    error: function (msg) {\n        logger.error('cookieStore error: ' + msg)\n    },\n\n    get: function (name) {\n        try {\n            const nameEQ = name + '='\n            const ca = document.cookie.split(';')\n            for (let i = 0; i < ca.length; i++) {\n                let c = ca[i]\n                while (c.charAt(0) == ' ') {\n                    c = c.substring(1, c.length)\n                }\n                if (c.indexOf(nameEQ) === 0) {\n                    return decodeURIComponent(c.substring(nameEQ.length, c.length))\n                }\n            }\n        } catch (err) {}\n        return null\n    },\n\n    parse: function (name) {\n        let cookie\n        try {\n            cookie = JSON.parse(cookieStore.get(name)) || {}\n        } catch (err) {\n            // noop\n        }\n        return cookie\n    },\n\n    set: function (name, value, days, cross_subdomain, is_secure) {\n        try {\n            let cdomain = '',\n                expires = '',\n                secure = ''\n\n            if (cross_subdomain) {\n                const matches = document.location.hostname.match(DOMAIN_MATCH_REGEX),\n                    domain = matches ? matches[0] : ''\n\n                cdomain = domain ? '; domain=.' + domain : ''\n            }\n\n            if (days) {\n                const date = new Date()\n                date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000)\n                expires = '; expires=' + date.toUTCString()\n            }\n\n            if (is_secure) {\n                secure = '; secure'\n            }\n\n            const new_cookie_val =\n                name +\n                '=' +\n                encodeURIComponent(JSON.stringify(value)) +\n                expires +\n                '; SameSite=Lax; path=/' +\n                cdomain +\n                secure\n            document.cookie = new_cookie_val\n            return new_cookie_val\n        } catch (err) {\n            return\n        }\n    },\n\n    remove: function (name, cross_subdomain) {\n        try {\n            cookieStore.set(name, '', -1, cross_subdomain)\n        } catch (err) {\n            return\n        }\n    },\n}\n\nlet _localStorage_supported: boolean | null = null\n\nexport const localStore: PersistentStore = {\n    is_supported: function () {\n        if (_localStorage_supported !== null) {\n            return _localStorage_supported\n        }\n\n        let supported = true\n        if (typeof window !== 'undefined') {\n            try {\n                const key = '__mplssupport__',\n                    val = 'xyz'\n                localStore.set(key, val)\n                if (localStore.get(key) !== '\"xyz\"') {\n                    supported = false\n                }\n                localStore.remove(key)\n            } catch (err) {\n                supported = false\n            }\n        } else {\n            supported = false\n        }\n        if (!supported) {\n            logger.error('localStorage unsupported; falling back to cookie store')\n        }\n\n        _localStorage_supported = supported\n        return supported\n    },\n\n    error: function (msg) {\n        logger.error('localStorage error: ' + msg)\n    },\n\n    get: function (name) {\n        try {\n            return window.localStorage.getItem(name)\n        } catch (err) {\n            localStore.error(err)\n        }\n        return null\n    },\n\n    parse: function (name) {\n        try {\n            return JSON.parse(localStore.get(name)) || {}\n        } catch (err) {\n            // noop\n        }\n        return null\n    },\n\n    set: function (name, value) {\n        try {\n            window.localStorage.setItem(name, JSON.stringify(value))\n        } catch (err) {\n            localStore.error(err)\n        }\n    },\n\n    remove: function (name) {\n        try {\n            window.localStorage.removeItem(name)\n        } catch (err) {\n            localStore.error(err)\n        }\n    },\n}\n\n// Use localstorage for most data but still use cookie for distinct_id\n// This solves issues with cookies having too much data in them causing headers too large\n// Also makes sure we don't have to send a ton of data to the server\nexport const localPlusCookieStore: PersistentStore = {\n    ...localStore,\n    parse: function (name) {\n        try {\n            let extend: Properties = {}\n            try {\n                // See if there's a cookie stored with data.\n                extend = cookieStore.parse(name) || {}\n                if (extend['distinct_id']) {\n                    cookieStore.set(name, { distinct_id: extend['distinct_id'] })\n                }\n            } catch (err) {}\n            const value = _extend(extend, JSON.parse(localStore.get(name) || '{}'))\n            localStore.set(name, value)\n            return value\n        } catch (err) {\n            // noop\n        }\n        return null\n    },\n\n    set: function (name, value, days, cross_subdomain, is_secure) {\n        try {\n            localStore.set(name, value)\n            if (value.distinct_id) {\n                cookieStore.set(name, { distinct_id: value.distinct_id }, days, cross_subdomain, is_secure)\n            }\n        } catch (err) {\n            localStore.error(err)\n        }\n    },\n\n    remove: function (name, cross_subdomain) {\n        try {\n            window.localStorage.removeItem(name)\n            cookieStore.remove(name, cross_subdomain)\n        } catch (err) {\n            localStore.error(err)\n        }\n    },\n}\n\nconst memoryStorage: Properties = {}\n\n// Storage that only lasts the length of the pageview if we don't want to use cookies\nexport const memoryStore: PersistentStore = {\n    is_supported: function () {\n        return true\n    },\n\n    error: function (msg) {\n        logger.error('memoryStorage error: ' + msg)\n    },\n\n    get: function (name) {\n        return memoryStorage[name] || null\n    },\n\n    parse: function (name) {\n        return memoryStorage[name] || null\n    },\n\n    set: function (name, value) {\n        memoryStorage[name] = value\n    },\n\n    remove: function (name) {\n        delete memoryStorage[name]\n    },\n}\n\nlet sessionStorageSupported: boolean | null = null\nexport const resetSessionStorageSupported = () => {\n    sessionStorageSupported = null\n}\n// Storage that only lasts the length of a tab/window. Survives page refreshes\nexport const sessionStore: PersistentStore = {\n    is_supported: function () {\n        if (sessionStorageSupported !== null) {\n            return sessionStorageSupported\n        }\n        sessionStorageSupported = true\n        if (typeof window !== 'undefined') {\n            try {\n                const key = '__support__',\n                    val = 'xyz'\n                sessionStore.set(key, val)\n                if (sessionStore.get(key) !== '\"xyz\"') {\n                    sessionStorageSupported = false\n                }\n                sessionStore.remove(key)\n            } catch (err) {\n                sessionStorageSupported = false\n            }\n        } else {\n            sessionStorageSupported = false\n        }\n        return sessionStorageSupported\n    },\n\n    error: function (msg) {\n        if (Config.DEBUG) {\n            logger.error('sessionStorage error: ', msg)\n        }\n    },\n\n    get: function (name) {\n        try {\n            return window.sessionStorage.getItem(name)\n        } catch (err) {\n            sessionStore.error(err)\n        }\n        return null\n    },\n\n    parse: function (name) {\n        try {\n            return JSON.parse(sessionStore.get(name)) || null\n        } catch (err) {\n            // noop\n        }\n        return null\n    },\n\n    set: function (name, value) {\n        try {\n            window.sessionStorage.setItem(name, JSON.stringify(value))\n        } catch (err) {\n            sessionStore.error(err)\n        }\n    },\n\n    remove: function (name) {\n        try {\n            window.sessionStorage.removeItem(name)\n        } catch (err) {\n            sessionStore.error(err)\n        }\n    },\n}\n", "/* eslint camelcase: \"off\" */\n\nimport { _each, _extend, _include, _info, _isObject, _isUndefined, _strip_empty_properties, logger } from './utils'\nimport { cookieStore, localStore, localPlusCookieStore, memoryStore, sessionStore } from './storage'\nimport { PersistentStore, PostHogConfig, Properties } from './types'\n\n/*\n * Constants\n */\n// This key is deprecated, but we want to check for it to see whether aliasing is allowed.\nexport const PEOPLE_DISTINCT_ID_KEY = '$people_distinct_id'\nexport const ALIAS_ID_KEY = '__alias'\nexport const CAMPAIGN_IDS_KEY = '__cmpns'\nexport const EVENT_TIMERS_KEY = '__timers'\nexport const AUTOCAPTURE_DISABLED_SERVER_SIDE = '$autocapture_disabled_server_side'\nexport const SESSION_RECORDING_ENABLED_SERVER_SIDE = '$session_recording_enabled_server_side'\nexport const CONSOLE_LOG_RECORDING_ENABLED_SERVER_SIDE = '$console_log_recording_enabled_server_side'\nexport const SESSION_RECORDING_RECORDER_VERSION_SERVER_SIDE = '$session_recording_recorder_version_server_side' // follows rrweb versioning\nexport const SESSION_ID = '$sesid'\nexport const ENABLED_FEATURE_FLAGS = '$enabled_feature_flags'\nexport const PERSISTENCE_EARLY_ACCESS_FEATURES = '$early_access_features'\nexport const STORED_PERSON_PROPERTIES_KEY = '$stored_person_properties'\nexport const STORED_GROUP_PROPERTIES_KEY = '$stored_group_properties'\n\nconst USER_STATE = '$user_state'\n\nexport const RESERVED_PROPERTIES = [\n    PEOPLE_DISTINCT_ID_KEY,\n    ALIAS_ID_KEY,\n    CAMPAIGN_IDS_KEY,\n    EVENT_TIMERS_KEY,\n    SESSION_RECORDING_ENABLED_SERVER_SIDE,\n    SESSION_ID,\n    ENABLED_FEATURE_FLAGS,\n    USER_STATE,\n    PERSISTENCE_EARLY_ACCESS_FEATURES,\n    STORED_GROUP_PROPERTIES_KEY,\n    STORED_PERSON_PROPERTIES_KEY,\n]\n\nconst CASE_INSENSITIVE_PERSISTENCE_TYPES: readonly Lowercase<PostHogConfig['persistence']>[] = [\n    'cookie',\n    'localstorage',\n    'localstorage+cookie',\n    'sessionstorage',\n    'memory',\n]\n\n/**\n * PostHog Persistence Object\n * @constructor\n */\nexport class PostHogPersistence {\n    props: Properties\n    storage: PersistentStore\n    campaign_params_saved: boolean\n    custom_campaign_params: string[]\n    name: string\n    disabled: boolean | undefined\n    secure: boolean | undefined\n    expire_days: number | undefined\n    default_expiry: number | undefined\n    cross_subdomain: boolean | undefined\n    user_state: 'anonymous' | 'identified'\n\n    constructor(config: PostHogConfig) {\n        // clean chars that aren't accepted by the http spec for cookie values\n        // https://datatracker.ietf.org/doc/html/rfc2616#section-2.2\n        let token = ''\n\n        if (config['token']) {\n            token = config['token'].replace(/\\+/g, 'PL').replace(/\\//g, 'SL').replace(/=/g, 'EQ')\n        }\n\n        this.props = {}\n        this.campaign_params_saved = false\n        this.custom_campaign_params = config['custom_campaign_params'] || []\n\n        if (config['persistence_name']) {\n            this.name = 'ph_' + config['persistence_name']\n        } else {\n            this.name = 'ph_' + token + '_posthog'\n        }\n\n        if (\n            CASE_INSENSITIVE_PERSISTENCE_TYPES.indexOf(\n                config['persistence'].toLowerCase() as Lowercase<PostHogConfig['persistence']>\n            ) === -1\n        ) {\n            logger.critical('Unknown persistence type ' + config['persistence'] + '; falling back to cookie')\n            config['persistence'] = 'cookie'\n        }\n        // We handle storage type in a case-insensitive way for backwards compatibility\n        const storage_type = config['persistence'].toLowerCase() as Lowercase<PostHogConfig['persistence']>\n        if (storage_type === 'localstorage' && localStore.is_supported()) {\n            this.storage = localStore\n        } else if (storage_type === 'localstorage+cookie' && localPlusCookieStore.is_supported()) {\n            this.storage = localPlusCookieStore\n        } else if (storage_type === 'sessionstorage' && sessionStore.is_supported()) {\n            this.storage = sessionStore\n        } else if (storage_type === 'memory') {\n            this.storage = memoryStore\n        } else {\n            this.storage = cookieStore\n        }\n\n        this.user_state = 'anonymous'\n\n        this.load()\n        this.update_config(config)\n        this.save()\n    }\n\n    properties(): Properties {\n        const p: Properties = {}\n        // Filter out reserved properties\n        _each(this.props, function (v, k) {\n            if (k === ENABLED_FEATURE_FLAGS && typeof v === 'object') {\n                const keys = Object.keys(v)\n                for (let i = 0; i < keys.length; i++) {\n                    p[`$feature/${keys[i]}`] = v[keys[i]]\n                }\n            } else if (!_include(RESERVED_PROPERTIES, k)) {\n                p[k] = v\n            }\n        })\n        return p\n    }\n\n    load(): void {\n        if (this.disabled) {\n            return\n        }\n\n        const entry = this.storage.parse(this.name)\n\n        if (entry) {\n            this.props = _extend({}, entry)\n        }\n    }\n\n    /**\n     * NOTE: Saving frequently causes issues with Recordings and Consent Management Platform (CMP) tools which\n     * observe cookie changes, and modify their UI, often causing infinite loops.\n     * As such callers of this should ideally check that the data has changed beforehand\n     */\n    save(): void {\n        if (this.disabled) {\n            return\n        }\n        this.storage.set(this.name, this.props, this.expire_days, this.cross_subdomain, this.secure)\n    }\n\n    remove(): void {\n        // remove both domain and subdomain cookies\n        this.storage.remove(this.name, false)\n        this.storage.remove(this.name, true)\n    }\n\n    // removes the storage entry and deletes all loaded data\n    // forced name for tests\n\n    clear(): void {\n        this.remove()\n        this.props = {}\n    }\n\n    /**\n     * @param {Object} props\n     * @param {*=} default_value\n     * @param {number=} days\n     */\n\n    register_once(props: Properties, default_value: any, days?: number): boolean {\n        if (_isObject(props)) {\n            if (typeof default_value === 'undefined') {\n                default_value = 'None'\n            }\n            this.expire_days = typeof days === 'undefined' ? this.default_expiry : days\n\n            let hasChanges = false\n\n            _each(props, (val, prop) => {\n                if (!this.props.hasOwnProperty(prop) || this.props[prop] === default_value) {\n                    this.props[prop] = val\n                    hasChanges = true\n                }\n            })\n\n            if (hasChanges) {\n                this.save()\n                return true\n            }\n        }\n        return false\n    }\n\n    /**\n     * @param {Object} props\n     * @param {number=} days\n     */\n\n    register(props: Properties, days?: number): boolean {\n        if (_isObject(props)) {\n            this.expire_days = typeof days === 'undefined' ? this.default_expiry : days\n\n            let hasChanges = false\n\n            _each(props, (val, prop) => {\n                if (props.hasOwnProperty(prop) && this.props[prop] !== val) {\n                    this.props[prop] = val\n                    hasChanges = true\n                }\n            })\n\n            if (hasChanges) {\n                this.save()\n                return true\n            }\n        }\n        return false\n    }\n\n    unregister(prop: string): void {\n        if (prop in this.props) {\n            delete this.props[prop]\n            this.save()\n        }\n    }\n\n    update_campaign_params(): void {\n        if (!this.campaign_params_saved) {\n            this.register(_info.campaignParams(this.custom_campaign_params))\n            this.campaign_params_saved = true\n        }\n    }\n\n    update_search_keyword(): void {\n        this.register(_info.searchInfo())\n    }\n\n    update_referrer_info(): void {\n        this.register({\n            $referrer: this.props['$referrer'] || _info.referrer(),\n            $referring_domain: this.props['$referring_domain'] || _info.referringDomain(),\n        })\n    }\n\n    get_referrer_info(): Properties {\n        return _strip_empty_properties({\n            $referrer: this['props']['$referrer'],\n            $referring_domain: this['props']['$referring_domain'],\n        })\n    }\n\n    // safely fills the passed in object with stored properties,\n    // does not override any properties defined in both\n    // returns the passed in object\n\n    safe_merge(props: Properties): Properties {\n        _each(this.props, function (val, prop) {\n            if (!(prop in props)) {\n                props[prop] = val\n            }\n        })\n\n        return props\n    }\n\n    update_config(config: PostHogConfig): void {\n        this.default_expiry = this.expire_days = config['cookie_expiration']\n        this.set_disabled(config['disable_persistence'])\n        this.set_cross_subdomain(config['cross_subdomain_cookie'])\n        this.set_secure(config['secure_cookie'])\n    }\n\n    set_disabled(disabled: boolean): void {\n        this.disabled = disabled\n        if (this.disabled) {\n            this.remove()\n        } else {\n            this.save()\n        }\n    }\n\n    set_cross_subdomain(cross_subdomain: boolean): void {\n        if (cross_subdomain !== this.cross_subdomain) {\n            this.cross_subdomain = cross_subdomain\n            this.remove()\n            this.save()\n        }\n    }\n\n    get_cross_subdomain(): boolean {\n        return !!this.cross_subdomain\n    }\n\n    set_secure(secure: boolean): void {\n        if (secure !== this.secure) {\n            this.secure = secure\n            this.remove()\n            this.save()\n        }\n    }\n\n    set_event_timer(event_name: string, timestamp: number): void {\n        const timers = this.props[EVENT_TIMERS_KEY] || {}\n        timers[event_name] = timestamp\n        this.props[EVENT_TIMERS_KEY] = timers\n        this.save()\n    }\n\n    remove_event_timer(event_name: string): number {\n        const timers = this.props[EVENT_TIMERS_KEY] || {}\n        const timestamp = timers[event_name]\n        if (!_isUndefined(timestamp)) {\n            delete this.props[EVENT_TIMERS_KEY][event_name]\n            this.save()\n        }\n        return timestamp\n    }\n\n    get_user_state(): 'anonymous' | 'identified' {\n        return this.props[USER_STATE] || 'anonymous'\n    }\n\n    set_user_state(state: 'anonymous' | 'identified'): void {\n        this.props[USER_STATE] = state\n        this.save()\n    }\n}\n", "import {\n    _bind_instance_methods,\n    _each,\n    _extend,\n    _includes,\n    _isFunction,\n    _isUndefined,\n    _register_event,\n    _safewrap_instance_methods,\n    logger,\n} from './utils'\nimport {\n    getClassName,\n    getSafeText,\n    isElementNode,\n    isSensitiveElement,\n    isTag,\n    isTextNode,\n    shouldCaptureDomEvent,\n    shouldCaptureElement,\n    shouldCaptureValue,\n    autocaptureCompatibleElements,\n    isAngularStyleAttr,\n    isDocumentFragment,\n    getDirectAndNestedSpanText,\n} from './autocapture-utils'\nimport RageClick from './extensions/rageclick'\nimport { AutocaptureConfig, AutoCaptureCustomProperty, DecideResponse, Properties } from './types'\nimport { PostHog } from './posthog-core'\nimport { AUTOCAPTURE_DISABLED_SERVER_SIDE } from './posthog-persistence'\n\nconst autocapture = {\n    _initializedTokens: [] as string[],\n\n    _isAutocaptureEnabled: false as boolean,\n\n    _setIsAutocaptureEnabled: function (instance: PostHog): void {\n        const disabled_server_side = !!instance.get_property(AUTOCAPTURE_DISABLED_SERVER_SIDE)\n        const enabled_client_side = !!instance.get_config('autocapture')\n        this._isAutocaptureEnabled = enabled_client_side && !disabled_server_side\n    },\n\n    _previousElementSibling: function (el: Element): Element | null {\n        if (el.previousElementSibling) {\n            return el.previousElementSibling\n        } else {\n            let _el: Element | null = el\n            do {\n                _el = _el.previousSibling as Element | null // resolves to ChildNode->Node, which is Element's parent class\n            } while (_el && !isElementNode(_el))\n            return _el\n        }\n    },\n\n    _getAugmentPropertiesFromElement: function (elem: Element): Properties {\n        const shouldCaptureEl = shouldCaptureElement(elem)\n        if (!shouldCaptureEl) {\n            return {}\n        }\n\n        const props: Properties = {}\n\n        _each(elem.attributes, function (attr: Attr) {\n            if (attr.name.indexOf('data-ph-capture-attribute') === 0) {\n                const propertyKey = attr.name.replace('data-ph-capture-attribute-', '')\n                const propertyValue = attr.value\n                if (propertyKey && propertyValue && shouldCaptureValue(propertyValue)) {\n                    props[propertyKey] = propertyValue\n                }\n            }\n        })\n        return props\n    },\n\n    _getPropertiesFromElement: function (elem: Element, maskInputs: boolean, maskText: boolean): Properties {\n        const tag_name = elem.tagName.toLowerCase()\n        const props: Properties = {\n            tag_name: tag_name,\n        }\n        if (autocaptureCompatibleElements.indexOf(tag_name) > -1 && !maskText) {\n            if (tag_name.toLowerCase() === 'a' || tag_name.toLowerCase() === 'button') {\n                props['$el_text'] = getDirectAndNestedSpanText(elem)\n            } else {\n                props['$el_text'] = getSafeText(elem)\n            }\n        }\n\n        const classes = getClassName(elem)\n        if (classes.length > 0)\n            props['classes'] = classes.split(' ').filter(function (c) {\n                return c !== ''\n            })\n\n        _each(elem.attributes, function (attr: Attr) {\n            // Only capture attributes we know are safe\n            if (isSensitiveElement(elem) && ['name', 'id', 'class'].indexOf(attr.name) === -1) return\n\n            if (!maskInputs && shouldCaptureValue(attr.value) && !isAngularStyleAttr(attr.name)) {\n                props['attr__' + attr.name] = attr.value\n            }\n        })\n\n        let nthChild = 1\n        let nthOfType = 1\n        let currentElem: Element | null = elem\n        while ((currentElem = this._previousElementSibling(currentElem))) {\n            // eslint-disable-line no-cond-assign\n            nthChild++\n            if (currentElem.tagName === elem.tagName) {\n                nthOfType++\n            }\n        }\n        props['nth_child'] = nthChild\n        props['nth_of_type'] = nthOfType\n\n        return props\n    },\n\n    _getDefaultProperties: function (eventType: string): Properties {\n        return {\n            $event_type: eventType,\n            $ce_version: 1,\n        }\n    },\n\n    _extractCustomPropertyValue: function (customProperty: AutoCaptureCustomProperty): string {\n        const propValues: string[] = []\n        _each(document.querySelectorAll(customProperty['css_selector']), function (matchedElem) {\n            let value\n\n            if (['input', 'select'].indexOf(matchedElem.tagName.toLowerCase()) > -1) {\n                value = matchedElem['value']\n            } else if (matchedElem['textContent']) {\n                value = matchedElem['textContent']\n            }\n\n            if (shouldCaptureValue(value)) {\n                propValues.push(value)\n            }\n        })\n        return propValues.join(', ')\n    },\n\n    // TODO: delete custom_properties after changeless typescript refactor\n    _getCustomProperties: function (targetElementList: Element[]): Properties {\n        const props: Properties = {} // will be deleted\n        _each(this._customProperties, (customProperty) => {\n            _each(customProperty['event_selectors'], (eventSelector) => {\n                const eventElements = document.querySelectorAll(eventSelector)\n                _each(eventElements, (eventElement) => {\n                    if (_includes(targetElementList, eventElement) && shouldCaptureElement(eventElement)) {\n                        props[customProperty['name']] = this._extractCustomPropertyValue(customProperty)\n                    }\n                })\n            })\n        })\n        return props\n    },\n\n    _getEventTarget: function (e: Event): Element | null {\n        // https://developer.mozilla.org/en-US/docs/Web/API/Event/target#Compatibility_notes\n        if (typeof e.target === 'undefined') {\n            return (e.srcElement as Element) || null\n        } else {\n            if ((e.target as HTMLElement)?.shadowRoot) {\n                return (e.composedPath()[0] as Element) || null\n            }\n            return (e.target as Element) || null\n        }\n    },\n\n    _captureEvent: function (e: Event, instance: PostHog, eventName = '$autocapture'): boolean | void {\n        /*** Don't mess with this code without running IE8 tests on it ***/\n        let target = this._getEventTarget(e)\n        if (isTextNode(target)) {\n            // defeat Safari bug (see: http://www.quirksmode.org/js/events_properties.html)\n            target = (target.parentNode || null) as Element | null\n        }\n\n        if (eventName === '$autocapture' && e.type === 'click' && e instanceof MouseEvent) {\n            if (this.rageclicks?.isRageClick(e.clientX, e.clientY, new Date().getTime())) {\n                this._captureEvent(e, instance, '$rageclick')\n            }\n        }\n\n        if (target && shouldCaptureDomEvent(target, e, this.config)) {\n            const targetElementList = [target]\n            let curEl = target\n            while (curEl.parentNode && !isTag(curEl, 'body')) {\n                if (isDocumentFragment(curEl.parentNode)) {\n                    targetElementList.push((curEl.parentNode as any).host)\n                    curEl = (curEl.parentNode as any).host\n                    continue\n                }\n                targetElementList.push(curEl.parentNode as Element)\n                curEl = curEl.parentNode as Element\n            }\n\n            const elementsJson: Properties[] = []\n            const autocaptureAugmentProperties: Properties = {}\n            let href,\n                explicitNoCapture = false\n            _each(targetElementList, (el) => {\n                const shouldCaptureEl = shouldCaptureElement(el)\n\n                // if the element or a parent element is an anchor tag\n                // include the href as a property\n                if (el.tagName.toLowerCase() === 'a') {\n                    href = el.getAttribute('href')\n                    href = shouldCaptureEl && shouldCaptureValue(href) && href\n                }\n\n                // allow users to programmatically prevent capturing of elements by adding class 'ph-no-capture'\n                const classes = getClassName(el).split(' ')\n                if (_includes(classes, 'ph-no-capture')) {\n                    explicitNoCapture = true\n                }\n\n                elementsJson.push(\n                    this._getPropertiesFromElement(\n                        el,\n                        instance.get_config('mask_all_element_attributes'),\n                        instance.get_config('mask_all_text')\n                    )\n                )\n\n                const augmentProperties = this._getAugmentPropertiesFromElement(el)\n                _extend(autocaptureAugmentProperties, augmentProperties)\n            })\n\n            if (!instance.get_config('mask_all_text')) {\n                // if the element is a button or anchor tag get the span text from any\n                // children and include it as/with the text property on the parent element\n                if (target.tagName.toLowerCase() === 'a' || target.tagName.toLowerCase() === 'button') {\n                    elementsJson[0]['$el_text'] = getDirectAndNestedSpanText(target)\n                } else {\n                    elementsJson[0]['$el_text'] = getSafeText(target)\n                }\n            }\n\n            if (href) {\n                elementsJson[0]['attr__href'] = href\n            }\n\n            if (explicitNoCapture) {\n                return false\n            }\n\n            const props = _extend(\n                this._getDefaultProperties(e.type),\n                {\n                    $elements: elementsJson,\n                },\n                this._getCustomProperties(targetElementList),\n                autocaptureAugmentProperties\n            )\n\n            instance.capture(eventName, props)\n            return true\n        }\n    },\n\n    // only reason is to stub for unit tests\n    // since you can't override window.location props\n    _navigate: function (href: string): void {\n        window.location.href = href\n    },\n\n    _addDomEventHandlers: function (instance: PostHog): void {\n        const handler = (e: Event) => {\n            e = e || window.event\n            this._captureEvent(e, instance)\n        }\n        _register_event(document, 'submit', handler, false, true)\n        _register_event(document, 'change', handler, false, true)\n        _register_event(document, 'click', handler, false, true)\n    },\n\n    _customProperties: [] as AutoCaptureCustomProperty[],\n    rageclicks: null as RageClick | null,\n    config: undefined as AutocaptureConfig | undefined,\n\n    init: function (instance: PostHog): void {\n        if (typeof instance.__autocapture !== 'boolean') {\n            this.config = instance.__autocapture\n        }\n\n        // precompile the regex\n        if (this.config?.url_allowlist) {\n            this.config.url_allowlist = this.config.url_allowlist.map((url) => new RegExp(url))\n        }\n\n        this.rageclicks = new RageClick(instance.get_config('rageclick'))\n    },\n\n    afterDecideResponse: function (response: DecideResponse, instance: PostHog): void {\n        this._setIsAutocaptureEnabled(instance)\n        const token = instance.get_config('token')\n        if (this._initializedTokens.indexOf(token) > -1) {\n            logger.log('autocapture already initialized for token \"' + token + '\"')\n            return\n        }\n\n        if (instance.persistence) {\n            instance.persistence.register({\n                [AUTOCAPTURE_DISABLED_SERVER_SIDE]: !!response['autocapture_opt_out'],\n            })\n        }\n\n        this._initializedTokens.push(token)\n\n        if (\n            response &&\n            response['config'] &&\n            response['config']['enable_collect_everything'] &&\n            this._isAutocaptureEnabled\n        ) {\n            // TODO: delete custom_properties after changeless typescript refactor\n            if (response['custom_properties']) {\n                this._customProperties = response['custom_properties']\n            }\n            this._addDomEventHandlers(instance)\n        } else {\n            instance['__autocapture'] = false\n        }\n    },\n\n    // this is a mechanism to ramp up CE with no server-side interaction.\n    // when CE is active, every page load results in a decide request. we\n    // need to gently ramp this up so we don't overload decide. this decides\n    // deterministically if CE is enabled for this project by modding the char\n    // value of the project token.\n    enabledForProject: function (\n        token: string | null | undefined,\n        numBuckets: number,\n        numEnabledBuckets: number\n    ): boolean {\n        if (!token) {\n            return true\n        }\n        numBuckets = !_isUndefined(numBuckets) ? numBuckets : 10\n        numEnabledBuckets = !_isUndefined(numEnabledBuckets) ? numEnabledBuckets : 10\n        let charCodeSum = 0\n        for (let i = 0; i < token.length; i++) {\n            charCodeSum += token.charCodeAt(i)\n        }\n        return charCodeSum % numBuckets < numEnabledBuckets\n    },\n\n    isBrowserSupported: function (): boolean {\n        return _isFunction(document.querySelectorAll)\n    },\n}\n\n_bind_instance_methods(autocapture)\n_safewrap_instance_methods(autocapture)\n\nexport { autocapture }\n", "/**\n * GDPR utils\n *\n * The General Data Protection Regulation (GDPR) is a regulation in EU law on data protection\n * and privacy for all individuals within the European Union. It addresses the export of personal\n * data outside the EU. The GDPR aims primarily to give control back to citizens and residents\n * over their personal data and to simplify the regulatory environment for international business\n * by unifying the regulation within the EU.\n *\n * This set of utilities is intended to enable opt in/out functionality in the PostHog JS SDK.\n * These functions are used internally by the SDK and are not intended to be publicly exposed.\n */\n\nimport { _each, _includes, _isNumber, _isString, window } from './utils'\nimport { cookieStore, localStore, localPlusCookieStore } from './storage'\nimport { GDPROptions, PersistentStore } from './types'\nimport { PostHog } from './posthog-core'\n\n/**\n * A function used to capture a PostHog event (e.g. PostHogLib.capture)\n * @callback captureFunction\n * @param {String} event_name The name of the event. This can be anything the user does - 'Button Click', 'Sign Up', 'Item Purchased', etc.\n * @param {Object} [properties] A set of properties to include with the event you're sending. These describe the user who did the event or details about the event itself.\n * @param {Function} [callback] If provided, the callback function will be called after capturing the event.\n */\n\n/** Public **/\n\nconst GDPR_DEFAULT_PERSISTENCE_PREFIX = '__ph_opt_in_out_'\n\n/**\n * Opt the user in to data capturing and cookies/localstorage for the given token\n * @param {string} token - PostHog project capturing token\n * @param {Object} [options]\n * @param {captureFunction} [options.capture] - function used for capturing a PostHog event to record the opt-in action\n * @param {string} [options.captureEventName] - event name to be used for capturing the opt-in action\n * @param {Object} [options.captureProperties] - set of properties to be captured along with the opt-in action\n * @param {string} [options.persistenceType] Persistence mechanism used - cookie or localStorage\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @param {Number} [options.cookieExpiration] - number of days until the opt-in cookie expires\n * @param {boolean} [options.crossSubdomainCookie] - whether the opt-in cookie is set as cross-subdomain or not\n * @param {boolean} [options.secureCookie] - whether the opt-in cookie is set as secure or not\n */\nexport function optIn(token: string, options: GDPROptions): void {\n    _optInOut(true, token, options)\n}\n\n/**\n * Opt the user out of data capturing and cookies/localstorage for the given token\n * @param {string} token - PostHog project capturing token\n * @param {Object} [options]\n * @param {string} [options.persistenceType] Persistence mechanism used - cookie or localStorage\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @param {Number} [options.cookieExpiration] - number of days until the opt-out cookie expires\n * @param {boolean} [options.crossSubdomainCookie] - whether the opt-out cookie is set as cross-subdomain or not\n * @param {boolean} [options.secureCookie] - whether the opt-out cookie is set as secure or not\n */\nexport function optOut(token: string, options: GDPROptions): void {\n    _optInOut(false, token, options)\n}\n\n/**\n * Check whether the user has opted in to data capturing and cookies/localstorage for the given token\n * @param {string} token - PostHog project capturing token\n * @param {Object} [options]\n * @param {string} [options.persistenceType] Persistence mechanism used - cookie or localStorage\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @returns {boolean} whether the user has opted in to the given opt type\n */\nexport function hasOptedIn(token: string, options: GDPROptions): boolean {\n    return _getStorageValue(token, options) === '1'\n}\n\n/**\n * Check whether the user has opted out of data capturing and cookies/localstorage for the given token\n * @param {string} token - PostHog project capturing token\n * @param {Object} [options]\n * @param {string} [options.persistenceType] Persistence mechanism used - cookie or localStorage\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @param {boolean} [options.respectDnt] - flag to take browser DNT setting into account\n * @returns {boolean} whether the user has opted out of the given opt type\n */\nexport function hasOptedOut(token: string, options: Partial<GDPROptions>): boolean {\n    if (_hasDoNotTrackFlagOn(options)) {\n        return true\n    }\n    return _getStorageValue(token, options) === '0'\n}\n\n/**\n * Clear the user's opt in/out status of data capturing and cookies/localstorage for the given token\n * @param {string} token - PostHog project capturing token\n * @param {Object} [options]\n * @param {string} [options.persistenceType] Persistence mechanism used - cookie or localStorage\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @param {Number} [options.cookieExpiration] - number of days until the opt-in cookie expires\n * @param {boolean} [options.crossSubdomainCookie] - whether the opt-in cookie is set as cross-subdomain or not\n * @param {boolean} [options.secureCookie] - whether the opt-in cookie is set as secure or not\n */\nexport function clearOptInOut(token: string, options: GDPROptions) {\n    options = options || {}\n    _getStorage(options).remove(_getStorageKey(token, options), !!options.crossSubdomainCookie)\n}\n\n/** Private **/\n\n/**\n * Get storage util\n * @param {Object} [options]\n * @param {string} [options.persistenceType]\n * @returns {object} either cookieStore or localStore\n */\nfunction _getStorage(options: GDPROptions): PersistentStore {\n    options = options || {}\n    if (options.persistenceType === 'localStorage') {\n        return localStore\n    }\n    if (options.persistenceType === 'localStorage+cookie') {\n        return localPlusCookieStore\n    }\n    return cookieStore\n}\n\n/**\n * Get the name of the cookie that is used for the given opt type (capturing, cookie, etc.)\n * @param {string} token - PostHog project capturing token\n * @param {Object} [options]\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @returns {string} the name of the cookie for the given opt type\n */\nfunction _getStorageKey(token: string, options: GDPROptions) {\n    options = options || {}\n    return (options.persistencePrefix || GDPR_DEFAULT_PERSISTENCE_PREFIX) + token\n}\n\n/**\n * Get the value of the cookie that is used for the given opt type (capturing, cookie, etc.)\n * @param {string} token - PostHog project capturing token\n * @param {Object} [options]\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @returns {string} the value of the cookie for the given opt type\n */\nfunction _getStorageValue(token: string, options: GDPROptions) {\n    return _getStorage(options).get(_getStorageKey(token, options))\n}\n\n/**\n * Check whether the user has set the DNT/doNotTrack setting to true in their browser\n * @param {Object} [options]\n * @param {string} [options.window] - alternate window object to check; used to force various DNT settings in browser tests\n * @param {boolean} [options.respectDnt] - flag to take browser DNT setting into account\n * @returns {boolean} whether the DNT setting is true\n */\nfunction _hasDoNotTrackFlagOn(options: GDPROptions) {\n    if (options && options.respectDnt) {\n        const win = (options && options.window) || window\n        const nav = win['navigator'] || {}\n        let hasDntOn = false\n        _each(\n            [\n                nav['doNotTrack'], // standard\n                (nav as any)['msDoNotTrack'],\n                (win as any)['doNotTrack'],\n            ],\n            function (dntValue) {\n                if (_includes([true, 1, '1', 'yes'], dntValue)) {\n                    hasDntOn = true\n                }\n            }\n        )\n        return hasDntOn\n    }\n    return false\n}\n\n/**\n * Set cookie/localstorage for the user indicating that they are opted in or out for the given opt type\n * @param {boolean} optValue - whether to opt the user in or out for the given opt type\n * @param {string} token - PostHog project capturing token\n * @param {Object} [options]\n * @param {captureFunction} [options.capture] - function used for capturing a PostHog event to record the opt-in action\n * @param {string} [options.captureEventName] - event name to be used for capturing the opt-in action\n * @param {Object} [options.captureProperties] - set of properties to be captured along with the opt-in action\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @param {Number} [options.cookieExpiration] - number of days until the opt-in cookie expires\n * @param {boolean} [options.crossSubdomainCookie] - whether the opt-in cookie is set as cross-subdomain or not\n * @param {boolean} [options.secureCookie] - whether the opt-in cookie is set as secure or not\n */\nfunction _optInOut(optValue: boolean, token: string, options: GDPROptions) {\n    if (!_isString(token) || !token.length) {\n        console.error('gdpr.' + (optValue ? 'optIn' : 'optOut') + ' called with an invalid token')\n        return\n    }\n\n    options = options || {}\n\n    _getStorage(options).set(\n        _getStorageKey(token, options),\n        optValue ? 1 : 0,\n        _isNumber(options.cookieExpiration) ? options.cookieExpiration : null,\n        options.crossSubdomainCookie,\n        options.secureCookie\n    )\n\n    if (options.capture && optValue) {\n        // only capture event if opting in (optValue=true)\n        options.capture(options.captureEventName || '$opt_in', options.captureProperties || {}, {\n            send_instantly: true,\n        })\n    }\n}\n\nexport function userOptedOut(posthog: PostHog, silenceErrors: boolean | undefined) {\n    let optedOut = false\n\n    try {\n        const token = posthog.get_config('token')\n        const respectDnt = posthog.get_config('respect_dnt')\n        const persistenceType = posthog.get_config('opt_out_capturing_persistence_type')\n        const persistencePrefix = posthog.get_config('opt_out_capturing_cookie_prefix') || undefined\n        const win = posthog.get_config('window' as any) as Window | undefined // used to override window during browser tests\n\n        if (token) {\n            // if there was an issue getting the token, continue method execution as normal\n            optedOut = hasOptedOut(token, {\n                respectDnt,\n                persistenceType,\n                persistencePrefix,\n                window: win,\n            })\n        }\n    } catch (err) {\n        if (!silenceErrors) {\n            console.error('Unexpected error when checking capturing opt-out status: ' + err)\n        }\n    }\n    return optedOut\n}\n\n/**\n * Wrap a method with a check for whether the user is opted out of data capturing and cookies/localstorage for the given token\n * If the user has opted out, return early instead of executing the method.\n * If a callback argument was provided, execute it passing the 0 error code.\n * @param {PostHog} posthog - the posthog instance\n * @param {function} method - wrapped method to be executed if the user has not opted out\n * @param silenceErrors\n * @returns {*} the result of executing method OR undefined if the user has opted out\n */\nexport function addOptOutCheck<M extends (...args: any[]) => any = (...args: any[]) => any>(\n    posthog: PostHog,\n    method: M,\n    silenceErrors?: boolean\n): M {\n    return function (...args) {\n        const optedOut = userOptedOut(posthog, silenceErrors)\n\n        if (!optedOut) {\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            return method.apply(this, args)\n        }\n\n        const callback = args[args.length - 1]\n        if (typeof callback === 'function') {\n            callback(0)\n        }\n\n        return\n    } as M\n}\n", "/* eslint camelcase: \"off\" */\nimport { addOptOutCheck } from './gdpr-utils'\nimport { _base64Encode, _copyAndTruncateStrings, _each, _encodeDates, _extend, _info, _isObject } from './utils'\nimport { PostHogConfig, Properties, RequestCallback } from './types'\nimport { PostHog } from './posthog-core'\n\nconst SET_ACTION = '$set'\nconst SET_ONCE_ACTION = '$set_once'\n\n/**\n * PostHog People Object\n * @constructor\n */\nclass PostHogPeople {\n    _posthog: PostHog\n\n    set: (prop: string | Properties, to?: string, callback?: RequestCallback) => void\n    set_once: (prop: string | Properties, to?: string, callback?: RequestCallback) => void\n\n    constructor(posthog: PostHog) {\n        this._posthog = posthog\n\n        /*\n         * Set properties on a user record.\n         *\n         * ### Usage:\n         *\n         *     posthog.people.set('gender', 'm');\n         *\n         *     // or set multiple properties at once\n         *     posthog.people.set({\n         *         'Company': 'Acme',\n         *         'Plan': 'Premium',\n         *         'Upgrade date': new Date()\n         *     });\n         *     // properties can be strings, integers, dates, or lists\n         *\n         * @param {Object|String} prop If a string, this is the name of the property. If an object, this is an associative array of names and values.\n         * @param {*} [to] A value to set on the given property name\n         * @param {Function} [callback] If provided, the callback will be called after capturing the event.\n         */\n        this.set = addOptOutCheck(posthog, (prop: string | Properties, to?: string, callback?: RequestCallback) => {\n            const data = this.set_action(prop, to)\n\n            // Update current user properties\n            this._posthog.setPersonPropertiesForFlags(data['$set'] || {})\n\n            if (_isObject(prop)) {\n                callback = to as any\n            }\n            // make sure that the referrer info has been updated and saved\n            if (this._get_config('save_referrer')) {\n                this._posthog.sessionPersistence.update_referrer_info()\n            }\n\n            // update $set object with default people properties\n            data[SET_ACTION] = _extend(\n                {},\n                _info.people_properties(),\n                this._posthog.sessionPersistence.get_referrer_info(),\n                data[SET_ACTION]\n            )\n            return this._send_request(data, callback)\n        })\n\n        /*\n         * Set properties on a user record, only if they do not yet exist.\n         * This will not overwrite previous people property values, unlike\n         * people.set().\n         *\n         * ### Usage:\n         *\n         *     posthog.people.set_once('First Login Date', new Date());\n         *\n         *     // or set multiple properties at once\n         *     posthog.people.set_once({\n         *         'First Login Date': new Date(),\n         *         'Starting Plan': 'Premium'\n         *     });\n         *\n         *     // properties can be strings, integers or dates\n         *\n         * @param {Object|String} prop If a string, this is the name of the property. If an object, this is an associative array of names and values.\n         * @param {*} [to] A value to set on the given property name\n         * @param {Function} [callback] If provided, the callback will be called after capturing the event.\n         */\n        this.set_once = addOptOutCheck(\n            posthog,\n            (prop: string | Properties, to?: string, callback?: RequestCallback) => {\n                const data = this.set_once_action(prop, to)\n                if (_isObject(prop)) {\n                    callback = to as any\n                }\n                return this._send_request(data, callback)\n            }\n        )\n    }\n\n    toString(): string {\n        return this._posthog.toString() + '.people'\n    }\n\n    _send_request(data: Properties, callback?: RequestCallback): Properties {\n        data['$token'] = this._get_config('token')\n        data['$distinct_id'] = this._posthog.get_distinct_id()\n        const device_id = this._posthog.get_property('$device_id')\n        const user_id = this._posthog.get_property('$user_id')\n        const had_persisted_distinct_id = this._posthog.get_property('$had_persisted_distinct_id')\n        if (device_id) {\n            data['$device_id'] = device_id\n        }\n        if (user_id) {\n            data['$user_id'] = user_id\n        }\n        if (had_persisted_distinct_id) {\n            data['$had_persisted_distinct_id'] = had_persisted_distinct_id\n        }\n\n        const date_encoded_data = _encodeDates(data)\n        const truncated_data = _copyAndTruncateStrings(\n            date_encoded_data,\n            this._get_config('properties_string_max_length')\n        )\n        const json_data = JSON.stringify(date_encoded_data)\n        const encoded_data = _base64Encode(json_data)\n\n        this._posthog._send_request(\n            this._get_config('api_host') + '/engage/',\n            { data: encoded_data },\n            {},\n            this._posthog._prepare_callback(callback, truncated_data) as RequestCallback\n        )\n\n        return truncated_data\n    }\n\n    _get_config<K extends keyof PostHogConfig>(conf_var: K): PostHogConfig[K] {\n        return this._posthog.get_config(conf_var)\n    }\n\n    _is_reserved_property(prop: string): boolean {\n        return (\n            prop === '$distinct_id' ||\n            prop === '$token' ||\n            prop === '$device_id' ||\n            prop === '$user_id' ||\n            prop === '$had_persisted_distinct_id'\n        )\n    }\n\n    // Internal methods for posthog.people API.\n    // These methods shouldn't involve network I/O.\n    private set_action(prop: string | Properties, to?: string): Properties {\n        return this.apiActionParser(SET_ACTION, prop, to)\n    }\n\n    private set_once_action(prop: string | Properties, to?: string): Properties {\n        return this.apiActionParser(SET_ONCE_ACTION, prop, to)\n    }\n\n    private apiActionParser(actionType: '$set' | '$set_once', prop: string | Properties, to?: string): Properties {\n        const data: Properties = {}\n        const props: Properties = {}\n\n        if (_isObject(prop)) {\n            _each(prop, (v, k: string) => {\n                if (!(this as any)._is_reserved_property(k)) {\n                    props[k] = v\n                }\n            })\n        } else {\n            props[prop] = to\n        }\n\n        data[actionType] = props\n        return data\n    }\n}\n\nexport { PostHogPeople }\n", "import { _base64Encode, _entries, _extend } from './utils'\nimport { PostHog } from './posthog-core'\nimport {\n    DecideResponse,\n    FeatureFlagsCallback,\n    EarlyAccessFeatureCallback,\n    EarlyAccessFeatureResponse,\n    Properties,\n    JsonType,\n    RequestCallback,\n} from './types'\nimport {\n    PERSISTENCE_EARLY_ACCESS_FEATURES,\n    PostHogPersistence,\n    ENABLED_FEATURE_FLAGS,\n    STORED_GROUP_PROPERTIES_KEY,\n    STORED_PERSON_PROPERTIES_KEY,\n} from './posthog-persistence'\n\nconst PERSISTENCE_ACTIVE_FEATURE_FLAGS = '$active_feature_flags'\nconst PERSISTENCE_OVERRIDE_FEATURE_FLAGS = '$override_feature_flags'\nconst PERSISTENCE_FEATURE_FLAG_PAYLOADS = '$feature_flag_payloads'\n\nexport const filterActiveFeatureFlags = (featureFlags?: Record<string, string | boolean>) => {\n    const activeFeatureFlags: Record<string, string | boolean> = {}\n    for (const [key, value] of _entries(featureFlags || {})) {\n        if (value) {\n            activeFeatureFlags[key] = value\n        }\n    }\n    return activeFeatureFlags\n}\n\nexport const parseFeatureFlagDecideResponse = (\n    response: Partial<DecideResponse>,\n    persistence: PostHogPersistence,\n    currentFlags: Record<string, string | boolean> = {},\n    currentFlagPayloads: Record<string, JsonType> = {}\n) => {\n    const flags = response['featureFlags']\n    const flagPayloads = response['featureFlagPayloads']\n    if (flags) {\n        // using the v1 api\n        if (Array.isArray(flags)) {\n            const $enabled_feature_flags: Record<string, boolean> = {}\n            if (flags) {\n                for (let i = 0; i < flags.length; i++) {\n                    $enabled_feature_flags[flags[i]] = true\n                }\n            }\n            persistence &&\n                persistence.register({\n                    [PERSISTENCE_ACTIVE_FEATURE_FLAGS]: flags,\n                    [ENABLED_FEATURE_FLAGS]: $enabled_feature_flags,\n                })\n        } else {\n            // using the v2+ api\n            let newFeatureFlags = flags\n            let newFeatureFlagPayloads = flagPayloads\n            if (response.errorsWhileComputingFlags) {\n                // if not all flags were computed, we upsert flags instead of replacing them\n                newFeatureFlags = { ...currentFlags, ...newFeatureFlags }\n                newFeatureFlagPayloads = { ...currentFlagPayloads, ...newFeatureFlagPayloads }\n            }\n            persistence &&\n                persistence.register({\n                    [PERSISTENCE_ACTIVE_FEATURE_FLAGS]: Object.keys(filterActiveFeatureFlags(newFeatureFlags)),\n                    [ENABLED_FEATURE_FLAGS]: newFeatureFlags || {},\n                    [PERSISTENCE_FEATURE_FLAG_PAYLOADS]: newFeatureFlagPayloads || {},\n                })\n        }\n    }\n}\n\nexport class PostHogFeatureFlags {\n    instance: PostHog\n    _override_warning: boolean\n    flagCallReported: Record<string, boolean>\n    featureFlagEventHandlers: FeatureFlagsCallback[]\n    reloadFeatureFlagsQueued: boolean\n    reloadFeatureFlagsInAction: boolean\n    $anon_distinct_id: string | undefined\n\n    constructor(instance: PostHog) {\n        this.instance = instance\n        this._override_warning = false\n        this.flagCallReported = {}\n        this.featureFlagEventHandlers = []\n\n        this.reloadFeatureFlagsQueued = false\n        this.reloadFeatureFlagsInAction = false\n    }\n\n    getFlags(): string[] {\n        return Object.keys(this.getFlagVariants())\n    }\n\n    getFlagVariants(): Record<string, string | boolean> {\n        const enabledFlags = this.instance.get_property(ENABLED_FEATURE_FLAGS)\n        const overriddenFlags = this.instance.get_property(PERSISTENCE_OVERRIDE_FEATURE_FLAGS)\n        if (!overriddenFlags) {\n            return enabledFlags || {}\n        }\n\n        const finalFlags = _extend({}, enabledFlags)\n        const overriddenKeys = Object.keys(overriddenFlags)\n        for (let i = 0; i < overriddenKeys.length; i++) {\n            if (overriddenFlags[overriddenKeys[i]] === false) {\n                delete finalFlags[overriddenKeys[i]]\n            } else {\n                finalFlags[overriddenKeys[i]] = overriddenFlags[overriddenKeys[i]]\n            }\n        }\n        if (!this._override_warning) {\n            console.warn('[PostHog] Overriding feature flags!', {\n                enabledFlags,\n                overriddenFlags,\n                finalFlags,\n            })\n            this._override_warning = true\n        }\n        return finalFlags\n    }\n\n    getFlagPayloads(): Record<string, JsonType> {\n        const flagPayloads = this.instance.get_property(PERSISTENCE_FEATURE_FLAG_PAYLOADS)\n        return flagPayloads || {}\n    }\n\n    /**\n     * Reloads feature flags asynchronously.\n     *\n     * Constraints:\n     *\n     * 1. Avoid parallel requests\n     * 2. Delay a few milliseconds after each reloadFeatureFlags call to batch subsequent changes together\n     * 3. Don't call this during initial load (as /decide will be called instead), see posthog-core.js\n     */\n    reloadFeatureFlags(): void {\n        if (!this.reloadFeatureFlagsQueued) {\n            this.reloadFeatureFlagsQueued = true\n            this._startReloadTimer()\n        }\n    }\n\n    setAnonymousDistinctId(anon_distinct_id: string): void {\n        this.$anon_distinct_id = anon_distinct_id\n    }\n\n    setReloadingPaused(isPaused: boolean): void {\n        this.reloadFeatureFlagsInAction = isPaused\n    }\n\n    resetRequestQueue(): void {\n        this.reloadFeatureFlagsQueued = false\n    }\n\n    _startReloadTimer(): void {\n        if (this.reloadFeatureFlagsQueued && !this.reloadFeatureFlagsInAction) {\n            setTimeout(() => {\n                if (!this.reloadFeatureFlagsInAction && this.reloadFeatureFlagsQueued) {\n                    this.reloadFeatureFlagsQueued = false\n                    this._reloadFeatureFlagsRequest()\n                }\n            }, 5)\n        }\n    }\n\n    _reloadFeatureFlagsRequest(): void {\n        this.setReloadingPaused(true)\n        const token = this.instance.get_config('token')\n        const personProperties = this.instance.get_property(STORED_PERSON_PROPERTIES_KEY)\n        const groupProperties = this.instance.get_property(STORED_GROUP_PROPERTIES_KEY)\n        const json_data = JSON.stringify({\n            token: token,\n            distinct_id: this.instance.get_distinct_id(),\n            groups: this.instance.getGroups(),\n            $anon_distinct_id: this.$anon_distinct_id,\n            person_properties: personProperties,\n            group_properties: groupProperties,\n        })\n\n        const encoded_data = _base64Encode(json_data)\n        this.instance._send_request(\n            this.instance.get_config('api_host') + '/decide/?v=3',\n            { data: encoded_data },\n            { method: 'POST' },\n            this.instance._prepare_callback((response) => {\n                // reset anon_distinct_id after at least a single request with it\n                // makes it through\n                this.$anon_distinct_id = undefined\n                this.receivedFeatureFlags(response as DecideResponse)\n\n                // :TRICKY: Reload - start another request if queued!\n                this.setReloadingPaused(false)\n                this._startReloadTimer()\n            }) as RequestCallback\n        )\n    }\n\n    /*\n     * Get feature flag's value for user.\n     *\n     * ### Usage:\n     *\n     *     if(posthog.getFeatureFlag('my-flag') === 'some-variant') { // do something }\n     *\n     * @param {Object|String} key Key of the feature flag.\n     * @param {Object|String} options (optional) If {send_event: false}, we won't send an $feature_flag_call event to PostHog.\n     */\n    getFeatureFlag(key: string, options: { send_event?: boolean } = {}): boolean | string {\n        if (!this.getFlags()) {\n            console.warn('getFeatureFlag for key \"' + key + '\" failed. Feature flags didn\\'t load in time.')\n            return false\n        }\n        const flagValue = this.getFlagVariants()[key]\n        if ((options.send_event || !('send_event' in options)) && !this.flagCallReported[key]) {\n            this.flagCallReported[key] = true\n            this.instance.capture('$feature_flag_called', { $feature_flag: key, $feature_flag_response: flagValue })\n        }\n        return flagValue\n    }\n\n    getFeatureFlagPayload(key: string): JsonType {\n        const payloads = this.getFlagPayloads()\n        return payloads[key]\n    }\n\n    /*\n     * See if feature flag is enabled for user.\n     *\n     * ### Usage:\n     *\n     *     if(posthog.isFeatureEnabled('beta-feature')) { // do something }\n     *\n     * @param {Object|String} key Key of the feature flag.\n     * @param {Object|String} options (optional) If {send_event: false}, we won't send an $feature_flag_call event to PostHog.\n     */\n    isFeatureEnabled(key: string, options: { send_event?: boolean } = {}): boolean {\n        if (!this.getFlags()) {\n            console.warn('isFeatureEnabled for key \"' + key + '\" failed. Feature flags didn\\'t load in time.')\n            return false\n        }\n        return !!this.getFeatureFlag(key, options)\n    }\n\n    addFeatureFlagsHandler(handler: FeatureFlagsCallback): void {\n        this.featureFlagEventHandlers.push(handler)\n    }\n\n    removeFeatureFlagsHandler(handler: FeatureFlagsCallback): void {\n        this.featureFlagEventHandlers = this.featureFlagEventHandlers.filter((h) => h !== handler)\n    }\n\n    receivedFeatureFlags(response: Partial<DecideResponse>): void {\n        this.instance.decideEndpointWasHit = true\n        const currentFlags = this.getFlagVariants()\n        const currentFlagPayloads = this.getFlagPayloads()\n        parseFeatureFlagDecideResponse(response, this.instance.persistence, currentFlags, currentFlagPayloads)\n        this._fireFeatureFlagsCallbacks()\n    }\n\n    /*\n     * Override feature flags for debugging.\n     *\n     * ### Usage:\n     *\n     *     - posthog.feature_flags.override(false)\n     *     - posthog.feature_flags.override(['beta-feature'])\n     *     - posthog.feature_flags.override({'beta-feature': 'variant', 'other-feature': True})\n     *\n     * @param {Object|Array|String} flags Flags to override with.\n     */\n    override(flags: boolean | string[] | Record<string, string | boolean>): void {\n        this._override_warning = false\n\n        if (flags === false) {\n            this.instance.persistence.unregister(PERSISTENCE_OVERRIDE_FEATURE_FLAGS)\n        } else if (Array.isArray(flags)) {\n            const flagsObj: Record<string, string | boolean> = {}\n            for (let i = 0; i < flags.length; i++) {\n                flagsObj[flags[i]] = true\n            }\n            this.instance.persistence.register({ [PERSISTENCE_OVERRIDE_FEATURE_FLAGS]: flagsObj })\n        } else {\n            this.instance.persistence.register({ [PERSISTENCE_OVERRIDE_FEATURE_FLAGS]: flags })\n        }\n    }\n    /*\n     * Register an event listener that runs when feature flags become available or when they change.\n     * If there are flags, the listener is called immediately in addition to being called on future changes.\n     *\n     * ### Usage:\n     *\n     *     posthog.onFeatureFlags(function(featureFlags) { // do something })\n     *\n     * @param {Function} [callback] The callback function will be called once the feature flags are ready or when they are updated.\n     *                              It'll return a list of feature flags enabled for the user.\n     * @returns {Function} A function that can be called to unsubscribe the listener. Used by useEffect when the component unmounts.\n     */\n    onFeatureFlags(callback: FeatureFlagsCallback): () => void {\n        this.addFeatureFlagsHandler(callback)\n        if (this.instance.decideEndpointWasHit) {\n            const { flags, flagVariants } = this._prepareFeatureFlagsForCallbacks()\n            callback(flags, flagVariants)\n        }\n        return () => this.removeFeatureFlagsHandler(callback)\n    }\n\n    updateEarlyAccessFeatureEnrollment(key: string, isEnrolled: boolean): void {\n        const enrollmentPersonProp = {\n            [`$feature_enrollment/${key}`]: isEnrolled,\n        }\n        this.instance.capture('$feature_enrollment_update', {\n            $feature_flag: key,\n            $feature_enrollment: isEnrolled,\n            $set: enrollmentPersonProp,\n        })\n        this.setPersonPropertiesForFlags(enrollmentPersonProp, false)\n\n        const newFlags = { ...this.getFlagVariants(), [key]: isEnrolled }\n        this.instance.persistence.register({\n            [PERSISTENCE_ACTIVE_FEATURE_FLAGS]: Object.keys(filterActiveFeatureFlags(newFlags)),\n            [ENABLED_FEATURE_FLAGS]: newFlags,\n        })\n        this._fireFeatureFlagsCallbacks()\n    }\n\n    getEarlyAccessFeatures(callback: EarlyAccessFeatureCallback, force_reload = false): void {\n        const existing_early_access_features = this.instance.get_property(PERSISTENCE_EARLY_ACCESS_FEATURES)\n\n        if (!existing_early_access_features || force_reload) {\n            this.instance._send_request(\n                `${this.instance.get_config('api_host')}/api/early_access_features/?token=${this.instance.get_config(\n                    'token'\n                )}`,\n                {},\n                { method: 'GET' },\n                (response) => {\n                    const earlyAccessFeatures = (response as EarlyAccessFeatureResponse).earlyAccessFeatures\n                    this.instance.persistence.register({ [PERSISTENCE_EARLY_ACCESS_FEATURES]: earlyAccessFeatures })\n                    return callback(earlyAccessFeatures)\n                }\n            )\n        } else {\n            return callback(existing_early_access_features)\n        }\n    }\n\n    _prepareFeatureFlagsForCallbacks(): { flags: string[]; flagVariants: Record<string, string | boolean> } {\n        const flags = this.getFlags()\n        const flagVariants = this.getFlagVariants()\n\n        // Return truthy\n        const truthyFlags = flags.filter((flag) => flagVariants[flag])\n        const truthyFlagVariants = Object.keys(flagVariants)\n            .filter((variantKey) => flagVariants[variantKey])\n            .reduce((res: Record<string, string | boolean>, key) => {\n                res[key] = flagVariants[key]\n                return res\n            }, {})\n\n        return {\n            flags: truthyFlags,\n            flagVariants: truthyFlagVariants,\n        }\n    }\n\n    _fireFeatureFlagsCallbacks(): void {\n        const { flags, flagVariants } = this._prepareFeatureFlagsForCallbacks()\n        this.featureFlagEventHandlers.forEach((handler) => handler(flags, flagVariants))\n    }\n\n    /**\n     * Set override person properties for feature flags.\n     * This is used when dealing with new persons / where you don't want to wait for ingestion\n     * to update user properties.\n     */\n    setPersonPropertiesForFlags(properties: Properties, reloadFeatureFlags = true): void {\n        // Get persisted person properties\n        const existingProperties = this.instance.get_property(STORED_PERSON_PROPERTIES_KEY) || {}\n\n        this.instance.register({\n            [STORED_PERSON_PROPERTIES_KEY]: {\n                ...existingProperties,\n                ...properties,\n            },\n        })\n\n        if (reloadFeatureFlags) {\n            this.instance.reloadFeatureFlags()\n        }\n    }\n\n    resetPersonPropertiesForFlags(): void {\n        this.instance.unregister(STORED_PERSON_PROPERTIES_KEY)\n    }\n\n    /**\n     * Set override group properties for feature flags.\n     * This is used when dealing with new groups / where you don't want to wait for ingestion\n     * to update properties.\n     * Takes in an object, the key of which is the group type.\n     * For example:\n     *     setGroupPropertiesForFlags({'organization': { name: 'CYZ', employees: '11' } })\n     */\n    setGroupPropertiesForFlags(properties: { [type: string]: Properties }, reloadFeatureFlags = true): void {\n        // Get persisted group properties\n        const existingProperties = this.instance.get_property(STORED_GROUP_PROPERTIES_KEY) || {}\n\n        if (Object.keys(existingProperties).length !== 0) {\n            Object.keys(existingProperties).forEach((groupType) => {\n                existingProperties[groupType] = {\n                    ...existingProperties[groupType],\n                    ...properties[groupType],\n                }\n                delete properties[groupType]\n            })\n        }\n\n        this.instance.register({\n            [STORED_GROUP_PROPERTIES_KEY]: {\n                ...existingProperties,\n                ...properties,\n            },\n        })\n\n        if (reloadFeatureFlags) {\n            this.instance.reloadFeatureFlags()\n        }\n    }\n\n    resetGroupPropertiesForFlags(group_type?: string): void {\n        if (group_type) {\n            const existingProperties = this.instance.get_property(STORED_GROUP_PROPERTIES_KEY) || {}\n            this.instance.register({\n                [STORED_GROUP_PROPERTIES_KEY]: { ...existingProperties, [group_type]: {} },\n            })\n        } else {\n            this.instance.unregister(STORED_GROUP_PROPERTIES_KEY)\n        }\n    }\n}\n", "import type { pluginEvent } from '@rrweb/types'\n\nexport const replacementImageURI =\n    'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiBmaWxsPSJibGFjayIvPgo8cGF0aCBkPSJNOCAwSDE2TDAgMTZWOEw4IDBaIiBmaWxsPSIjMkQyRDJEIi8+CjxwYXRoIGQ9Ik0xNiA4VjE2SDhMMTYgOFoiIGZpbGw9IiMyRDJEMkQiLz4KPC9zdmc+Cg=='\n\nexport const FULL_SNAPSHOT_EVENT_TYPE = 2\nexport const META_EVENT_TYPE = 4\nexport const INCREMENTAL_SNAPSHOT_EVENT_TYPE = 3\nexport const PLUGIN_EVENT_TYPE = 6\nexport const MUTATION_SOURCE_TYPE = 0\n\n/*\n * Check whether a data payload is nearing 5mb. If it is, it checks the data for\n * data URIs (the likely culprit for large payloads). If it finds data URIs, it either replaces\n * it with a generic image (if it's an image) or removes it.\n * @data {object} the rr-web data object\n * @returns {object} the rr-web data object with data uris filtered out\n */\nexport function filterDataURLsFromLargeDataObjects(data: Record<string, any>): Record<string, any> {\n    if (data && typeof data === 'object') {\n        let stringifiedData = JSON.stringify(data)\n        // String length of 5000000 is an approximation of 5mb\n        // Note: with compression, this limit may be able to be increased\n        // but we're assuming most of the size is from a data uri which\n        // is unlikely to be compressed further\n        if (stringifiedData.length > 5000000) {\n            // Regex that matches the pattern for a dataURI with the shape 'data:{mime type};{encoding},{data}'. It:\n            // 1) Checks if the pattern starts with 'data:' (potentially, not at the start of the string)\n            // 2) Extracts the mime type of the data uri in the first group\n            // 3) Determines when the data URI ends.Depending on if it's used in the src tag or css, it can end with a ) or \"\n            const dataURIRegex = /data:([\\w\\/\\-\\.]+);(\\w+),([^)\"]*)/gim\n            const matches = stringifiedData.matchAll(dataURIRegex)\n            for (const match of matches) {\n                if (match[1].toLocaleLowerCase().slice(0, 6) === 'image/') {\n                    stringifiedData = stringifiedData.replace(match[0], replacementImageURI)\n                } else {\n                    stringifiedData = stringifiedData.replace(match[0], '')\n                }\n            }\n        }\n        return JSON.parse(stringifiedData)\n    }\n    return data\n}\n\nexport const CONSOLE_LOG_PLUGIN_NAME = 'rrweb/console@1' // The name of the rr-web plugin that emits console logs\n\n// Console logs can be really large. This function truncates large logs\n// It's a simple function that just truncates long strings.\n// TODO: Ideally this function would have better handling of objects + lists,\n// so they could still be rendered in a pretty way after truncation.\nexport function truncateLargeConsoleLogs(event: pluginEvent<{ payload: string[] }>) {\n    const MAX_STRING_SIZE = 2000 // Maximum number of characters allowed in a string\n    const MAX_STRINGS_PER_LOG = 10 // A log can consist of multiple strings (e.g. consol.log('string1', 'string2'))\n\n    if (\n        event &&\n        typeof event === 'object' &&\n        event.type === PLUGIN_EVENT_TYPE &&\n        typeof event.data === 'object' &&\n        event.data.plugin === CONSOLE_LOG_PLUGIN_NAME\n    ) {\n        // Note: event.data.payload.payload comes from rr-web, and is an array of strings\n        if (event.data.payload.payload.length > MAX_STRINGS_PER_LOG) {\n            event.data.payload.payload = event.data.payload.payload.slice(0, MAX_STRINGS_PER_LOG)\n            event.data.payload.payload.push('...[truncated]')\n        }\n        const updatedPayload = []\n        for (let i = 0; i < event.data.payload.payload.length; i++) {\n            if (\n                event.data.payload.payload[i] && // Value can be null\n                event.data.payload.payload[i].length > MAX_STRING_SIZE\n            ) {\n                updatedPayload.push(event.data.payload.payload[i].slice(0, MAX_STRING_SIZE) + '...[truncated]')\n            } else {\n                updatedPayload.push(event.data.payload.payload[i])\n            }\n        }\n        event.data.payload.payload = updatedPayload\n        return event\n    }\n    return event\n}\n", "import {\n    CONSOLE_LOG_RECORDING_ENABLED_SERVER_SIDE,\n    SESSION_RECORDING_ENABLED_SERVER_SIDE,\n    SESSION_RECORDING_RECORDER_VERSION_SERVER_SIDE,\n} from '../posthog-persistence'\nimport {\n    filterDataURLsFromLargeDataObjects,\n    FULL_SNAPSHOT_EVENT_TYPE,\n    INCREMENTAL_SNAPSHOT_EVENT_TYPE,\n    META_EVENT_TYPE,\n    truncateLargeConsoleLogs,\n} from './sessionrecording-utils'\nimport { PostHog } from '../posthog-core'\nimport { DecideResponse, Properties } from '../types'\nimport type {\n    KeepIframeSrcFn,\n    RecordPlugin,\n    SamplingStrategy,\n    blockClass,\n    eventWithTime,\n    hooksParam,\n    listenerHandler,\n    maskTextClass,\n    pluginEvent,\n} from '@rrweb/types'\nimport Config from '../config'\nimport { logger, loadScript } from '../utils'\nimport type { DataURLOptions, MaskInputFn, MaskInputOptions, MaskTextFn, SlimDOMOptions } from 'rrweb-snapshot'\n\nconst BASE_ENDPOINT = '/e/'\n\nexport const RECORDING_IDLE_ACTIVITY_TIMEOUT_MS = 5 * 60 * 1000 // 5 minutes\n\n// NOTE: Importing this type is problematic as we can't safely bundle it to a TS definition so instead we redefine.\n// import type { record } from 'rrweb2/typings'\n// import type { recordOptions } from 'rrweb/typings/types'\n\nexport type rrwebRecord = {\n    (options: recordOptions<eventWithTime>): listenerHandler\n    addCustomEvent: (tag: string, payload: any) => void\n    takeFullSnapshot: () => void\n}\n\nexport declare type recordOptions<T> = {\n    emit?: (e: T, isCheckout?: boolean) => void\n    checkoutEveryNth?: number\n    checkoutEveryNms?: number\n    blockClass?: blockClass\n    blockSelector?: string\n    ignoreClass?: string\n    maskTextClass?: maskTextClass\n    maskTextSelector?: string\n    maskAllInputs?: boolean\n    maskInputOptions?: MaskInputOptions\n    maskInputFn?: MaskInputFn\n    maskTextFn?: MaskTextFn\n    slimDOMOptions?: SlimDOMOptions | 'all' | true\n    ignoreCSSAttributes?: Set<string>\n    inlineStylesheet?: boolean\n    hooks?: hooksParam\n    // packFn?: PackFn\n    sampling?: SamplingStrategy\n    dataURLOptions?: DataURLOptions\n    recordCanvas?: boolean\n    recordCrossOriginIframes?: boolean\n    recordAfter?: 'DOMContentLoaded' | 'load'\n    userTriggeredOnInput?: boolean\n    collectFonts?: boolean\n    inlineImages?: boolean\n    plugins?: RecordPlugin[]\n    mousemoveWait?: number\n    keepIframeSrcFn?: KeepIframeSrcFn\n    // errorHandler?: ErrorHandler\n}\n\n// Copied from rrweb typings to avoid import\nenum IncrementalSource {\n    Mutation = 0,\n    MouseMove = 1,\n    MouseInteraction = 2,\n    Scroll = 3,\n    ViewportResize = 4,\n    Input = 5,\n    TouchMove = 6,\n    MediaInteraction = 7,\n    StyleSheetRule = 8,\n    CanvasMutation = 9,\n    Font = 10,\n    Log = 11,\n    Drag = 12,\n    StyleDeclaration = 13,\n    Selection = 14,\n    AdoptedStyleSheet = 15,\n}\n\nconst ACTIVE_SOURCES = [\n    IncrementalSource.MouseMove,\n    IncrementalSource.MouseInteraction,\n    IncrementalSource.Scroll,\n    IncrementalSource.ViewportResize,\n    IncrementalSource.Input,\n    IncrementalSource.TouchMove,\n    IncrementalSource.MediaInteraction,\n    IncrementalSource.Drag,\n]\n\nexport class SessionRecording {\n    instance: PostHog\n    captureStarted: boolean\n    snapshots: any[]\n    emit: boolean\n    endpoint: string\n    stopRrweb: listenerHandler | undefined\n    windowId: string | null\n    sessionId: string | null\n    receivedDecide: boolean\n    rrwebRecord: rrwebRecord | undefined\n    recorderVersion?: string\n    lastActivityTimestamp: number = Date.now()\n    isIdle = false\n\n    constructor(instance: PostHog) {\n        this.instance = instance\n        this.captureStarted = false\n        this.snapshots = []\n        this.emit = false // Controls whether data is sent to the server or not\n        this.endpoint = BASE_ENDPOINT\n        this.stopRrweb = undefined\n        this.windowId = null\n        this.sessionId = null\n        this.receivedDecide = false\n    }\n\n    startRecordingIfEnabled() {\n        if (this.isRecordingEnabled()) {\n            this.startCaptureAndTrySendingQueuedSnapshots()\n        } else {\n            this.stopRecording()\n        }\n    }\n\n    started() {\n        return this.captureStarted\n    }\n\n    stopRecording() {\n        if (this.captureStarted && this.stopRrweb) {\n            this.stopRrweb()\n            this.stopRrweb = undefined\n            this.captureStarted = false\n        }\n    }\n\n    isRecordingEnabled() {\n        const enabled_server_side = !!this.instance.get_property(SESSION_RECORDING_ENABLED_SERVER_SIDE)\n        const enabled_client_side = !this.instance.get_config('disable_session_recording')\n        return enabled_server_side && enabled_client_side\n    }\n\n    isConsoleLogCaptureEnabled() {\n        const enabled_server_side = !!this.instance.get_property(CONSOLE_LOG_RECORDING_ENABLED_SERVER_SIDE)\n        const enabled_client_side = this.instance.get_config('enable_recording_console_log')\n        return enabled_client_side ?? enabled_server_side\n    }\n\n    getRecordingVersion() {\n        const recordingVersion_server_side = this.instance.get_property(SESSION_RECORDING_RECORDER_VERSION_SERVER_SIDE)\n        const recordingVersion_client_side = this.instance.get_config('session_recording')?.recorderVersion\n        return recordingVersion_client_side || recordingVersion_server_side || 'v1'\n    }\n\n    afterDecideResponse(response: DecideResponse) {\n        this.receivedDecide = true\n        if (this.instance.persistence) {\n            this.instance.persistence.register({\n                [SESSION_RECORDING_ENABLED_SERVER_SIDE]: !!response['sessionRecording'],\n                [CONSOLE_LOG_RECORDING_ENABLED_SERVER_SIDE]: response.sessionRecording?.consoleLogRecordingEnabled,\n                [SESSION_RECORDING_RECORDER_VERSION_SERVER_SIDE]: response.sessionRecording?.recorderVersion,\n            })\n        }\n        if (response.sessionRecording?.endpoint) {\n            this.endpoint = response.sessionRecording?.endpoint\n        }\n\n        if (response.sessionRecording?.recorderVersion) {\n            this.recorderVersion = response.sessionRecording.recorderVersion\n        }\n        this.startRecordingIfEnabled()\n    }\n\n    startCaptureAndTrySendingQueuedSnapshots() {\n        // Only submit data after we've received a decide response to account for\n        // changing endpoints and the feature being disabled on the server side.\n        if (this.receivedDecide) {\n            this.emit = true\n            this.snapshots.forEach((properties) => this._captureSnapshot(properties))\n        }\n        this._startCapture()\n    }\n\n    _startCapture() {\n        // According to the rrweb docs, rrweb is not supported on IE11 and below:\n        // \"rrweb does not support IE11 and below because it uses the MutationObserver API which was supported by these browsers.\"\n        // https://github.com/rrweb-io/rrweb/blob/master/guide.md#compatibility-note\n        //\n        // However, MutationObserver does exist on IE11, it just doesn't work well and does not detect all changes.\n        // Instead, when we load \"recorder.js\", the first JS error is about \"Object.assign\" being undefined.\n        // Thus instead of MutationObserver, we look for this function and block recording if it's undefined.\n        if (typeof Object.assign === 'undefined') {\n            return\n        }\n\n        // We do not switch recorder versions midway through a recording.\n        if (this.captureStarted || this.instance.get_config('disable_session_recording')) {\n            return\n        }\n\n        this.captureStarted = true\n        // We want to ensure the sessionManager is reset if necessary on load of the recorder\n        this.instance.sessionManager.checkAndGetSessionAndWindowId()\n\n        const recorderJS = this.getRecordingVersion() === 'v2' ? 'recorder-v2.js' : 'recorder.js'\n\n        // If recorder.js is already loaded (if array.full.js snippet is used or posthog-js/dist/recorder is\n        // imported) or matches the requested recorder version, don't load script. Otherwise, remotely import\n        // recorder.js from cdn since it hasn't been loaded.\n        if (this.instance.__loaded_recorder_version !== this.getRecordingVersion()) {\n            loadScript(\n                this.instance.get_config('api_host') + `/static/${recorderJS}?v=${Config.LIB_VERSION}`,\n                (err) => {\n                    if (err) {\n                        return logger.error(`Could not load ${recorderJS}`, err)\n                    }\n\n                    this._onScriptLoaded()\n                }\n            )\n        } else {\n            this._onScriptLoaded()\n        }\n    }\n\n    _isInteractiveEvent(event: eventWithTime) {\n        return event.type === INCREMENTAL_SNAPSHOT_EVENT_TYPE && ACTIVE_SOURCES.indexOf(event.data?.source) !== -1\n    }\n\n    _updateWindowAndSessionIds(event: eventWithTime) {\n        // Some recording events are triggered by non-user events (e.g. \"X minutes ago\" text updating on the screen).\n        // We don't want to extend the session or trigger a new session in these cases. These events are designated by event\n        // type -> incremental update, and source -> mutation.\n\n        const isUserInteraction = this._isInteractiveEvent(event)\n\n        if (!isUserInteraction && !this.isIdle) {\n            // We check if the lastActivityTimestamp is old enough to go idle\n            if (event.timestamp - this.lastActivityTimestamp > RECORDING_IDLE_ACTIVITY_TIMEOUT_MS) {\n                this.isIdle = true\n            }\n        }\n\n        if (isUserInteraction) {\n            this.lastActivityTimestamp = event.timestamp\n            if (this.isIdle) {\n                // Remove the idle state if set and trigger a full snapshot as we will have ingored previous mutations\n                this.isIdle = false\n                this._tryTakeFullSnapshot()\n            }\n        }\n\n        if (this.isIdle) {\n            return\n        }\n\n        // We only want to extend the session if it is an interactive event.\n        const { windowId, sessionId } = this.instance.sessionManager.checkAndGetSessionAndWindowId(\n            !isUserInteraction,\n            event.timestamp\n        )\n\n        if (\n            [FULL_SNAPSHOT_EVENT_TYPE, META_EVENT_TYPE].indexOf(event.type) === -1 &&\n            (this.windowId !== windowId || this.sessionId !== sessionId)\n        ) {\n            this._tryTakeFullSnapshot()\n        }\n        this.windowId = windowId\n        this.sessionId = sessionId\n    }\n\n    _tryTakeFullSnapshot(): boolean {\n        if (!this.captureStarted) {\n            return false\n        }\n        try {\n            this.rrwebRecord?.takeFullSnapshot()\n            return true\n        } catch (e) {\n            // Sometimes a race can occur where the recorder is not fully started yet, so we can't take a full snapshot.\n            logger.error('Error taking full snapshot.', e)\n            return false\n        }\n    }\n\n    _onScriptLoaded() {\n        // rrweb config info: https://github.com/rrweb-io/rrweb/blob/7d5d0033258d6c29599fb08412202d9a2c7b9413/src/record/index.ts#L28\n        const sessionRecordingOptions: recordOptions<eventWithTime> = {\n            // select set of rrweb config options we expose to our users\n            // see https://github.com/rrweb-io/rrweb/blob/master/guide.md\n            blockClass: 'ph-no-capture',\n            blockSelector: undefined,\n            ignoreClass: 'ph-ignore-input',\n            maskTextClass: 'ph-mask',\n            maskTextSelector: undefined,\n            maskAllInputs: true,\n            maskInputOptions: {},\n            maskInputFn: undefined,\n            slimDOMOptions: {},\n            collectFonts: false,\n            inlineStylesheet: true,\n            recordCrossOriginIframes: false,\n        }\n        // We switched from loading all of rrweb to just the record part, but\n        // keep backwards compatibility if someone hasn't upgraded PostHog\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        this.rrwebRecord = window.rrweb ? window.rrweb.record : window.rrwebRecord\n\n        // only allows user to set our 'allowlisted' options\n        const userSessionRecordingOptions = this.instance.get_config('session_recording')\n        for (const [key, value] of Object.entries(userSessionRecordingOptions || {})) {\n            if (key in sessionRecordingOptions) {\n                // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n                // @ts-ignore\n                sessionRecordingOptions[key] = value\n            }\n        }\n\n        if (!this.rrwebRecord) {\n            logger.error(\n                'onScriptLoaded was called but rrwebRecord is not available. This indicates something has gone wrong.'\n            )\n            return\n        }\n\n        this.stopRrweb = this.rrwebRecord({\n            emit: (event) => {\n                this.onRRwebEmit(event)\n            },\n            plugins:\n                (window as any).rrwebConsoleRecord && this.isConsoleLogCaptureEnabled()\n                    ? [(window as any).rrwebConsoleRecord.getRecordConsolePlugin()]\n                    : [],\n            ...sessionRecordingOptions,\n        })\n\n        // :TRICKY: rrweb does not capture navigation within SPA-s, so hook into our $pageview events to get access to all events.\n        //   Dropping the initial event is fine (it's always captured by rrweb).\n        this.instance._addCaptureHook((eventName) => {\n            // If anything could go wrong here it has the potential to block the main loop so we catch all errors.\n            try {\n                if (eventName === '$pageview') {\n                    this.rrwebRecord?.addCustomEvent('$pageview', { href: window.location.href })\n                }\n            } catch (e) {\n                logger.error('Could not add $pageview to rrweb session', e)\n            }\n        })\n\n        // We reset the last activity timestamp, resetting the idle timer\n        this.lastActivityTimestamp = Date.now()\n        this.isIdle = false\n    }\n\n    onRRwebEmit(event: eventWithTime) {\n        event = truncateLargeConsoleLogs(\n            filterDataURLsFromLargeDataObjects(event) as pluginEvent<{ payload: string[] }>\n        ) as eventWithTime\n\n        this._updateWindowAndSessionIds(event)\n\n        if (this.isIdle) {\n            // When in an idle state we keep recording, but don't capture the events\n            return\n        }\n\n        const properties = {\n            $snapshot_data: event,\n            $session_id: this.sessionId,\n            $window_id: this.windowId,\n        }\n\n        this.instance._captureMetrics.incr('rrweb-record')\n        this.instance._captureMetrics.incr(`rrweb-record-${event.type}`)\n\n        if (this.emit) {\n            this._captureSnapshot(properties)\n        } else {\n            this.snapshots.push(properties)\n        }\n    }\n\n    _captureSnapshot(properties: Properties) {\n        // :TRICKY: Make sure we batch these requests, use a custom endpoint and don't truncate the strings.\n        this.instance.capture('$snapshot', properties, {\n            transport: 'XHR',\n            method: 'POST',\n            endpoint: this.endpoint,\n            _noTruncate: true,\n            _batchKey: 'sessionRecording',\n            _metrics: {\n                rrweb_full_snapshot: properties.$snapshot_data.type === FULL_SNAPSHOT_EVENT_TYPE,\n            },\n        })\n    }\n}\n", "import { isLocalhost, logger } from '../utils'\nimport { PostHog } from '../posthog-core'\nimport { DecideResponse, NetworkRequest } from '../types'\n\nconst PERFORMANCE_EVENTS_MAPPING: { [key: string]: number } = {\n    // BASE_PERFORMANCE_EVENT_COLUMNS\n    entryType: 0,\n    timeOrigin: 1,\n    name: 2,\n\n    // RESOURCE_EVENT_COLUMNS\n    startTime: 3,\n    redirectStart: 4,\n    redirectEnd: 5,\n    workerStart: 6,\n    fetchStart: 7,\n    domainLookupStart: 8,\n    domainLookupEnd: 9,\n    connectStart: 10,\n    secureConnectionStart: 11,\n    connectEnd: 12,\n    requestStart: 13,\n    responseStart: 14,\n    responseEnd: 15,\n    decodedBodySize: 16,\n    encodedBodySize: 17,\n    initiatorType: 18,\n    nextHopProtocol: 19,\n    renderBlockingStatus: 20,\n    responseStatus: 21,\n    transferSize: 22,\n\n    // LARGEST_CONTENTFUL_PAINT_EVENT_COLUMNS\n    element: 23,\n    renderTime: 24,\n    loadTime: 25,\n    size: 26,\n    id: 27,\n    url: 28,\n\n    // NAVIGATION_EVENT_COLUMNS\n    domComplete: 29,\n    domContentLoadedEvent: 30,\n    domInteractive: 31,\n    loadEventEnd: 32,\n    loadEventStart: 33,\n    redirectCount: 34,\n    navigationType: 35,\n    unloadEventEnd: 36,\n    unloadEventStart: 37,\n\n    // Added after v1\n    duration: 39,\n    timestamp: 40,\n\n    // NOTE: CURRENTLY UNSUPPORTED\n    // EVENT_TIMING_EVENT_COLUMNS\n    // processingStart: null,\n    // processingEnd: null,\n\n    // MARK_AND_MEASURE_EVENT_COLUMNS\n    // detail: null,\n}\n\nconst ENTRY_TYPES_TO_OBSERVE = [\n    // 'event', // This is too noisy as it covers all browser events\n    'first-input',\n    // 'mark', // Mark is used too liberally. We would need to filter for specific marks\n    // 'measure', // Measure is used too liberally. We would need to filter for specific measures\n    'navigation',\n    'paint',\n    'resource',\n]\n\nconst PERFORMANCE_INGESTION_ENDPOINT = '/e/'\n// Don't monitor posthog paths because then events cause performance events which are events and the snake eats its tail \uD83D\uDE31\nconst POSTHOG_PATHS_TO_IGNORE = ['/s/', PERFORMANCE_INGESTION_ENDPOINT]\n\nexport class WebPerformanceObserver {\n    instance: PostHog\n    remoteEnabled: boolean | undefined\n    observer: PerformanceObserver | undefined\n\n    // Util to help developers working on this feature manually override\n    _forceAllowLocalhost = false\n\n    constructor(instance: PostHog) {\n        this.instance = instance\n    }\n\n    startObservingIfEnabled() {\n        if (this.isEnabled()) {\n            this.startObserving()\n        } else {\n            this.stopObserving()\n        }\n    }\n\n    startObserving() {\n        if (this.observer) {\n            return\n        }\n\n        if (window?.PerformanceObserver?.supportedEntryTypes === undefined) {\n            logger.log(\n                'PostHog Peformance observer not started because PerformanceObserver is not supported by this browser.'\n            )\n            return\n        }\n\n        if (isLocalhost() && !this._forceAllowLocalhost) {\n            logger.log('PostHog Peformance observer not started because we are on localhost.')\n            return\n        }\n\n        try {\n            this.observer = new PerformanceObserver((list) => {\n                list.getEntries().forEach((entry) => {\n                    this._capturePerformanceEvent(entry)\n                })\n            })\n\n            const entryTypes = PerformanceObserver.supportedEntryTypes.filter((x) => ENTRY_TYPES_TO_OBSERVE.includes(x))\n\n            entryTypes.forEach((entryType) => {\n                this.observer?.observe({ type: entryType, buffered: true })\n            })\n        } catch (e) {\n            console.error('PostHog failed to start performance observer', e)\n            this.stopObserving()\n        }\n    }\n\n    stopObserving() {\n        if (this.observer) {\n            this.observer.disconnect()\n            this.observer = undefined\n        }\n    }\n\n    isObserving() {\n        return !!this.observer\n    }\n\n    isEnabled() {\n        return this.instance.get_config('capture_performance') ?? this.remoteEnabled ?? false\n    }\n\n    afterDecideResponse(response: DecideResponse) {\n        this.remoteEnabled = response.capturePerformance || false\n        if (this.isEnabled()) {\n            this.startObserving()\n        }\n    }\n\n    _capturePerformanceEvent(event: PerformanceEntry) {\n        // NOTE: We don't want to capture our own request events.\n\n        if (event.name.indexOf(this.instance.get_config('api_host')) === 0) {\n            const path = event.name.replace(this.instance.get_config('api_host'), '')\n\n            if (POSTHOG_PATHS_TO_IGNORE.find((x) => path.indexOf(x) === 0)) {\n                return\n            }\n        }\n\n        // NOTE: This is minimal atm but will include more options when we move to the\n        // built in rrweb network recorder\n        let networkRequest: NetworkRequest | null | undefined = {\n            url: event.name,\n        }\n\n        const userSessionRecordingOptions = this.instance.get_config('session_recording')\n\n        if (userSessionRecordingOptions.maskNetworkRequestFn) {\n            networkRequest = userSessionRecordingOptions.maskNetworkRequestFn(networkRequest)\n        }\n\n        if (!networkRequest) {\n            return\n        }\n\n        const eventJson = event.toJSON()\n        eventJson.name = networkRequest.url\n        const properties: { [key: number]: any } = {}\n        // kudos to sentry javascript sdk for excellent background on why to use Date.now() here\n        // https://github.com/getsentry/sentry-javascript/blob/e856e40b6e71a73252e788cd42b5260f81c9c88e/packages/utils/src/time.ts#L70\n        const timeOrigin = Math.floor(Date.now() - performance.now())\n        properties[PERFORMANCE_EVENTS_MAPPING['timeOrigin']] = timeOrigin\n        // clickhouse can't ingest timestamps that are floats\n        // (in this case representing fractions of a millisecond we don't care about anyway)\n        properties[PERFORMANCE_EVENTS_MAPPING['timestamp']] = Math.floor(timeOrigin + event.startTime)\n        for (const key in PERFORMANCE_EVENTS_MAPPING) {\n            if (eventJson[key] !== undefined) {\n                properties[PERFORMANCE_EVENTS_MAPPING[key]] = eventJson[key]\n            }\n        }\n\n        this.capturePerformanceEvent(properties)\n\n        if (exposesServerTiming(event)) {\n            for (const timing of event.serverTiming || []) {\n                this.capturePerformanceEvent({\n                    [PERFORMANCE_EVENTS_MAPPING['timeOrigin']]: timeOrigin,\n                    [PERFORMANCE_EVENTS_MAPPING['timestamp']]: Math.floor(timeOrigin + event.startTime),\n                    [PERFORMANCE_EVENTS_MAPPING['name']]: timing.name,\n                    [PERFORMANCE_EVENTS_MAPPING['duration']]: timing.duration,\n                    // the spec has a closed list of possible types\n                    // https://developer.mozilla.org/en-US/docs/Web/API/PerformanceEntry/entryType\n                    // but, we need to know this was a server timing so that we know to\n                    // match it to the appropriate navigation or resource timing\n                    // that matching will have to be on timestamp and $current_url\n                    [PERFORMANCE_EVENTS_MAPPING['entryType']]: 'serverTiming',\n                })\n            }\n        }\n    }\n\n    /**\n     * :TRICKY: Make sure we batch these requests, and don't truncate the strings.\n     */\n    private capturePerformanceEvent(properties: { [key: number]: any }) {\n        const timestamp = properties[PERFORMANCE_EVENTS_MAPPING['timestamp']]\n\n        this.instance.sessionRecording?.onRRwebEmit({\n            type: 6, // EventType.Plugin,\n            data: {\n                plugin: 'posthog/network@1',\n                payload: properties,\n            },\n            timestamp,\n        })\n\n        // this.instance.capture('$performance_event', properties, {\n        //     transport: 'XHR',\n        //     method: 'POST',\n        //     endpoint: PERFORMANCE_INGESTION_ENDPOINT,\n        //     _noTruncate: true,\n        //     _batchKey: 'performanceEvent',\n        // })\n    }\n}\n\n/**\n *  Check if this PerformanceEntry is either a PerformanceResourceTiming or a PerformanceNavigationTiming\n *  NB PerformanceNavigationTiming extends PerformanceResourceTiming\n *  Here we don't care which interface it implements as both expose `serverTimings`\n */\nconst exposesServerTiming = (event: PerformanceEntry): event is PerformanceResourceTiming =>\n    event.entryType === 'navigation' || event.entryType === 'resource'\n", "import { autocapture } from './autocapture'\nimport { _base64Encode, loadScript } from './utils'\nimport { PostHog } from './posthog-core'\nimport { Compression, DecideResponse } from './types'\nimport { STORED_GROUP_PROPERTIES_KEY, STORED_PERSON_PROPERTIES_KEY } from './posthog-persistence'\n\nexport class Decide {\n    instance: PostHog\n\n    constructor(instance: PostHog) {\n        this.instance = instance\n        // don't need to wait for `decide` to return if flags were provided on initialisation\n        this.instance.decideEndpointWasHit = this.instance._hasBootstrappedFeatureFlags()\n    }\n\n    call(): void {\n        /*\n        Calls /decide endpoint to fetch options for autocapture, session recording, feature flags & compression.\n        */\n        const json_data = JSON.stringify({\n            token: this.instance.get_config('token'),\n            distinct_id: this.instance.get_distinct_id(),\n            groups: this.instance.getGroups(),\n            person_properties: this.instance.get_property(STORED_PERSON_PROPERTIES_KEY),\n            group_properties: this.instance.get_property(STORED_GROUP_PROPERTIES_KEY),\n        })\n\n        const encoded_data = _base64Encode(json_data)\n        this.instance._send_request(\n            `${this.instance.get_config('api_host')}/decide/?v=3`,\n            { data: encoded_data, verbose: true },\n            { method: 'POST' },\n            (response) => this.parseDecideResponse(response as DecideResponse)\n        )\n    }\n\n    parseDecideResponse(response: DecideResponse): void {\n        if (response?.status === 0) {\n            console.error('Failed to fetch feature flags from PostHog.')\n            return\n        }\n        this.instance.decideEndpointWasHit = true\n        if (!(document && document.body)) {\n            console.log('document not ready yet, trying again in 500 milliseconds...')\n            setTimeout(() => {\n                this.parseDecideResponse(response)\n            }, 500)\n            return\n        }\n\n        this.instance.toolbar.afterDecideResponse(response)\n        this.instance.sessionRecording?.afterDecideResponse(response)\n        autocapture.afterDecideResponse(response, this.instance)\n        this.instance.webPerformance?.afterDecideResponse(response)\n        this.instance.exceptionAutocapture?.afterDecideResponse(response)\n\n        this.instance.featureFlags.receivedFeatureFlags(response)\n\n        this.instance['compression'] = {}\n        if (response['supportedCompression'] && !this.instance.get_config('disable_compression')) {\n            const compression: Partial<Record<Compression, boolean>> = {}\n            for (const method of response['supportedCompression']) {\n                compression[method] = true\n            }\n            this.instance['compression'] = compression\n        }\n\n        if (response['siteApps']) {\n            if (this.instance.get_config('opt_in_site_apps')) {\n                const apiHost = this.instance.get_config('api_host')\n                for (const { id, url } of response['siteApps']) {\n                    const scriptUrl = [\n                        apiHost,\n                        apiHost[apiHost.length - 1] === '/' && url[0] === '/' ? url.substring(1) : url,\n                    ].join('')\n\n                    ;(window as any)[`__$$ph_site_app_${id}`] = this.instance\n\n                    loadScript(scriptUrl, (err) => {\n                        if (err) {\n                            console.error(`Error while initializing PostHog app with config id ${id}`, err)\n                        }\n                    })\n                }\n            } else if (response['siteApps'].length > 0) {\n                console.error('PostHog site apps are disabled. Enable the \"opt_in_site_apps\" config to proceed.')\n            }\n        }\n    }\n}\n", "export const POSTHOG_MANAGED_HOSTS = ['https://app.posthog.com', 'https://eu.posthog.com']\n", "import { _getHashParam, _register_event, loadScript, logger } from '../utils'\nimport { PostHog } from '../posthog-core'\nimport { DecideResponse, ToolbarParams } from '../types'\nimport { POSTHOG_MANAGED_HOSTS } from './cloud'\n\nexport class Toolbar {\n    instance: PostHog\n    constructor(instance: PostHog) {\n        this.instance = instance\n    }\n\n    afterDecideResponse(response: DecideResponse) {\n        const toolbarParams: ToolbarParams =\n            response['toolbarParams'] ||\n            response['editorParams'] ||\n            (response['toolbarVersion'] ? { toolbarVersion: response['toolbarVersion'] } : {})\n        if (\n            response['isAuthenticated'] &&\n            toolbarParams['toolbarVersion'] &&\n            toolbarParams['toolbarVersion'].indexOf('toolbar') === 0\n        ) {\n            this.loadToolbar({\n                ...toolbarParams,\n            })\n        }\n    }\n\n    /**\n     * To load the toolbar, we need an access token and other state. That state comes from one of three places:\n     * 1. In the URL hash params\n     * 2. From session storage under the key `toolbarParams` if the toolbar was initialized on a previous page\n     */\n    maybeLoadToolbar(\n        location = window.location,\n        localStorage: Storage | undefined = undefined,\n        history = window.history\n    ): boolean {\n        try {\n            // Before running the code we check if we can access localStorage, if not we opt-out\n            if (!localStorage) {\n                try {\n                    window.localStorage.setItem('test', 'test')\n                    window.localStorage.removeItem('test')\n                } catch (error) {\n                    return false\n                }\n\n                // If localStorage was undefined, and localStorage is supported we set the default value\n                localStorage = window.localStorage\n            }\n\n            const stateHash = _getHashParam(location.hash, '__posthog') || _getHashParam(location.hash, 'state')\n            const state = stateHash ? JSON.parse(decodeURIComponent(stateHash)) : null\n            const parseFromUrl = state && state['action'] === 'ph_authorize'\n            let toolbarParams: ToolbarParams\n\n            if (parseFromUrl) {\n                // happens if they are initializing the toolbar using an old snippet\n                toolbarParams = state\n                toolbarParams.source = 'url'\n\n                if (toolbarParams && Object.keys(toolbarParams).length > 0) {\n                    if (state['desiredHash']) {\n                        // hash that was in the url before the redirect\n                        location.hash = state['desiredHash']\n                    } else if (history) {\n                        history.replaceState('', document.title, location.pathname + location.search) // completely remove hash\n                    } else {\n                        location.hash = '' // clear hash (but leaves # unfortunately)\n                    }\n                }\n            } else {\n                // get credentials from localStorage from a previous initialzation\n                toolbarParams = JSON.parse(localStorage.getItem('_postHogToolbarParams') || '{}')\n                toolbarParams.source = 'localstorage'\n\n                // delete \"add-action\" or other intent from toolbarParams, otherwise we'll have the same intent\n                // every time we open the page (e.g. you just visiting your own site an hour later)\n                delete toolbarParams.userIntent\n            }\n\n            if (toolbarParams['token'] && this.instance.get_config('token') === toolbarParams['token']) {\n                this.loadToolbar(toolbarParams)\n                return true\n            } else {\n                return false\n            }\n        } catch (e) {\n            return false\n        }\n    }\n\n    loadToolbar(params?: ToolbarParams): boolean {\n        if ((window as any)['_postHogToolbarLoaded']) {\n            return false\n        }\n        // only load the toolbar once, even if there are multiple instances of PostHogLib\n        ;(window as any)['_postHogToolbarLoaded'] = true\n\n        // By design array.js, recorder.js, and toolbar.js are served from Django with no or limited caching, not from our CDN\n        // Django respects the query params for caching, returning a 304 if appropriate\n        const host = this.instance.get_config('api_host')\n        const timestampToNearestThirtySeconds = Math.floor(Date.now() / 30000) * 30000\n        const toolbarUrl = `${host}${\n            host.endsWith('/') ? '' : '/'\n        }static/toolbar.js?_ts=${timestampToNearestThirtySeconds}`\n        const disableToolbarMetrics =\n            !POSTHOG_MANAGED_HOSTS.includes(this.instance.get_config('api_host')) &&\n            this.instance.get_config('advanced_disable_toolbar_metrics')\n\n        const toolbarParams = {\n            token: this.instance.get_config('token'),\n            ...params,\n            apiURL: host, // defaults to api_host from the instance config if nothing else set\n            ...(disableToolbarMetrics ? { instrument: false } : {}),\n        }\n\n        const { source: _discard, ...paramsToPersist } = toolbarParams // eslint-disable-line\n        window.localStorage.setItem('_postHogToolbarParams', JSON.stringify(paramsToPersist))\n\n        loadScript(toolbarUrl, (err) => {\n            if (err) {\n                logger.error('Failed to load toolbar', err)\n                return\n            }\n            ;((window as any)['ph_load_toolbar'] || (window as any)['ph_load_editor'])(toolbarParams, this.instance)\n        })\n        // Turbolinks doesn't fire an onload event but does replace the entire body, including the toolbar.\n        // Thus, we ensure the toolbar is only loaded inside the body, and then reloaded on turbolinks:load.\n        _register_event(window, 'turbolinks:load', () => {\n            ;(window as any)['_postHogToolbarLoaded'] = false\n            this.loadToolbar(toolbarParams)\n        })\n        return true\n    }\n\n    /** @deprecated Use \"loadToolbar\" instead. */\n    _loadEditor(params: ToolbarParams): boolean {\n        return this.loadToolbar(params)\n    }\n\n    /** @deprecated Use \"maybeLoadToolbar\" instead. */\n    maybeLoadEditor(\n        location = window.location,\n        localStorage: Storage | undefined = undefined,\n        history = window.history\n    ): boolean {\n        return this.maybeLoadToolbar(location, localStorage, history)\n    }\n}\n", "export class RequestQueueScaffold {\n    isPolling: boolean // flag to continue to recursively poll or not\n    _event_queue: any[]\n    _empty_queue_count: number // to track empty polls\n    _poller: number | undefined // to become interval for reference to clear later\n    _pollInterval: number\n\n    constructor(pollInterval = 3000) {\n        this.isPolling = true // flag to continue to recursively poll or not\n        this._event_queue = []\n        this._empty_queue_count = 0 // to track empty polls\n        this._poller = undefined // to become interval for reference to clear later\n        this._pollInterval = pollInterval\n    }\n\n    setPollInterval(interval: number): void {\n        this._pollInterval = interval\n        // Reset interval if running already\n        if (this.isPolling) {\n            this.poll()\n        }\n    }\n\n    // // eslint-disable-next-line no-unused-vars\n    // enqueue(_requestData: Record<string, any>): void {\n    //     return\n    // }\n\n    poll(): void {\n        return\n    }\n\n    unload(): void {\n        return\n    }\n\n    getTime(): number {\n        return new Date().getTime()\n    }\n}\n", "import { RequestQueueScaffold } from './base-request-queue'\nimport { _each } from './utils'\nimport { CaptureMetrics } from './capture-metrics'\nimport { Properties, QueuedRequestData, XHROptions } from './types'\n\nexport class RequestQueue extends RequestQueueScaffold {\n    captureMetrics: CaptureMetrics\n    handlePollRequest: (url: string, data: Properties, options?: XHROptions) => void\n\n    constructor(\n        captureMetrics: CaptureMetrics,\n        handlePollRequest: (url: string, data: Properties, options?: XHROptions) => void,\n        pollInterval = 3000\n    ) {\n        super(pollInterval)\n        this.handlePollRequest = handlePollRequest\n        this.captureMetrics = captureMetrics\n    }\n\n    enqueue(url: string, data: Properties, options: XHROptions): void {\n        this.captureMetrics.incr('batch-enqueue')\n\n        this._event_queue.push({ url, data, options })\n\n        if (!this.isPolling) {\n            this.isPolling = true\n            this.poll()\n        }\n    }\n\n    poll(): void {\n        clearTimeout(this._poller)\n        this._poller = setTimeout(() => {\n            if (this._event_queue.length > 0) {\n                const requests = this.formatQueue()\n                for (const key in requests) {\n                    const { url, data, options } = requests[key]\n                    _each(data, (_, dataKey) => {\n                        data[dataKey]['offset'] = Math.abs(data[dataKey]['timestamp'] - this.getTime())\n                        delete data[dataKey]['timestamp']\n                    })\n                    this.handlePollRequest(url, data, options)\n\n                    this.captureMetrics.incr('batch-requests')\n                    this.captureMetrics.incr(`batch-requests-${url.slice(url.length - 2)}`)\n                    this.captureMetrics.incr('batch-handle', data.length)\n                    this.captureMetrics.incr(`batch-handle-${url.slice(url.length - 2)}`, data.length)\n                }\n                this._event_queue.length = 0 // flush the _event_queue\n                this._empty_queue_count = 0\n            } else {\n                this._empty_queue_count++\n            }\n\n            /**\n             * _empty_queue_count will increment each time the queue is polled\n             *  and it is empty. To avoid empty polling (user went idle, stepped away from comp)\n             *  we can turn it off with the isPolling flag.\n             *\n             * Polling will be re enabled when the next time PostHogLib.capture is called with\n             *  an event that should be added to the event queue.\n             */\n            if (this._empty_queue_count > 4) {\n                this.isPolling = false\n                this._empty_queue_count = 0\n            }\n            if (this.isPolling) {\n                this.poll()\n            }\n        }, this._pollInterval) as any as number\n    }\n\n    updateUnloadMetrics(): void {\n        const requests = this.formatQueue()\n        for (const key in requests) {\n            const { url, data } = requests[key]\n\n            this.captureMetrics.incr('batch-unload-requests')\n            this.captureMetrics.incr(`batch-unload-requests-${url.slice(url.length - 2)}`)\n            this.captureMetrics.incr('batch-unload', data.length)\n            this.captureMetrics.incr(`batch-unload-${url.slice(url.length - 2)}`, data.length)\n        }\n    }\n\n    unload(): void {\n        clearTimeout(this._poller)\n        const requests = this._event_queue.length > 0 ? this.formatQueue() : {}\n        this._event_queue.length = 0\n        const requestValues = Object.values(requests)\n\n        // Always force events to be sent before recordings, as events are more important, and recordings are bigger and thus less likely to arrive\n        const sortedRequests = [\n            ...requestValues.filter((r) => r.url.indexOf('/e') === 0),\n            ...requestValues.filter((r) => r.url.indexOf('/e') !== 0),\n        ]\n        sortedRequests.map(({ url, data, options }) => {\n            this.handlePollRequest(url, data, { ...options, transport: 'sendBeacon' })\n        })\n    }\n\n    formatQueue(): Record<string, QueuedRequestData> {\n        const requests: Record<string, QueuedRequestData> = {}\n        _each(this._event_queue, (request) => {\n            const { url, data, options } = request\n            const key = (options ? options._batchKey : null) || url\n            if (requests[key] === undefined) {\n                requests[key] = { data: [], url, options }\n            }\n\n            // :TRICKY: Metrics-only code\n            if (\n                options &&\n                requests[key].options &&\n                requests[key].options._metrics &&\n                !(requests[key].options._metrics as any)['rrweb_full_snapshot']\n            ) {\n                ;(requests[key].options._metrics as any)['rrweb_full_snapshot'] =\n                    options._metrics['rrweb_full_snapshot']\n            }\n            requests[key].data.push(data)\n        })\n        return requests\n    }\n}\n", "export class CaptureMetrics {\n    enabled: boolean\n    metrics: Record<string, number>\n\n    constructor(enabled: boolean) {\n        this.enabled = enabled\n        this.metrics = {}\n    }\n\n    incr(key: string, by = 1): void {\n        if (this.enabled) {\n            key = `phjs-${key}`\n            this.metrics[key] = (this.metrics[key] || 0) + by\n        }\n    }\n\n    decr(key: string): void {\n        if (this.enabled) {\n            key = `phjs-${key}`\n            this.metrics[key] = (this.metrics[key] || 0) - 1\n        }\n    }\n}\n", "// DEFLATE is a complex format; to read this code, you should probably check the RFC first:\n// https://tools.ietf.org/html/rfc1951\n// You may also wish to take a look at the guide I made about this program:\n// https://gist.github.com/101arrowz/253f31eb5abc3d9275ab943003ffecad\n// Much of the following code is similar to that of UZIP.js:\n// https://github.com/photopea/UZIP.js\n// Many optimizations have been made, so the bundle size is ultimately smaller but performance is similar.\n// Sometimes 0 will appear where -1 would be more appropriate. This is because using a uint\n// is better for memory in most engines (I *think*).\nvar ch2 = {};\nvar wk = (function (c, id, msg, transfer, cb) {\n    var u = ch2[id] || (ch2[id] = URL.createObjectURL(new Blob([c], { type: 'text/javascript' })));\n    var w = new Worker(u);\n    w.onerror = function (e) { return cb(e.error, null); };\n    w.onmessage = function (e) { return cb(null, e.data); };\n    w.postMessage(msg, transfer);\n    return w;\n});\n\n// aliases for shorter compressed code (most minifers don't do this)\nvar u8 = Uint8Array, u16 = Uint16Array, u32 = Uint32Array;\n// fixed length extra bits\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, /* unused */ 0, 0, /* impossible */ 0]);\n// fixed distance extra bits\n// see fleb note\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, /* unused */ 0, 0]);\n// code length index map\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n// get base, reverse index map from extra bits\nvar freb = function (eb, start) {\n    var b = new u16(31);\n    for (var i = 0; i < 31; ++i) {\n        b[i] = start += 1 << eb[i - 1];\n    }\n    // numbers here are at max 18 bits\n    var r = new u32(b[30]);\n    for (var i = 1; i < 30; ++i) {\n        for (var j = b[i]; j < b[i + 1]; ++j) {\n            r[j] = ((j - b[i]) << 5) | i;\n        }\n    }\n    return [b, r];\n};\nvar _a = freb(fleb, 2), fl = _a[0], revfl = _a[1];\n// we can ignore the fact that the other numbers are wrong; they never happen anyway\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0), fd = _b[0], revfd = _b[1];\n// map of value to reverse (assuming 16 bits)\nvar rev = new u16(32768);\nfor (var i = 0; i < 32768; ++i) {\n    // reverse table algorithm from SO\n    var x = ((i & 0xAAAA) >>> 1) | ((i & 0x5555) << 1);\n    x = ((x & 0xCCCC) >>> 2) | ((x & 0x3333) << 2);\n    x = ((x & 0xF0F0) >>> 4) | ((x & 0x0F0F) << 4);\n    rev[i] = (((x & 0xFF00) >>> 8) | ((x & 0x00FF) << 8)) >>> 1;\n}\n// create huffman tree from u8 \"map\": index -> code length for code index\n// mb (max bits) must be at most 15\n// TODO: optimize/split up?\nvar hMap = (function (cd, mb, r) {\n    var s = cd.length;\n    // index\n    var i = 0;\n    // u16 \"map\": index -> # of codes with bit length = index\n    var l = new u16(mb);\n    // length of cd must be 288 (total # of codes)\n    for (; i < s; ++i)\n        ++l[cd[i] - 1];\n    // u16 \"map\": index -> minimum code for bit length = index\n    var le = new u16(mb);\n    for (i = 0; i < mb; ++i) {\n        le[i] = (le[i - 1] + l[i - 1]) << 1;\n    }\n    var co;\n    if (r) {\n        // u16 \"map\": index -> number of actual bits, symbol for code\n        co = new u16(1 << mb);\n        // bits to remove for reverser\n        var rvb = 15 - mb;\n        for (i = 0; i < s; ++i) {\n            // ignore 0 lengths\n            if (cd[i]) {\n                // num encoding both symbol and bits read\n                var sv = (i << 4) | cd[i];\n                // free bits\n                var r_1 = mb - cd[i];\n                // start value\n                var v = le[cd[i] - 1]++ << r_1;\n                // m is end value\n                for (var m = v | ((1 << r_1) - 1); v <= m; ++v) {\n                    // every 16 bit value starting with the code yields the same result\n                    co[rev[v] >>> rvb] = sv;\n                }\n            }\n        }\n    }\n    else {\n        co = new u16(s);\n        for (i = 0; i < s; ++i)\n            co[i] = rev[le[cd[i] - 1]++] >>> (15 - cd[i]);\n    }\n    return co;\n});\n// fixed length tree\nvar flt = new u8(288);\nfor (var i = 0; i < 144; ++i)\n    flt[i] = 8;\nfor (var i = 144; i < 256; ++i)\n    flt[i] = 9;\nfor (var i = 256; i < 280; ++i)\n    flt[i] = 7;\nfor (var i = 280; i < 288; ++i)\n    flt[i] = 8;\n// fixed distance tree\nvar fdt = new u8(32);\nfor (var i = 0; i < 32; ++i)\n    fdt[i] = 5;\n// fixed length map\nvar flm = /*#__PURE__*/ hMap(flt, 9, 0), flrm = /*#__PURE__*/ hMap(flt, 9, 1);\n// fixed distance map\nvar fdm = /*#__PURE__*/ hMap(fdt, 5, 0), fdrm = /*#__PURE__*/ hMap(fdt, 5, 1);\n// find max of array\nvar max = function (a) {\n    var m = a[0];\n    for (var i = 1; i < a.length; ++i) {\n        if (a[i] > m)\n            m = a[i];\n    }\n    return m;\n};\n// read d, starting at bit p and mask with m\nvar bits = function (d, p, m) {\n    var o = (p / 8) >> 0;\n    return ((d[o] | (d[o + 1] << 8)) >>> (p & 7)) & m;\n};\n// read d, starting at bit p continuing for at least 16 bits\nvar bits16 = function (d, p) {\n    var o = (p / 8) >> 0;\n    return ((d[o] | (d[o + 1] << 8) | (d[o + 2] << 16)) >>> (p & 7));\n};\n// get end of byte\nvar shft = function (p) { return ((p / 8) >> 0) + (p & 7 && 1); };\n// typed array slice - allows garbage collector to free original reference,\n// while being more compatible than .slice\nvar slc = function (v, s, e) {\n    if (s == null || s < 0)\n        s = 0;\n    if (e == null || e > v.length)\n        e = v.length;\n    // can't use .constructor in case user-supplied\n    var n = new (v instanceof u16 ? u16 : v instanceof u32 ? u32 : u8)(e - s);\n    n.set(v.subarray(s, e));\n    return n;\n};\n// expands raw DEFLATE data\nvar inflt = function (dat, buf, st) {\n    // source length\n    var sl = dat.length;\n    // have to estimate size\n    var noBuf = !buf || st;\n    // no state\n    var noSt = !st || st.i;\n    if (!st)\n        st = {};\n    // Assumes roughly 33% compression ratio average\n    if (!buf)\n        buf = new u8(sl * 3);\n    // ensure buffer can fit at least l elements\n    var cbuf = function (l) {\n        var bl = buf.length;\n        // need to increase size to fit\n        if (l > bl) {\n            // Double or set to necessary, whichever is greater\n            var nbuf = new u8(Math.max(bl * 2, l));\n            nbuf.set(buf);\n            buf = nbuf;\n        }\n    };\n    //  last chunk         bitpos           bytes\n    var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n    // total bits\n    var tbts = sl * 8;\n    do {\n        if (!lm) {\n            // BFINAL - this is only 1 when last chunk is next\n            st.f = final = bits(dat, pos, 1);\n            // type: 0 = no compression, 1 = fixed huffman, 2 = dynamic huffman\n            var type = bits(dat, pos + 1, 3);\n            pos += 3;\n            if (!type) {\n                // go to end of byte boundary\n                var s = shft(pos) + 4, l = dat[s - 4] | (dat[s - 3] << 8), t = s + l;\n                if (t > sl) {\n                    if (noSt)\n                        throw 'unexpected EOF';\n                    break;\n                }\n                // ensure size\n                if (noBuf)\n                    cbuf(bt + l);\n                // Copy over uncompressed data\n                buf.set(dat.subarray(s, t), bt);\n                // Get new bitpos, update byte count\n                st.b = bt += l, st.p = pos = t * 8;\n                continue;\n            }\n            else if (type == 1)\n                lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n            else if (type == 2) {\n                //  literal                            lengths\n                var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n                var tl = hLit + bits(dat, pos + 5, 31) + 1;\n                pos += 14;\n                // length+distance tree\n                var ldt = new u8(tl);\n                // code length tree\n                var clt = new u8(19);\n                for (var i = 0; i < hcLen; ++i) {\n                    // use index map to get real code\n                    clt[clim[i]] = bits(dat, pos + i * 3, 7);\n                }\n                pos += hcLen * 3;\n                // code lengths bits\n                var clb = max(clt), clbmsk = (1 << clb) - 1;\n                if (!noSt && pos + tl * (clb + 7) > tbts)\n                    break;\n                // code lengths map\n                var clm = hMap(clt, clb, 1);\n                for (var i = 0; i < tl;) {\n                    var r = clm[bits(dat, pos, clbmsk)];\n                    // bits read\n                    pos += r & 15;\n                    // symbol\n                    var s = r >>> 4;\n                    // code length to copy\n                    if (s < 16) {\n                        ldt[i++] = s;\n                    }\n                    else {\n                        //  copy   count\n                        var c = 0, n = 0;\n                        if (s == 16)\n                            n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n                        else if (s == 17)\n                            n = 3 + bits(dat, pos, 7), pos += 3;\n                        else if (s == 18)\n                            n = 11 + bits(dat, pos, 127), pos += 7;\n                        while (n--)\n                            ldt[i++] = c;\n                    }\n                }\n                //    length tree                 distance tree\n                var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n                // max length bits\n                lbt = max(lt);\n                // max dist bits\n                dbt = max(dt);\n                lm = hMap(lt, lbt, 1);\n                dm = hMap(dt, dbt, 1);\n            }\n            else\n                throw 'invalid block type';\n            if (pos > tbts)\n                throw 'unexpected EOF';\n        }\n        // Make sure the buffer can hold this + the largest possible addition\n        // Maximum chunk size (practically, theoretically infinite) is 2^17;\n        if (noBuf)\n            cbuf(bt + 131072);\n        var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n        var mxa = lbt + dbt + 18;\n        while (noSt || pos + mxa < tbts) {\n            // bits read, code\n            var c = lm[bits16(dat, pos) & lms], sym = c >>> 4;\n            pos += c & 15;\n            if (pos > tbts)\n                throw 'unexpected EOF';\n            if (!c)\n                throw 'invalid length/literal';\n            if (sym < 256)\n                buf[bt++] = sym;\n            else if (sym == 256) {\n                lm = null;\n                break;\n            }\n            else {\n                var add = sym - 254;\n                // no extra bits needed if less\n                if (sym > 264) {\n                    // index\n                    var i = sym - 257, b = fleb[i];\n                    add = bits(dat, pos, (1 << b) - 1) + fl[i];\n                    pos += b;\n                }\n                // dist\n                var d = dm[bits16(dat, pos) & dms], dsym = d >>> 4;\n                if (!d)\n                    throw 'invalid distance';\n                pos += d & 15;\n                var dt = fd[dsym];\n                if (dsym > 3) {\n                    var b = fdeb[dsym];\n                    dt += bits16(dat, pos) & ((1 << b) - 1), pos += b;\n                }\n                if (pos > tbts)\n                    throw 'unexpected EOF';\n                if (noBuf)\n                    cbuf(bt + 131072);\n                var end = bt + add;\n                for (; bt < end; bt += 4) {\n                    buf[bt] = buf[bt - dt];\n                    buf[bt + 1] = buf[bt + 1 - dt];\n                    buf[bt + 2] = buf[bt + 2 - dt];\n                    buf[bt + 3] = buf[bt + 3 - dt];\n                }\n                bt = end;\n            }\n        }\n        st.l = lm, st.p = pos, st.b = bt;\n        if (lm)\n            final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n    } while (!final);\n    return bt == buf.length ? buf : slc(buf, 0, bt);\n};\n// starting at p, write the minimum number of bits that can hold v to d\nvar wbits = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) >> 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n};\n// starting at p, write the minimum number of bits (>8) that can hold v to d\nvar wbits16 = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) >> 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n    d[o + 2] |= v >>> 16;\n};\n// creates code lengths from a frequency table\nvar hTree = function (d, mb) {\n    // Need extra info to make a tree\n    var t = [];\n    for (var i = 0; i < d.length; ++i) {\n        if (d[i])\n            t.push({ s: i, f: d[i] });\n    }\n    var s = t.length;\n    var t2 = t.slice();\n    if (!s)\n        return [new u8(0), 0];\n    if (s == 1) {\n        var v = new u8(t[0].s + 1);\n        v[t[0].s] = 1;\n        return [v, 1];\n    }\n    t.sort(function (a, b) { return a.f - b.f; });\n    // after i2 reaches last ind, will be stopped\n    // freq must be greater than largest possible number of symbols\n    t.push({ s: -1, f: 25001 });\n    var l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n    t[0] = { s: -1, f: l.f + r.f, l: l, r: r };\n    // efficient algorithm from UZIP.js\n    // i0 is lookbehind, i2 is lookahead - after processing two low-freq\n    // symbols that combined have high freq, will start processing i2 (high-freq,\n    // non-composite) symbols instead\n    // see https://reddit.com/r/photopea/comments/ikekht/uzipjs_questions/\n    while (i1 != s - 1) {\n        l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n        r = t[i0 != i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n        t[i1++] = { s: -1, f: l.f + r.f, l: l, r: r };\n    }\n    var maxSym = t2[0].s;\n    for (var i = 1; i < s; ++i) {\n        if (t2[i].s > maxSym)\n            maxSym = t2[i].s;\n    }\n    // code lengths\n    var tr = new u16(maxSym + 1);\n    // max bits in tree\n    var mbt = ln(t[i1 - 1], tr, 0);\n    if (mbt > mb) {\n        // more algorithms from UZIP.js\n        // TODO: find out how this code works (debt)\n        //  ind    debt\n        var i = 0, dt = 0;\n        //    left            cost\n        var lft = mbt - mb, cst = 1 << lft;\n        t2.sort(function (a, b) { return tr[b.s] - tr[a.s] || a.f - b.f; });\n        for (; i < s; ++i) {\n            var i2_1 = t2[i].s;\n            if (tr[i2_1] > mb) {\n                dt += cst - (1 << (mbt - tr[i2_1]));\n                tr[i2_1] = mb;\n            }\n            else\n                break;\n        }\n        dt >>>= lft;\n        while (dt > 0) {\n            var i2_2 = t2[i].s;\n            if (tr[i2_2] < mb)\n                dt -= 1 << (mb - tr[i2_2]++ - 1);\n            else\n                ++i;\n        }\n        for (; i >= 0 && dt; --i) {\n            var i2_3 = t2[i].s;\n            if (tr[i2_3] == mb) {\n                --tr[i2_3];\n                ++dt;\n            }\n        }\n        mbt = mb;\n    }\n    return [new u8(tr), mbt];\n};\n// get the max length and assign length codes\nvar ln = function (n, l, d) {\n    return n.s == -1\n        ? Math.max(ln(n.l, l, d + 1), ln(n.r, l, d + 1))\n        : (l[n.s] = d);\n};\n// length codes generation\nvar lc = function (c) {\n    var s = c.length;\n    // Note that the semicolon was intentional\n    while (s && !c[--s])\n        ;\n    var cl = new u16(++s);\n    //  ind      num         streak\n    var cli = 0, cln = c[0], cls = 1;\n    var w = function (v) { cl[cli++] = v; };\n    for (var i = 1; i <= s; ++i) {\n        if (c[i] == cln && i != s)\n            ++cls;\n        else {\n            if (!cln && cls > 2) {\n                for (; cls > 138; cls -= 138)\n                    w(32754);\n                if (cls > 2) {\n                    w(cls > 10 ? ((cls - 11) << 5) | 28690 : ((cls - 3) << 5) | 12305);\n                    cls = 0;\n                }\n            }\n            else if (cls > 3) {\n                w(cln), --cls;\n                for (; cls > 6; cls -= 6)\n                    w(8304);\n                if (cls > 2)\n                    w(((cls - 3) << 5) | 8208), cls = 0;\n            }\n            while (cls--)\n                w(cln);\n            cls = 1;\n            cln = c[i];\n        }\n    }\n    return [cl.subarray(0, cli), s];\n};\n// calculate the length of output from tree, code lengths\nvar clen = function (cf, cl) {\n    var l = 0;\n    for (var i = 0; i < cl.length; ++i)\n        l += cf[i] * cl[i];\n    return l;\n};\n// writes a fixed block\n// returns the new bit pos\nvar wfblk = function (out, pos, dat) {\n    // no need to write 00 as type: TypedArray defaults to 0\n    var s = dat.length;\n    var o = shft(pos + 2);\n    out[o] = s & 255;\n    out[o + 1] = s >>> 8;\n    out[o + 2] = out[o] ^ 255;\n    out[o + 3] = out[o + 1] ^ 255;\n    for (var i = 0; i < s; ++i)\n        out[o + i + 4] = dat[i];\n    return (o + 4 + s) * 8;\n};\n// writes a block\nvar wblk = function (dat, out, final, syms, lf, df, eb, li, bs, bl, p) {\n    wbits(out, p++, final);\n    ++lf[256];\n    var _a = hTree(lf, 15), dlt = _a[0], mlb = _a[1];\n    var _b = hTree(df, 15), ddt = _b[0], mdb = _b[1];\n    var _c = lc(dlt), lclt = _c[0], nlc = _c[1];\n    var _d = lc(ddt), lcdt = _d[0], ndc = _d[1];\n    var lcfreq = new u16(19);\n    for (var i = 0; i < lclt.length; ++i)\n        lcfreq[lclt[i] & 31]++;\n    for (var i = 0; i < lcdt.length; ++i)\n        lcfreq[lcdt[i] & 31]++;\n    var _e = hTree(lcfreq, 7), lct = _e[0], mlcb = _e[1];\n    var nlcc = 19;\n    for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc)\n        ;\n    var flen = (bl + 5) << 3;\n    var ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n    var dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + (2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18]);\n    if (flen <= ftlen && flen <= dtlen)\n        return wfblk(out, p, dat.subarray(bs, bs + bl));\n    var lm, ll, dm, dl;\n    wbits(out, p, 1 + (dtlen < ftlen)), p += 2;\n    if (dtlen < ftlen) {\n        lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n        var llm = hMap(lct, mlcb, 0);\n        wbits(out, p, nlc - 257);\n        wbits(out, p + 5, ndc - 1);\n        wbits(out, p + 10, nlcc - 4);\n        p += 14;\n        for (var i = 0; i < nlcc; ++i)\n            wbits(out, p + 3 * i, lct[clim[i]]);\n        p += 3 * nlcc;\n        var lcts = [lclt, lcdt];\n        for (var it = 0; it < 2; ++it) {\n            var clct = lcts[it];\n            for (var i = 0; i < clct.length; ++i) {\n                var len = clct[i] & 31;\n                wbits(out, p, llm[len]), p += lct[len];\n                if (len > 15)\n                    wbits(out, p, (clct[i] >>> 5) & 127), p += clct[i] >>> 12;\n            }\n        }\n    }\n    else {\n        lm = flm, ll = flt, dm = fdm, dl = fdt;\n    }\n    for (var i = 0; i < li; ++i) {\n        if (syms[i] > 255) {\n            var len = (syms[i] >>> 18) & 31;\n            wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n            if (len > 7)\n                wbits(out, p, (syms[i] >>> 23) & 31), p += fleb[len];\n            var dst = syms[i] & 31;\n            wbits16(out, p, dm[dst]), p += dl[dst];\n            if (dst > 3)\n                wbits16(out, p, (syms[i] >>> 5) & 8191), p += fdeb[dst];\n        }\n        else {\n            wbits16(out, p, lm[syms[i]]), p += ll[syms[i]];\n        }\n    }\n    wbits16(out, p, lm[256]);\n    return p + ll[256];\n};\n// deflate options (nice << 13) | chain\nvar deo = /*#__PURE__*/ new u32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\n// empty\nvar et = /*#__PURE__*/ new u8(0);\n// compresses data into a raw DEFLATE buffer\nvar dflt = function (dat, lvl, plvl, pre, post, lst) {\n    var s = dat.length;\n    var o = new u8(pre + s + 5 * (1 + Math.floor(s / 7000)) + post);\n    // writing to this writes to the output buffer\n    var w = o.subarray(pre, o.length - post);\n    var pos = 0;\n    if (!lvl || s < 8) {\n        for (var i = 0; i <= s; i += 65535) {\n            // end\n            var e = i + 65535;\n            if (e < s) {\n                // write full block\n                pos = wfblk(w, pos, dat.subarray(i, e));\n            }\n            else {\n                // write final block\n                w[i] = lst;\n                pos = wfblk(w, pos, dat.subarray(i, s));\n            }\n        }\n    }\n    else {\n        var opt = deo[lvl - 1];\n        var n = opt >>> 13, c = opt & 8191;\n        var msk_1 = (1 << plvl) - 1;\n        //    prev 2-byte val map    curr 2-byte val map\n        var prev = new u16(32768), head = new u16(msk_1 + 1);\n        var bs1_1 = Math.ceil(plvl / 3), bs2_1 = 2 * bs1_1;\n        var hsh = function (i) { return (dat[i] ^ (dat[i + 1] << bs1_1) ^ (dat[i + 2] << bs2_1)) & msk_1; };\n        // 24576 is an arbitrary number of maximum symbols per block\n        // 424 buffer for last block\n        var syms = new u32(25000);\n        // length/literal freq   distance freq\n        var lf = new u16(288), df = new u16(32);\n        //  l/lcnt  exbits  index  l/lind  waitdx  bitpos\n        var lc_1 = 0, eb = 0, i = 0, li = 0, wi = 0, bs = 0;\n        for (; i < s; ++i) {\n            // hash value\n            var hv = hsh(i);\n            // index mod 32768\n            var imod = i & 32767;\n            // previous index with this value\n            var pimod = head[hv];\n            prev[imod] = pimod;\n            head[hv] = imod;\n            // We always should modify head and prev, but only add symbols if\n            // this data is not yet processed (\"wait\" for wait index)\n            if (wi <= i) {\n                // bytes remaining\n                var rem = s - i;\n                if ((lc_1 > 7000 || li > 24576) && rem > 423) {\n                    pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n                    li = lc_1 = eb = 0, bs = i;\n                    for (var j = 0; j < 286; ++j)\n                        lf[j] = 0;\n                    for (var j = 0; j < 30; ++j)\n                        df[j] = 0;\n                }\n                //  len    dist   chain\n                var l = 2, d = 0, ch_1 = c, dif = (imod - pimod) & 32767;\n                if (rem > 2 && hv == hsh(i - dif)) {\n                    var maxn = Math.min(n, rem) - 1;\n                    var maxd = Math.min(32767, i);\n                    // max possible length\n                    // not capped at dif because decompressors implement \"rolling\" index population\n                    var ml = Math.min(258, rem);\n                    while (dif <= maxd && --ch_1 && imod != pimod) {\n                        if (dat[i + l] == dat[i + l - dif]) {\n                            var nl = 0;\n                            for (; nl < ml && dat[i + nl] == dat[i + nl - dif]; ++nl)\n                                ;\n                            if (nl > l) {\n                                l = nl, d = dif;\n                                // break out early when we reach \"nice\" (we are satisfied enough)\n                                if (nl > maxn)\n                                    break;\n                                // now, find the rarest 2-byte sequence within this\n                                // length of literals and search for that instead.\n                                // Much faster than just using the start\n                                var mmd = Math.min(dif, nl - 2);\n                                var md = 0;\n                                for (var j = 0; j < mmd; ++j) {\n                                    var ti = (i - dif + j + 32768) & 32767;\n                                    var pti = prev[ti];\n                                    var cd = (ti - pti + 32768) & 32767;\n                                    if (cd > md)\n                                        md = cd, pimod = ti;\n                                }\n                            }\n                        }\n                        // check the previous match\n                        imod = pimod, pimod = prev[imod];\n                        dif += (imod - pimod + 32768) & 32767;\n                    }\n                }\n                // d will be nonzero only when a match was found\n                if (d) {\n                    // store both dist and len data in one Uint32\n                    // Make sure this is recognized as a len/dist with 28th bit (2^28)\n                    syms[li++] = 268435456 | (revfl[l] << 18) | revfd[d];\n                    var lin = revfl[l] & 31, din = revfd[d] & 31;\n                    eb += fleb[lin] + fdeb[din];\n                    ++lf[257 + lin];\n                    ++df[din];\n                    wi = i + l;\n                    ++lc_1;\n                }\n                else {\n                    syms[li++] = dat[i];\n                    ++lf[dat[i]];\n                }\n            }\n        }\n        pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n        // this is the easiest way to avoid needing to maintain state\n        if (!lst)\n            pos = wfblk(w, pos, et);\n    }\n    return slc(o, 0, pre + shft(pos) + post);\n};\n// CRC32 table\nvar crct = /*#__PURE__*/ (function () {\n    var t = new u32(256);\n    for (var i = 0; i < 256; ++i) {\n        var c = i, k = 9;\n        while (--k)\n            c = ((c & 1) && 0xEDB88320) ^ (c >>> 1);\n        t[i] = c;\n    }\n    return t;\n})();\n// CRC32\nvar crc = function () {\n    var c = 0xFFFFFFFF;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var cr = c;\n            for (var i = 0; i < d.length; ++i)\n                cr = crct[(cr & 255) ^ d[i]] ^ (cr >>> 8);\n            c = cr;\n        },\n        d: function () { return c ^ 0xFFFFFFFF; }\n    };\n};\n// Alder32\nvar adler = function () {\n    var a = 1, b = 0;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var n = a, m = b;\n            var l = d.length;\n            for (var i = 0; i != l;) {\n                var e = Math.min(i + 5552, l);\n                for (; i < e; ++i)\n                    n += d[i], m += n;\n                n %= 65521, m %= 65521;\n            }\n            a = n, b = m;\n        },\n        d: function () { return ((a >>> 8) << 16 | (b & 255) << 8 | (b >>> 8)) + ((a & 255) << 23) * 2; }\n    };\n};\n;\n// deflate with opts\nvar dopt = function (dat, opt, pre, post, st) {\n    return dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : (12 + opt.mem), pre, post, !st);\n};\n// Walmart object spread\nvar mrg = function (a, b) {\n    var o = {};\n    for (var k in a)\n        o[k] = a[k];\n    for (var k in b)\n        o[k] = b[k];\n    return o;\n};\n// worker clone\n// This is possibly the craziest part of the entire codebase, despite how simple it may seem.\n// The only parameter to this function is a closure that returns an array of variables outside of the function scope.\n// We're going to try to figure out the variable names used in the closure as strings because that is crucial for workerization.\n// We will return an object mapping of true variable name to value (basically, the current scope as a JS object).\n// The reason we can't just use the original variable names is minifiers mangling the toplevel scope.\n// This took me three weeks to figure out how to do.\nvar wcln = function (fn, fnStr, td) {\n    var dt = fn();\n    var st = fn.toString();\n    var ks = st.slice(st.indexOf('[') + 1, st.lastIndexOf(']')).replace(/ /g, '').split(',');\n    for (var i = 0; i < dt.length; ++i) {\n        var v = dt[i], k = ks[i];\n        if (typeof v == 'function') {\n            fnStr += ';' + k + '=';\n            var st_1 = v.toString();\n            if (v.prototype) {\n                // for global objects\n                if (st_1.indexOf('[native code]') != -1) {\n                    var spInd = st_1.indexOf(' ', 8) + 1;\n                    fnStr += st_1.slice(spInd, st_1.indexOf('(', spInd));\n                }\n                else {\n                    fnStr += st_1;\n                    for (var t in v.prototype)\n                        fnStr += ';' + k + '.prototype.' + t + '=' + v.prototype[t].toString();\n                }\n            }\n            else\n                fnStr += st_1;\n        }\n        else\n            td[k] = v;\n    }\n    return [fnStr, td];\n};\nvar ch = [];\n// clone bufs\nvar cbfs = function (v) {\n    var tl = [];\n    for (var k in v) {\n        if (v[k] instanceof u8 || v[k] instanceof u16 || v[k] instanceof u32)\n            tl.push((v[k] = new v[k].constructor(v[k])).buffer);\n    }\n    return tl;\n};\n// use a worker to execute code\nvar wrkr = function (fns, init, id, cb) {\n    var _a;\n    if (!ch[id]) {\n        var fnStr = '', td_1 = {}, m = fns.length - 1;\n        for (var i = 0; i < m; ++i)\n            _a = wcln(fns[i], fnStr, td_1), fnStr = _a[0], td_1 = _a[1];\n        ch[id] = wcln(fns[m], fnStr, td_1);\n    }\n    var td = mrg({}, ch[id][1]);\n    return wk(ch[id][0] + ';onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage=' + init.toString() + '}', id, td, cbfs(td), cb);\n};\n// base async inflate fn\nvar bInflt = function () { return [u8, u16, u32, fleb, fdeb, clim, fl, fd, flrm, fdrm, rev, hMap, max, bits, bits16, shft, slc, inflt, inflateSync, pbf, gu8]; };\nvar bDflt = function () { return [u8, u16, u32, fleb, fdeb, clim, revfl, revfd, flm, flt, fdm, fdt, rev, deo, et, hMap, wbits, wbits16, hTree, ln, lc, clen, wfblk, wblk, shft, slc, dflt, dopt, deflateSync, pbf]; };\n// gzip extra\nvar gze = function () { return [gzh, gzhl, wbytes, crc, crct]; };\n// gunzip extra\nvar guze = function () { return [gzs, gzl]; };\n// zlib extra\nvar zle = function () { return [zlh, wbytes, adler]; };\n// unzlib extra\nvar zule = function () { return [zlv]; };\n// post buf\nvar pbf = function (msg) { return postMessage(msg, [msg.buffer]); };\n// get u8\nvar gu8 = function (o) { return o && o.size && new u8(o.size); };\n// async helper\nvar cbify = function (dat, opts, fns, init, id, cb) {\n    var w = wrkr(fns, init, id, function (err, dat) {\n        w.terminate();\n        cb(err, dat);\n    });\n    if (!opts.consume)\n        dat = new u8(dat);\n    w.postMessage([dat, opts], [dat.buffer]);\n    return function () { w.terminate(); };\n};\n// auto stream\nvar astrm = function (strm) {\n    strm.ondata = function (dat, final) { return postMessage([dat, final], [dat.buffer]); };\n    return function (ev) { return strm.push(ev.data[0], ev.data[1]); };\n};\n// async stream attach\nvar astrmify = function (fns, strm, opts, init, id) {\n    var t;\n    var w = wrkr(fns, init, id, function (err, dat) {\n        if (err)\n            w.terminate(), strm.ondata.call(strm, err);\n        else {\n            if (dat[1])\n                w.terminate();\n            strm.ondata.call(strm, err, dat[0], dat[1]);\n        }\n    });\n    w.postMessage(opts);\n    strm.push = function (d, f) {\n        if (t)\n            throw 'stream finished';\n        if (!strm.ondata)\n            throw 'no stream handler';\n        w.postMessage([d, t = f], [d.buffer]);\n    };\n    strm.terminate = function () { w.terminate(); };\n};\n// read 2 bytes\nvar b2 = function (d, b) { return d[b] | (d[b + 1] << 8); };\n// read 4 bytes\nvar b4 = function (d, b) { return (d[b] | (d[b + 1] << 8) | (d[b + 2] << 16)) + (d[b + 3] << 23) * 2; };\n// write bytes\nvar wbytes = function (d, b, v) {\n    for (; v; ++b)\n        d[b] = v, v >>>= 8;\n};\n// gzip header\nvar gzh = function (c, o) {\n    var fn = o.filename;\n    c[0] = 31, c[1] = 139, c[2] = 8, c[8] = o.level < 2 ? 4 : o.level == 9 ? 2 : 0, c[9] = 3; // assume Unix\n    if (o.mtime != 0)\n        wbytes(c, 4, Math.floor(new Date(o.mtime || Date.now()) / 1000));\n    if (fn) {\n        c[3] = 8;\n        for (var i = 0; i <= fn.length; ++i)\n            c[i + 10] = fn.charCodeAt(i);\n    }\n};\n// gzip footer: -8 to -4 = CRC, -4 to -0 is length\n// gzip start\nvar gzs = function (d) {\n    if (d[0] != 31 || d[1] != 139 || d[2] != 8)\n        throw 'invalid gzip data';\n    var flg = d[3];\n    var st = 10;\n    if (flg & 4)\n        st += d[10] | (d[11] << 8) + 2;\n    for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++])\n        ;\n    return st + (flg & 2);\n};\n// gzip length\nvar gzl = function (d) {\n    var l = d.length;\n    return (d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16) + (2 * (d[l - 1] << 23));\n};\n// gzip header length\nvar gzhl = function (o) { return 10 + ((o.filename && (o.filename.length + 1)) || 0); };\n// zlib header\nvar zlh = function (c, o) {\n    var lv = o.level, fl = lv == 0 ? 0 : lv < 6 ? 1 : lv == 9 ? 3 : 2;\n    c[0] = 120, c[1] = (fl << 6) | (fl ? (32 - 2 * fl) : 1);\n};\n// zlib valid\nvar zlv = function (d) {\n    if ((d[0] & 15) != 8 || (d[0] >>> 4) > 7 || ((d[0] << 8 | d[1]) % 31))\n        throw 'invalid zlib data';\n    if (d[1] & 32)\n        throw 'invalid zlib data: preset dictionaries not supported';\n};\nfunction AsyncCmpStrm(opts, cb) {\n    if (!cb && typeof opts == 'function')\n        cb = opts, opts = {};\n    this.ondata = cb;\n    return opts;\n}\n// zlib footer: -4 to -0 is Adler32\n/**\n * Streaming DEFLATE compression\n */\nvar Deflate = /*#__PURE__*/ (function () {\n    function Deflate(opts, cb) {\n        if (!cb && typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        this.o = opts || {};\n    }\n    Deflate.prototype.p = function (c, f) {\n        this.ondata(dopt(c, this.o, 0, 0, !f), f);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Deflate.prototype.push = function (chunk, final) {\n        if (this.d)\n            throw 'stream finished';\n        if (!this.ondata)\n            throw 'no stream handler';\n        this.d = final;\n        this.p(chunk, final || false);\n    };\n    return Deflate;\n}());\nexport { Deflate };\n/**\n * Asynchronous streaming DEFLATE compression\n */\nvar AsyncDeflate = /*#__PURE__*/ (function () {\n    function AsyncDeflate(opts, cb) {\n        astrmify([\n            bDflt,\n            function () { return [astrm, Deflate]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Deflate(ev.data);\n            onmessage = astrm(strm);\n        }, 6);\n    }\n    return AsyncDeflate;\n}());\nexport { AsyncDeflate };\nexport function deflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n    ], function (ev) { return pbf(deflateSync(ev.data[0], ev.data[1])); }, 0, cb);\n}\n/**\n * Compresses data with DEFLATE without any wrapper\n * @param data The data to compress\n * @param opts The compression options\n * @returns The deflated version of the data\n */\nexport function deflateSync(data, opts) {\n    if (opts === void 0) { opts = {}; }\n    return dopt(data, opts, 0, 0);\n}\n/**\n * Streaming DEFLATE decompression\n */\nvar Inflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an inflation stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Inflate(cb) {\n        this.s = {};\n        this.p = new u8(0);\n        this.ondata = cb;\n    }\n    Inflate.prototype.e = function (c) {\n        if (this.d)\n            throw 'stream finished';\n        if (!this.ondata)\n            throw 'no stream handler';\n        var l = this.p.length;\n        var n = new u8(l + c.length);\n        n.set(this.p), n.set(c, l), this.p = n;\n    };\n    Inflate.prototype.c = function (final) {\n        this.d = this.s.i = final || false;\n        var bts = this.s.b;\n        var dt = inflt(this.p, this.o, this.s);\n        this.ondata(slc(dt, bts, this.s.b), this.d);\n        this.o = slc(dt, this.s.b - 32768), this.s.b = this.o.length;\n        this.p = slc(this.p, (this.s.p / 8) >> 0), this.s.p &= 7;\n    };\n    /**\n     * Pushes a chunk to be inflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the final chunk\n     */\n    Inflate.prototype.push = function (chunk, final) {\n        this.e(chunk), this.c(final);\n    };\n    return Inflate;\n}());\nexport { Inflate };\n/**\n * Asynchronous streaming DEFLATE decompression\n */\nvar AsyncInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous inflation stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncInflate(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            function () { return [astrm, Inflate]; }\n        ], this, 0, function () {\n            var strm = new Inflate();\n            onmessage = astrm(strm);\n        }, 7);\n    }\n    return AsyncInflate;\n}());\nexport { AsyncInflate };\nexport function inflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt\n    ], function (ev) { return pbf(inflateSync(ev.data[0], gu8(ev.data[1]))); }, 1, cb);\n}\n/**\n * Expands DEFLATE data with no wrapper\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function inflateSync(data, out) {\n    return inflt(data, out);\n}\n// before you yell at me for not just using extends, my reason is that TS inheritance is hard to workerize.\n/**\n * Streaming GZIP compression\n */\nvar Gzip = /*#__PURE__*/ (function () {\n    function Gzip(opts, cb) {\n        this.c = crc();\n        this.l = 0;\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gzip.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Gzip.prototype.p = function (c, f) {\n        this.c.p(c);\n        this.l += c.length;\n        var raw = dopt(c, this.o, this.v && gzhl(this.o), f && 8, !f);\n        if (this.v)\n            gzh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 8, this.c.d()), wbytes(raw, raw.length - 4, this.l);\n        this.ondata(raw, f);\n    };\n    return Gzip;\n}());\nexport { Gzip };\n/**\n * Asynchronous streaming GZIP compression\n */\nvar AsyncGzip = /*#__PURE__*/ (function () {\n    function AsyncGzip(opts, cb) {\n        astrmify([\n            bDflt,\n            gze,\n            function () { return [astrm, Deflate, Gzip]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Gzip(ev.data);\n            onmessage = astrm(strm);\n        }, 8);\n    }\n    return AsyncGzip;\n}());\nexport { AsyncGzip };\nexport function gzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n        gze,\n        function () { return [gzipSync]; }\n    ], function (ev) { return pbf(gzipSync(ev.data[0], ev.data[1])); }, 2, cb);\n}\n/**\n * Compresses data with GZIP\n * @param data The data to compress\n * @param opts The compression options\n * @returns The gzipped version of the data\n */\nexport function gzipSync(data, opts) {\n    if (opts === void 0) { opts = {}; }\n    var c = crc(), l = data.length;\n    c.p(data);\n    var d = dopt(data, opts, gzhl(opts), 8), s = d.length;\n    return gzh(d, opts), wbytes(d, s - 8, c.d()), wbytes(d, s - 4, l), d;\n}\n/**\n * Streaming GZIP decompression\n */\nvar Gunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a GUNZIP stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Gunzip(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be GUNZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gunzip.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            var s = gzs(this.p);\n            if (s >= this.p.length && !final)\n                return;\n            this.p = this.p.subarray(s), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 8)\n                throw 'invalid gzip stream';\n            this.p = this.p.subarray(0, -8);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Gunzip;\n}());\nexport { Gunzip };\n/**\n * Asynchronous streaming GZIP decompression\n */\nvar AsyncGunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous GUNZIP stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncGunzip(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            guze,\n            function () { return [astrm, Inflate, Gunzip]; }\n        ], this, 0, function () {\n            var strm = new Gunzip();\n            onmessage = astrm(strm);\n        }, 9);\n    }\n    return AsyncGunzip;\n}());\nexport { AsyncGunzip };\nexport function gunzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt,\n        guze,\n        function () { return [gunzipSync]; }\n    ], function (ev) { return pbf(gunzipSync(ev.data[0])); }, 3, cb);\n}\n/**\n * Expands GZIP data\n * @param data The data to decompress\n * @param out Where to write the data. GZIP already encodes the output size, so providing this doesn't save memory.\n * @returns The decompressed version of the data\n */\nexport function gunzipSync(data, out) {\n    return inflt(data.subarray(gzs(data), -8), out || new u8(gzl(data)));\n}\n/**\n * Streaming Zlib compression\n */\nvar Zlib = /*#__PURE__*/ (function () {\n    function Zlib(opts, cb) {\n        this.c = adler();\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be zlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Zlib.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Zlib.prototype.p = function (c, f) {\n        this.c.p(c);\n        var raw = dopt(c, this.o, this.v && 2, f && 4, !f);\n        if (this.v)\n            zlh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 4, this.c.d());\n        this.ondata(raw, f);\n    };\n    return Zlib;\n}());\nexport { Zlib };\n/**\n * Asynchronous streaming Zlib compression\n */\nvar AsyncZlib = /*#__PURE__*/ (function () {\n    function AsyncZlib(opts, cb) {\n        astrmify([\n            bDflt,\n            zle,\n            function () { return [astrm, Deflate, Zlib]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Zlib(ev.data);\n            onmessage = astrm(strm);\n        }, 10);\n    }\n    return AsyncZlib;\n}());\nexport { AsyncZlib };\nexport function zlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n        zle,\n        function () { return [zlibSync]; }\n    ], function (ev) { return pbf(zlibSync(ev.data[0], ev.data[1])); }, 4, cb);\n}\n/**\n * Compress data with Zlib\n * @param data The data to compress\n * @param opts The compression options\n * @returns The zlib-compressed version of the data\n */\nexport function zlibSync(data, opts) {\n    if (opts === void 0) { opts = {}; }\n    var a = adler();\n    a.p(data);\n    var d = dopt(data, opts, 2, 4);\n    return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\n/**\n * Streaming Zlib decompression\n */\nvar Unzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates a Zlib decompression stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Unzlib(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be unzlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzlib.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            if (this.p.length < 2 && !final)\n                return;\n            this.p = this.p.subarray(2), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 4)\n                throw 'invalid zlib stream';\n            this.p = this.p.subarray(0, -4);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Unzlib;\n}());\nexport { Unzlib };\n/**\n * Asynchronous streaming Zlib decompression\n */\nvar AsyncUnzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous Zlib decompression stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncUnzlib(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            zule,\n            function () { return [astrm, Inflate, Unzlib]; }\n        ], this, 0, function () {\n            var strm = new Unzlib();\n            onmessage = astrm(strm);\n        }, 11);\n    }\n    return AsyncUnzlib;\n}());\nexport { AsyncUnzlib };\nexport function unzlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt,\n        zule,\n        function () { return [unzlibSync]; }\n    ], function (ev) { return pbf(unzlibSync(ev.data[0], gu8(ev.data[1]))); }, 5, cb);\n}\n/**\n * Expands Zlib data\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function unzlibSync(data, out) {\n    return inflt((zlv(data), data.subarray(2, -4)), out);\n}\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzip as compress, AsyncGzip as AsyncCompress };\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzipSync as compressSync, Gzip as Compress };\n/**\n * Streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar Decompress = /*#__PURE__*/ (function () {\n    /**\n     * Creates a decompression stream\n     * @param cb The callback to call whenever data is decompressed\n     */\n    function Decompress(cb) {\n        this.G = Gunzip;\n        this.I = Inflate;\n        this.Z = Unzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Decompress.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no stream handler';\n        if (!this.s) {\n            if (this.p && this.p.length) {\n                var n = new u8(this.p.length + chunk.length);\n                n.set(this.p), n.set(chunk, this.p.length);\n            }\n            else\n                this.p = chunk;\n            if (this.p.length > 2) {\n                var _this_1 = this;\n                var cb = function () { _this_1.ondata.apply(_this_1, arguments); };\n                this.s = (this.p[0] == 31 && this.p[1] == 139 && this.p[2] == 8)\n                    ? new this.G(cb)\n                    : ((this.p[0] & 15) != 8 || (this.p[0] >> 4) > 7 || ((this.p[0] << 8 | this.p[1]) % 31))\n                        ? new this.I(cb)\n                        : new this.Z(cb);\n                this.s.push(this.p, final);\n                this.p = null;\n            }\n        }\n        else\n            this.s.push(chunk, final);\n    };\n    return Decompress;\n}());\nexport { Decompress };\n/**\n * Asynchronous streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar AsyncDecompress = /*#__PURE__*/ (function () {\n    /**\n   * Creates an asynchronous decompression stream\n   * @param cb The callback to call whenever data is decompressed\n   */\n    function AsyncDecompress(cb) {\n        this.G = AsyncGunzip;\n        this.I = AsyncInflate;\n        this.Z = AsyncUnzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncDecompress.prototype.push = function (chunk, final) {\n        Decompress.prototype.push.call(this, chunk, final);\n    };\n    return AsyncDecompress;\n}());\nexport { AsyncDecompress };\nexport function decompress(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzip(data, opts, cb)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflate(data, opts, cb)\n            : unzlib(data, opts, cb);\n}\n/**\n * Expands compressed GZIP, Zlib, or raw DEFLATE data, automatically detecting the format\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function decompressSync(data, out) {\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzipSync(data, out)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflateSync(data, out)\n            : unzlibSync(data, out);\n}\n// flatten a directory structure\nvar fltn = function (d, p, t, o) {\n    for (var k in d) {\n        var val = d[k], n = p + k;\n        if (val instanceof u8)\n            t[n] = [val, o];\n        else if (Array.isArray(val))\n            t[n] = [val[0], mrg(o, val[1])];\n        else\n            fltn(val, n + '/', t, o);\n    }\n};\n/**\n * Converts a string into a Uint8Array for use with compression/decompression methods\n * @param str The string to encode\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless decoding a binary string.\n * @returns The string encoded in UTF-8/Latin-1 binary\n */\nexport function strToU8(str, latin1) {\n    var l = str.length;\n    if (!latin1 && typeof TextEncoder != 'undefined')\n        return new TextEncoder().encode(str);\n    var ar = new u8(str.length + (str.length >>> 1));\n    var ai = 0;\n    var w = function (v) { ar[ai++] = v; };\n    for (var i = 0; i < l; ++i) {\n        if (ai + 5 > ar.length) {\n            var n = new u8(ai + 8 + ((l - i) << 1));\n            n.set(ar);\n            ar = n;\n        }\n        var c = str.charCodeAt(i);\n        if (c < 128 || latin1)\n            w(c);\n        else if (c < 2048)\n            w(192 | (c >>> 6)), w(128 | (c & 63));\n        else if (c > 55295 && c < 57344)\n            c = 65536 + (c & 1023 << 10) | (str.charCodeAt(++i) & 1023),\n                w(240 | (c >>> 18)), w(128 | ((c >>> 12) & 63)), w(128 | ((c >>> 6) & 63)), w(128 | (c & 63));\n        else\n            w(224 | (c >>> 12)), w(128 | ((c >>> 6) & 63)), w(128 | (c & 63));\n    }\n    return slc(ar, 0, ai);\n}\n/**\n * Converts a Uint8Array to a string\n * @param dat The data to decode to string\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless encoding to binary string.\n * @returns The original UTF-8/Latin-1 string\n */\nexport function strFromU8(dat, latin1) {\n    var r = '';\n    if (!latin1 && typeof TextDecoder != 'undefined')\n        return new TextDecoder().decode(dat);\n    for (var i = 0; i < dat.length;) {\n        var c = dat[i++];\n        if (c < 128 || latin1)\n            r += String.fromCharCode(c);\n        else if (c < 224)\n            r += String.fromCharCode((c & 31) << 6 | (dat[i++] & 63));\n        else if (c < 240)\n            r += String.fromCharCode((c & 15) << 12 | (dat[i++] & 63) << 6 | (dat[i++] & 63));\n        else\n            c = ((c & 15) << 18 | (dat[i++] & 63) << 12 | (dat[i++] & 63) << 6 | (dat[i++] & 63)) - 65536,\n                r += String.fromCharCode(55296 | (c >> 10), 56320 | (c & 1023));\n    }\n    return r;\n}\n;\n// skip local zip header\nvar slzh = function (d, b) { return b + 30 + b2(d, b + 26) + b2(d, b + 28); };\n// read zip header\nvar zh = function (d, b, z) {\n    var fnl = b2(d, b + 28), fn = strFromU8(d.subarray(b + 46, b + 46 + fnl), !(b2(d, b + 8) & 2048)), es = b + 46 + fnl;\n    var _a = z ? z64e(d, es) : [b4(d, b + 20), b4(d, b + 24), b4(d, b + 42)], sc = _a[0], su = _a[1], off = _a[2];\n    return [b2(d, b + 10), sc, su, fn, es + b2(d, b + 30) + b2(d, b + 32), off];\n};\n// read zip64 extra field\nvar z64e = function (d, b) {\n    for (; b2(d, b) != 1; b += 4 + b2(d, b + 2))\n        ;\n    return [b4(d, b + 12), b4(d, b + 4), b4(d, b + 20)];\n};\n// write zip header\nvar wzh = function (d, b, c, cmp, su, fn, u, o, ce, t) {\n    var fl = fn.length, l = cmp.length;\n    wbytes(d, b, ce != null ? 0x2014B50 : 0x4034B50), b += 4;\n    if (ce != null)\n        d[b] = 20, b += 2;\n    d[b] = 20, b += 2; // spec compliance? what's that?\n    d[b++] = (t == 8 && (o.level == 1 ? 6 : o.level < 6 ? 4 : o.level == 9 ? 2 : 0)), d[b++] = u && 8;\n    d[b] = t, b += 2;\n    var dt = new Date(o.mtime || Date.now()), y = dt.getFullYear() - 1980;\n    if (y < 0 || y > 119)\n        throw 'date not in range 1980-2099';\n    wbytes(d, b, ((y << 24) * 2) | ((dt.getMonth() + 1) << 21) | (dt.getDate() << 16) | (dt.getHours() << 11) | (dt.getMinutes() << 5) | (dt.getSeconds() >>> 1));\n    b += 4;\n    wbytes(d, b, c);\n    wbytes(d, b + 4, l);\n    wbytes(d, b + 8, su);\n    wbytes(d, b + 12, fl), b += 16; // skip extra field, comment\n    if (ce != null)\n        wbytes(d, b += 10, ce), b += 4;\n    d.set(fn, b);\n    b += fl;\n    if (ce == null)\n        d.set(cmp, b);\n};\n// write zip footer (end of central directory)\nvar wzf = function (o, b, c, d, e) {\n    wbytes(o, b, 0x6054B50); // skip disk\n    wbytes(o, b + 8, c);\n    wbytes(o, b + 10, c);\n    wbytes(o, b + 12, d);\n    wbytes(o, b + 16, e);\n};\nexport function zip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    var r = {};\n    fltn(data, '', r, opts);\n    var k = Object.keys(r);\n    var lft = k.length, o = 0, tot = 0;\n    var slft = lft, files = new Array(lft);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var cbf = function () {\n        var out = new u8(tot + 22), oe = o, cdl = tot - o;\n        tot = 0;\n        for (var i = 0; i < slft; ++i) {\n            var f = files[i];\n            try {\n                wzh(out, tot, f.c, f.d, f.m, f.n, f.u, f.p, null, f.t);\n                wzh(out, o, f.c, f.d, f.m, f.n, f.u, f.p, tot, f.t), o += 46 + f.n.length, tot += 30 + f.n.length + f.d.length;\n            }\n            catch (e) {\n                return cb(e, null);\n            }\n        }\n        wzf(out, o, files.length, cdl, oe);\n        cb(null, out);\n    };\n    if (!lft)\n        cbf();\n    var _loop_1 = function (i) {\n        var fn = k[i];\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var c = crc(), m = file.length;\n        c.p(file);\n        var n = strToU8(fn), s = n.length;\n        var t = p.level == 0 ? 0 : 8;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cb(e, null);\n            }\n            else {\n                var l = d.length;\n                files[i] = {\n                    t: t,\n                    d: d,\n                    m: m,\n                    c: c.d(),\n                    u: fn.length != l,\n                    n: n,\n                    p: p\n                };\n                o += 30 + s + l;\n                tot += 76 + 2 * s + l;\n                if (!--lft)\n                    cbf();\n            }\n        };\n        if (n.length > 65535)\n            cbl('filename too long', null);\n        if (!t)\n            cbl(null, file);\n        else if (m < 160000) {\n            try {\n                cbl(null, deflateSync(file, p));\n            }\n            catch (e) {\n                cbl(e, null);\n            }\n        }\n        else\n            term.push(deflate(file, p, cbl));\n    };\n    // Cannot use lft because it can decrease\n    for (var i = 0; i < slft; ++i) {\n        _loop_1(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously creates a ZIP file. Prefer using `zip` for better performance\n * with more than one file.\n * @param data The directory structure for the ZIP archive\n * @param opts The main options, merged with per-file options\n * @returns The generated ZIP archive\n */\nexport function zipSync(data, opts) {\n    if (opts === void 0) { opts = {}; }\n    var r = {};\n    var files = [];\n    fltn(data, '', r, opts);\n    var o = 0;\n    var tot = 0;\n    for (var fn in r) {\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var t = p.level == 0 ? 0 : 8;\n        var n = strToU8(fn), s = n.length;\n        if (n.length > 65535)\n            throw 'filename too long';\n        var d = t ? deflateSync(file, p) : file, l = d.length;\n        var c = crc();\n        c.p(file);\n        files.push({\n            t: t,\n            d: d,\n            m: file.length,\n            c: c.d(),\n            u: fn.length != s,\n            n: n,\n            o: o,\n            p: p\n        });\n        o += 30 + s + l;\n        tot += 76 + 2 * s + l;\n    }\n    var out = new u8(tot + 22), oe = o, cdl = tot - o;\n    for (var i = 0; i < files.length; ++i) {\n        var f = files[i];\n        wzh(out, f.o, f.c, f.d, f.m, f.n, f.u, f.p, null, f.t);\n        wzh(out, o, f.c, f.d, f.m, f.n, f.u, f.p, f.o, f.t), o += 46 + f.n.length;\n    }\n    wzf(out, o, files.length, cdl, oe);\n    return out;\n}\n/**\n * Asynchronously decompresses a ZIP archive\n * @param data The raw compressed ZIP file\n * @param cb The callback to call with the decompressed files\n * @returns A function that can be used to immediately terminate the unzipping\n */\nexport function unzip(data, cb) {\n    if (typeof cb != 'function')\n        throw 'no callback';\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558) {\n            cb('invalid zip file', null);\n            return;\n        }\n    }\n    ;\n    var lft = b2(data, e + 8);\n    if (!lft)\n        cb(null, {});\n    var c = lft;\n    var o = b4(data, e + 16);\n    var z = o == 4294967295;\n    if (z) {\n        e = b4(data, e - 12);\n        if (b4(data, e) != 0x6064B50)\n            throw 'invalid zip file';\n        c = lft = b4(data, e + 32);\n        o = b4(data, e + 48);\n    }\n    var _loop_2 = function (i) {\n        var _a = zh(data, o, z), c_1 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cb(e, null);\n            }\n            else {\n                files[fn] = d;\n                if (!--lft)\n                    cb(null, files);\n            }\n        };\n        if (!c_1)\n            cbl(null, slc(data, b, b + sc));\n        else if (c_1 == 8) {\n            var infl = data.subarray(b, b + sc);\n            if (sc < 320000) {\n                try {\n                    cbl(null, inflateSync(infl, new u8(su)));\n                }\n                catch (e) {\n                    cbl(e, null);\n                }\n            }\n            else\n                term.push(inflate(infl, { size: su }, cbl));\n        }\n        else\n            cbl('unknown compression type ' + c_1, null);\n    };\n    for (var i = 0; i < c; ++i) {\n        _loop_2(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously decompresses a ZIP archive. Prefer using `unzip` for better\n * performance with more than one file.\n * @param data The raw compressed ZIP file\n * @returns The decompressed files\n */\nexport function unzipSync(data) {\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558)\n            throw 'invalid zip file';\n    }\n    ;\n    var c = b2(data, e + 8);\n    if (!c)\n        return {};\n    var o = b4(data, e + 16);\n    var z = o == 4294967295;\n    if (z) {\n        e = b4(data, e - 12);\n        if (b4(data, e) != 0x6064B50)\n            throw 'invalid zip file';\n        c = b4(data, e + 32);\n        o = b4(data, e + 48);\n    }\n    for (var i = 0; i < c; ++i) {\n        var _a = zh(data, o, z), c_2 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        if (!c_2)\n            files[fn] = slc(data, b, b + sc);\n        else if (c_2 == 8)\n            files[fn] = inflateSync(data.subarray(b, b + sc), new u8(su));\n        else\n            throw 'unknown compression type ' + c_2;\n    }\n    return files;\n}\n", "import type { MaskInputOptions, SlimDOMOptions } from 'rrweb-snapshot'\nimport { PostHog } from './posthog-core'\nimport { CaptureMetrics } from './capture-metrics'\nimport { RetryQueue } from './retry-queue'\n\nexport type Property = any\nexport type Properties = Record<string, Property>\nexport interface CaptureResult {\n    event: string\n    properties: Properties\n    $set?: Properties\n    $set_once?: Properties\n    timestamp?: Date\n}\nexport type CaptureCallback = (response: any, data: any) => void\n\nexport type AutocaptureCompatibleElement = 'a' | 'button' | 'form' | 'input' | 'select' | 'textarea' | 'label'\nexport type DomAutocaptureEvents = 'click' | 'change' | 'submit'\n\n/**\n * If an array is passed for an allowlist, autocapture events will only be sent for elements matching\n * at least one of the elements in the array. Multiple allowlists can be used\n */\nexport interface AutocaptureConfig {\n    /**\n     * List of URLs to allow autocapture on, can be strings to match\n     * or regexes e.g. ['https://example.com', 'test.com/.*']\n     */\n    url_allowlist?: (string | RegExp)[]\n\n    /**\n     * List of DOM events to allow autocapture on  e.g. ['click', 'change', 'submit']\n     */\n    dom_event_allowlist?: DomAutocaptureEvents[]\n\n    /**\n     * List of DOM elements to allow autocapture on\n     * e.g. ['a', 'button', 'form', 'input', 'select', 'textarea', 'label']\n     */\n    element_allowlist?: AutocaptureCompatibleElement[]\n\n    /**\n     * List of CSS selectors to allow autocapture on\n     * e.g. ['[ph-capture]']\n     */\n    css_selector_allowlist?: string[]\n}\n\nexport interface PostHogConfig {\n    api_host: string\n    api_method: string\n    api_transport: string\n    ui_host: string | null\n    token: string\n    autocapture: boolean | AutocaptureConfig\n    rageclick: boolean\n    cross_subdomain_cookie: boolean\n    persistence: 'localStorage' | 'cookie' | 'memory' | 'localStorage+cookie' | 'sessionStorage'\n    persistence_name: string\n    cookie_name: string\n    loaded: (posthog_instance: PostHog) => void\n    store_google: boolean\n    custom_campaign_params: string[]\n    save_referrer: boolean\n    test: boolean\n    verbose: boolean\n    capture_pageview: boolean\n    capture_pageleave: boolean\n    debug: boolean\n    cookie_expiration: number\n    upgrade: boolean\n    disable_session_recording: boolean\n    disable_persistence: boolean\n    disable_cookie: boolean\n    enable_recording_console_log?: boolean\n    secure_cookie: boolean\n    ip: boolean\n    opt_out_capturing_by_default: boolean\n    opt_out_persistence_by_default: boolean\n    opt_out_capturing_persistence_type: 'localStorage' | 'cookie'\n    opt_out_capturing_cookie_prefix: string | null\n    opt_in_site_apps: boolean\n    respect_dnt: boolean\n    property_blacklist: string[]\n    xhr_headers: { [header_name: string]: string }\n    on_xhr_error: (failedRequest: XMLHttpRequest) => void\n    inapp_protocol: string\n    inapp_link_new_window: boolean\n    request_batching: boolean\n    sanitize_properties: ((properties: Properties, event_name: string) => Properties) | null\n    properties_string_max_length: number\n    session_recording: SessionRecordingOptions\n    mask_all_element_attributes: boolean\n    mask_all_text: boolean\n    advanced_disable_decide: boolean\n    advanced_disable_toolbar_metrics: boolean\n    get_device_id: (uuid: string) => string\n    name: string\n    callback_fn: string\n    _onCapture: (eventName: string, eventData: CaptureResult) => void\n    _capture_metrics: boolean\n    capture_performance?: boolean\n    // Should only be used for testing. Could negatively impact performance.\n    disable_compression: boolean\n    bootstrap: {\n        distinctID?: string\n        isIdentifiedID?: boolean\n        featureFlags?: Record<string, boolean | string>\n        featureFlagPayloads?: Record<string, JsonType>\n    }\n    segment?: any\n}\n\nexport interface OptInOutCapturingOptions {\n    capture: (event: string, properties: Properties, options: CaptureOptions) => void\n    capture_event_name: string\n    capture_properties: Properties\n    enable_persistence: boolean\n    clear_persistence: boolean\n    persistence_type: 'cookie' | 'localStorage' | 'localStorage+cookie'\n    cookie_prefix: string\n    cookie_expiration: number\n    cross_subdomain_cookie: boolean\n    secure_cookie: boolean\n}\n\nexport interface isFeatureEnabledOptions {\n    send_event: boolean\n}\n\nexport interface SessionRecordingOptions {\n    blockClass?: string | RegExp\n    blockSelector?: string | null\n    ignoreClass?: string\n    maskTextClass?: string | RegExp\n    maskTextSelector?: string | null\n    maskAllInputs?: boolean\n    maskInputOptions?: MaskInputOptions\n    maskInputFn?: ((text: string, element?: HTMLElement) => string) | null\n    /** Modify the network request before it is captured. Returning null stops it being captured */\n    maskNetworkRequestFn?: ((url: NetworkRequest) => NetworkRequest | null | undefined) | null\n    slimDOMOptions?: SlimDOMOptions | 'all' | true\n    collectFonts?: boolean\n    inlineStylesheet?: boolean\n    recorderVersion?: 'v1' | 'v2'\n    recordCrossOriginIframes?: boolean\n}\n\nexport enum Compression {\n    GZipJS = 'gzip-js',\n    Base64 = 'base64',\n}\n\nexport interface XHROptions {\n    transport?: 'XHR' | 'sendBeacon'\n    method?: 'POST' | 'GET'\n    urlQueryArgs?: { compression: Compression }\n    verbose?: boolean\n    blob?: boolean\n    sendBeacon?: boolean\n}\n\nexport interface CaptureOptions extends XHROptions {\n    $set?: Properties /** used with $identify */\n    $set_once?: Properties /** used with $identify */\n    _batchKey?: string /** key of queue, e.g. 'sessionRecording' vs 'event' */\n    _metrics?: Properties\n    _noTruncate?: boolean /** if set, overrides and disables config.properties_string_max_length */\n    endpoint?: string /** defaults to '/e/' */\n    send_instantly?: boolean /** if set skips the batched queue */\n    timestamp?: Date\n}\n\nexport interface RetryQueueElement {\n    retryAt: Date\n    requestData: QueuedRequestData\n}\nexport interface QueuedRequestData {\n    url: string\n    data: Properties\n    options: CaptureOptions\n    headers?: Properties\n    callback?: RequestCallback\n    retriesPerformedSoFar?: number\n}\n\nexport interface XHRParams extends QueuedRequestData {\n    captureMetrics: CaptureMetrics\n    retryQueue: RetryQueue\n    onXHRError: (req: XMLHttpRequest) => void\n    timeout?: number\n}\n\nexport interface DecideResponse {\n    status: number\n    supportedCompression: Compression[]\n    config: {\n        enable_collect_everything: boolean\n    }\n    custom_properties: AutoCaptureCustomProperty[] // TODO: delete, not sent\n    featureFlags: Record<string, string | boolean>\n    featureFlagPayloads: Record<string, JsonType>\n    errorsWhileComputingFlags: boolean\n    autocapture_opt_out?: boolean\n    capturePerformance?: boolean\n    // this is currently in development and may have breaking changes without a major version bump\n    autocaptureExceptions?: boolean\n    sessionRecording?: {\n        endpoint?: string\n        consoleLogRecordingEnabled?: boolean\n        recorderVersion?: 'v1' | 'v2'\n    }\n    toolbarParams: ToolbarParams\n    editorParams?: ToolbarParams /** @deprecated, renamed to toolbarParams, still present on older API responses */\n    toolbarVersion: 'toolbar' /** @deprecated, moved to toolbarParams */\n    isAuthenticated: boolean\n    siteApps: { id: number; url: string }[]\n}\n\nexport type FeatureFlagsCallback = (flags: string[], variants: Record<string, string | boolean>) => void\n\n// TODO: delete custom_properties after changeless typescript refactor\nexport interface AutoCaptureCustomProperty {\n    name: string\n    css_selector: string\n    event_selectors: string[]\n}\n\nexport interface CompressionData {\n    data: string\n    compression?: Compression\n}\n\nexport interface GDPROptions {\n    capture?: (\n        event: string,\n        properties: Properties,\n        options: CaptureOptions\n    ) => void /** function used for capturing a PostHog event to record the opt-in action */\n    captureEventName?: string /** event name to be used for capturing the opt-in action */\n    captureProperties?: Properties /** set of properties to be captured along with the opt-in action */\n    /** persistence mechanism used */\n    persistenceType?: 'cookie' | 'localStorage' | 'localStorage+cookie'\n    persistencePrefix?: string /** [__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name */\n    cookieExpiration?: number /** number of days until the opt-in cookie expires */\n    crossSubdomainCookie?: boolean /** whether the opt-in cookie is set as cross-subdomain or not */\n    secureCookie?: boolean /** whether the opt-in cookie is set as secure or not */\n    respectDnt?: boolean\n    window?: Window\n}\n\nexport type RequestCallback = (response: Record<string, any>, data?: Properties) => void\n\nexport interface PersistentStore {\n    is_supported: () => boolean\n    error: (error: any) => void\n    parse: (name: string) => any\n    get: (name: string) => any\n    set: (name: string, value: any, expire_days?: number | null, cross_subdomain?: boolean, secure?: boolean) => void\n    remove: (name: string, cross_subdomain?: boolean) => void\n}\n\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport type Breaker = {}\nexport type EventHandler = (event: Event) => boolean | void\n\nexport type ToolbarUserIntent = 'add-action' | 'edit-action'\nexport type ToolbarSource = 'url' | 'localstorage'\nexport type ToolbarVersion = 'toolbar'\n\n/* sync with posthog */\nexport interface ToolbarParams {\n    token?: string /** public posthog-js token */\n    temporaryToken?: string /** private temporary user token */\n    actionId?: number\n    userIntent?: ToolbarUserIntent\n    source?: ToolbarSource\n    toolbarVersion?: ToolbarVersion\n    instrument?: boolean\n    distinctId?: string\n    userEmail?: string\n    dataAttributes?: string[]\n    featureFlags?: Record<string, string | boolean>\n}\n\nexport interface PostData {\n    buffer?: BlobPart\n    compression?: Compression\n    data?: string\n}\n\nexport interface JSC {\n    (): void\n    [key: string]: (response: any) => void\n}\n\nexport type SnippetArrayItem = [method: string, ...args: any[]]\n\nexport type JsonType = string | number | boolean | null | { [key: string]: JsonType } | Array<JsonType>\n\n/** A feature that isn't publicly available yet.*/\nexport interface EarlyAccessFeature {\n    // Sync this with the backend's EarlyAccessFeatureSerializer!\n    name: string\n    description: string\n    stage: 'concept' | 'alpha' | 'beta'\n    documentationUrl: string | null\n    flagKey: string | null\n}\n\nexport type EarlyAccessFeatureCallback = (earlyAccessFeatures: EarlyAccessFeature[]) => void\n\nexport interface EarlyAccessFeatureResponse {\n    earlyAccessFeatures: EarlyAccessFeature[]\n}\n\nexport type NetworkRequest = {\n    url: string\n}\n", "import { _each, _HTTPBuildQuery, logger } from './utils'\nimport Config from './config'\nimport { PostData, XHROptions, XHRParams } from './types'\n\nexport const addParamsToURL = (\n    url: string,\n    urlQueryArgs: Record<string, any> | undefined,\n    parameterOptions: { ip?: boolean }\n): string => {\n    const args = urlQueryArgs || {}\n    args['ip'] = parameterOptions['ip'] ? 1 : 0\n    args['_'] = new Date().getTime().toString()\n    args['ver'] = Config.LIB_VERSION\n\n    const halves = url.split('?')\n    if (halves.length > 1) {\n        const params = halves[1].split('&')\n        for (const p of params) {\n            const key = p.split('=')[0]\n            if (args[key]) {\n                delete args[key]\n            }\n        }\n    }\n\n    const argSeparator = url.indexOf('?') > -1 ? '&' : '?'\n    return url + argSeparator + _HTTPBuildQuery(args)\n}\n\nexport const encodePostData = (data: PostData | Uint8Array, options: Partial<XHROptions>): string | BlobPart | null => {\n    if (options.blob && data.buffer) {\n        return new Blob([data.buffer], { type: 'text/plain' })\n    }\n\n    if (options.sendBeacon || options.blob) {\n        const body = encodePostData(data, { method: 'POST' }) as BlobPart\n        return new Blob([body], { type: 'application/x-www-form-urlencoded' })\n    }\n\n    if (options.method !== 'POST') {\n        return null\n    }\n\n    let body_data\n    const isUint8Array = (d: unknown): d is Uint8Array => Object.prototype.toString.call(d) === '[object Uint8Array]'\n    if (Array.isArray(data) || isUint8Array(data)) {\n        // TODO: eh? passing an Array here?\n        body_data = 'data=' + encodeURIComponent(data as any)\n    } else {\n        body_data = 'data=' + encodeURIComponent(data.data as string)\n    }\n\n    if ('compression' in data && data.compression) {\n        body_data += '&compression=' + data.compression\n    }\n\n    return body_data\n}\n\nexport const xhr = ({\n    url,\n    data,\n    headers,\n    options,\n    captureMetrics,\n    callback,\n    retriesPerformedSoFar,\n    retryQueue,\n    onXHRError,\n    timeout = 10000,\n}: XHRParams) => {\n    const req = new XMLHttpRequest()\n    req.open(options.method || 'GET', url, true)\n\n    const body = encodePostData(data, options)\n\n    captureMetrics.incr('_send_request')\n    captureMetrics.incr('_send_request_inflight')\n\n    _each(headers, function (headerValue, headerName) {\n        req.setRequestHeader(headerName, headerValue)\n    })\n\n    if (options.method === 'POST' && !options.blob) {\n        req.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded')\n    }\n\n    req.timeout = timeout\n    // send the ph_optout cookie\n    // withCredentials cannot be modified until after calling .open on Android and Mobile Safari\n    req.withCredentials = true\n    req.onreadystatechange = () => {\n        if (req.readyState === 4) {\n            captureMetrics.incr(`xhr-response`)\n            captureMetrics.incr(`xhr-response-${req.status}`)\n            captureMetrics.decr('_send_request_inflight')\n\n            // XMLHttpRequest.DONE == 4, except in safari 4\n            if (req.status === 200) {\n                if (callback) {\n                    let response\n                    try {\n                        response = JSON.parse(req.responseText)\n                    } catch (e) {\n                        logger.error(e)\n                        return\n                    }\n                    callback(response)\n                }\n            } else {\n                if (typeof onXHRError === 'function') {\n                    onXHRError(req)\n                }\n\n                // don't retry certain errors\n                if ([401, 403, 404, 500].indexOf(req.status) < 0) {\n                    retryQueue.enqueue({\n                        url,\n                        data,\n                        options,\n                        headers,\n                        retriesPerformedSoFar: (retriesPerformedSoFar || 0) + 1,\n                        callback,\n                    })\n                }\n\n                if (callback) {\n                    callback({ status: 0 })\n                }\n            }\n        }\n    }\n    req.send(body)\n}\n", "import { RequestQueueScaffold } from './base-request-queue'\nimport { encodePostData, xhr } from './send-request'\nimport { CaptureMetrics } from './capture-metrics'\nimport { QueuedRequestData, RetryQueueElement } from './types'\nimport Config from './config'\n\nexport class RetryQueue extends RequestQueueScaffold {\n    captureMetrics: CaptureMetrics\n    queue: RetryQueueElement[]\n    isPolling: boolean\n    areWeOnline: boolean\n    onXHRError: (failedRequest: XMLHttpRequest) => void\n\n    constructor(captureMetrics: CaptureMetrics, onXHRError: (failedRequest: XMLHttpRequest) => void) {\n        super()\n        this.captureMetrics = captureMetrics\n        this.isPolling = false\n        this.queue = []\n        this.areWeOnline = true\n        this.onXHRError = onXHRError\n\n        if (typeof window !== 'undefined' && 'onLine' in window.navigator) {\n            this.areWeOnline = window.navigator.onLine\n            window.addEventListener('online', () => {\n                this._handleWeAreNowOnline()\n            })\n            window.addEventListener('offline', () => {\n                this.areWeOnline = false\n            })\n        }\n    }\n\n    enqueue(requestData: QueuedRequestData): void {\n        const retriesPerformedSoFar = requestData.retriesPerformedSoFar || 0\n        if (retriesPerformedSoFar >= 10) {\n            return\n        }\n        const msToNextRetry = 3000 * 2 ** retriesPerformedSoFar\n        const retryAt = new Date(Date.now() + msToNextRetry)\n        console.warn(`Enqueued failed request for retry in ${msToNextRetry}`)\n        this.queue.push({ retryAt, requestData })\n        if (!this.isPolling) {\n            this.isPolling = true\n            this.poll()\n        }\n    }\n\n    poll(): void {\n        this._poller && clearTimeout(this._poller)\n        this._poller = setTimeout(() => {\n            if (this.areWeOnline && this.queue.length > 0) {\n                this.flush()\n            }\n            this.poll()\n        }, this._pollInterval) as any as number\n    }\n\n    flush(): void {\n        // using Date.now to make tests easier as recommended here https://codewithhugo.com/mocking-the-current-date-in-jest-tests/\n        const now = new Date(Date.now())\n        const toFlush = this.queue.filter(({ retryAt }) => retryAt < now)\n        if (toFlush.length > 0) {\n            this.queue = this.queue.filter(({ retryAt }) => retryAt >= now)\n            for (const { requestData } of toFlush) {\n                this._executeXhrRequest(requestData)\n            }\n        }\n    }\n\n    unload(): void {\n        if (this._poller) {\n            clearTimeout(this._poller)\n            this._poller = undefined\n        }\n        for (const { requestData } of this.queue) {\n            const { url, data, options } = requestData\n            try {\n                window.navigator.sendBeacon(url, encodePostData(data, { ...options, sendBeacon: true }))\n            } catch (e) {\n                // Note sendBeacon automatically retries, and after the first retry it will loose reference to contextual `this`.\n                // This means in some cases `this.getConfig` will be undefined.\n                if (Config.DEBUG) {\n                    console.error(e)\n                }\n            }\n        }\n        this.queue = []\n    }\n\n    _executeXhrRequest({ url, data, options, headers, callback, retriesPerformedSoFar }: QueuedRequestData): void {\n        xhr({\n            url,\n            data: data || {},\n            options: options || {},\n            headers: headers || {},\n            retriesPerformedSoFar: retriesPerformedSoFar || 0,\n            callback,\n            captureMetrics: this.captureMetrics,\n            retryQueue: this,\n            onXHRError: this.onXHRError,\n        })\n    }\n\n    _handleWeAreNowOnline(): void {\n        this.areWeOnline = true\n        this.flush()\n    }\n}\n", "import { PostHogPersistence, SESSION_ID } from './posthog-persistence'\nimport { sessionStore } from './storage'\nimport { _UUID } from './utils'\nimport { PostHogConfig } from './types'\n\nconst SESSION_CHANGE_THRESHOLD = 30 * 60 * 1000 // 30 mins\nconst SESSION_LENGTH_LIMIT = 24 * 3600 * 1000 // 24 hours\n\nexport class SessionIdManager {\n    config: Partial<PostHogConfig>\n    persistence: PostHogPersistence\n    _windowId: string | null | undefined\n    _sessionId: string | null | undefined\n    window_id_storage_key: string\n    primary_window_exists_storage_key: string\n    _sessionStartTimestamp: number | null\n    _sessionActivityTimestamp: number | null\n\n    constructor(config: Partial<PostHogConfig>, persistence: PostHogPersistence) {\n        this.config = config\n        this.persistence = persistence\n        this._windowId = undefined\n        this._sessionId = undefined\n        this._sessionStartTimestamp = null\n        this._sessionActivityTimestamp = null\n\n        const persistenceName = config['persistence_name'] || config['token']\n\n        this.window_id_storage_key = 'ph_' + persistenceName + '_window_id'\n        this.primary_window_exists_storage_key = 'ph_' + persistenceName + '_primary_window_exists'\n\n        // primary_window_exists is set when the DOM has been loaded and is cleared on unload\n        // if it exists here it means there was no unload which suggests this window is opened as a tab duplication, window.open, etc.\n        if (this._canUseSessionStorage()) {\n            const lastWindowId = sessionStore.parse(this.window_id_storage_key)\n\n            const primaryWindowExists = sessionStore.parse(this.primary_window_exists_storage_key)\n            if (lastWindowId && !primaryWindowExists) {\n                // Persist window from previous storage state\n                this._windowId = lastWindowId\n            } else {\n                // Wipe any reference to previous window id\n                sessionStore.remove(this.window_id_storage_key)\n            }\n            // Flag this session as having a primary window\n            sessionStore.set(this.primary_window_exists_storage_key, true)\n        }\n\n        this._listenToReloadWindow()\n    }\n\n    _canUseSessionStorage(): boolean {\n        // We only want to use sessionStorage if persistence is enabled and not memory storage\n        return this.config.persistence !== 'memory' && !this.persistence.disabled && sessionStore.is_supported()\n    }\n\n    // Note: this tries to store the windowId in sessionStorage. SessionStorage is unique to the current window/tab,\n    // and persists page loads/reloads. So it's uniquely suited for storing the windowId. This function also respects\n    // when persistence is disabled (by user config) and when sessionStorage is not supported (it *should* be supported on all browsers),\n    // and in that case, it falls back to memory (which sadly, won't persist page loads)\n    _setWindowId(windowId: string): void {\n        if (windowId !== this._windowId) {\n            this._windowId = windowId\n            if (this._canUseSessionStorage()) {\n                sessionStore.set(this.window_id_storage_key, windowId)\n            }\n        }\n    }\n\n    _getWindowId(): string | null {\n        if (this._windowId) {\n            return this._windowId\n        }\n        if (this._canUseSessionStorage()) {\n            return sessionStore.parse(this.window_id_storage_key)\n        }\n        // New window id will be generated\n        return null\n    }\n\n    // Note: 'this.persistence.register' can be disabled in the config.\n    // In that case, this works by storing sessionId and the timestamp in memory.\n    _setSessionId(\n        sessionId: string | null,\n        sessionActivityTimestamp: number | null,\n        sessionStartTimestamp: number | null\n    ): void {\n        if (\n            sessionId !== this._sessionId ||\n            sessionActivityTimestamp !== this._sessionActivityTimestamp ||\n            sessionStartTimestamp !== this._sessionStartTimestamp\n        ) {\n            this._sessionStartTimestamp = sessionStartTimestamp\n            this._sessionActivityTimestamp = sessionActivityTimestamp\n            this._sessionId = sessionId\n            this.persistence.register({\n                [SESSION_ID]: [sessionActivityTimestamp, sessionId, sessionStartTimestamp],\n            })\n        }\n    }\n\n    _getSessionId(): [number, string, number] {\n        if (this._sessionId && this._sessionActivityTimestamp && this._sessionStartTimestamp) {\n            return [this._sessionActivityTimestamp, this._sessionId, this._sessionStartTimestamp]\n        }\n        const sessionId = this.persistence.props[SESSION_ID]\n\n        if (Array.isArray(sessionId) && sessionId.length === 2) {\n            // Storage does not yet have a session start time. Add the last activity timestamp as the start time\n            sessionId.push(sessionId[0])\n        }\n\n        return sessionId || [0, null, 0]\n    }\n\n    // Resets the session id by setting it to null. On the subsequent call to checkAndGetSessionAndWindowId,\n    // new ids will be generated.\n    resetSessionId(): void {\n        this._setSessionId(null, null, null)\n    }\n\n    /*\n     * Listens to window unloads and removes the primaryWindowExists key from sessionStorage.\n     * Reloaded or fresh tabs created after a DOM unloads (reloading the same tab) WILL NOT have this primaryWindowExists flag in session storage.\n     * Cloned sessions (new tab, tab duplication, window.open(), ...) WILL have this primaryWindowExists flag in their copied session storage.\n     * We conditionally check the primaryWindowExists value in the constructor to decide if the window id in the last session storage should be carried over.\n     */\n    _listenToReloadWindow(): void {\n        window.addEventListener('beforeunload', () => {\n            if (this._canUseSessionStorage()) {\n                sessionStore.remove(this.primary_window_exists_storage_key)\n            }\n        })\n    }\n\n    /*\n     * This function returns the current sessionId and windowId. It should be used to\n     * access these values over directly calling `._sessionId` or `._windowId`. In addition\n     * to returning the sessionId and windowId, this function also manages cycling the\n     * sessionId and windowId when appropriate by doing the following:\n     *\n     * 1. If the sessionId or windowId is not set, it will generate a new one and store it.\n     * 2. If the readOnly param is set to false, it will:\n     *    a. Check if it has been > SESSION_CHANGE_THRESHOLD since the last call with this flag set.\n     *       If so, it will generate a new sessionId and store it.\n     *    b. Update the timestamp stored with the sessionId to ensure the current session is extended\n     *       for the appropriate amount of time.\n     *\n     * @param {boolean} readOnly (optional) Defaults to False. Should be set to True when the call to the function should not extend or cycle the session (e.g. being called for non-user generated events)\n     * @param {Number} timestamp (optional) Defaults to the current time. The timestamp to be stored with the sessionId (used when determining if a new sessionId should be generated)\n     */\n    checkAndGetSessionAndWindowId(readOnly = false, _timestamp: number | null = null) {\n        const timestamp = _timestamp || new Date().getTime()\n\n        // eslint-disable-next-line prefer-const\n        let [lastTimestamp, sessionId, startTimestamp] = this._getSessionId()\n        let windowId = this._getWindowId()\n\n        const sessionPastMaximumLength =\n            startTimestamp && startTimestamp > 0 && Math.abs(timestamp - startTimestamp) > SESSION_LENGTH_LIMIT\n\n        if (\n            !sessionId ||\n            (!readOnly && Math.abs(timestamp - lastTimestamp) > SESSION_CHANGE_THRESHOLD) ||\n            sessionPastMaximumLength\n        ) {\n            sessionId = _UUID()\n            windowId = _UUID()\n            startTimestamp = timestamp\n        } else if (!windowId) {\n            windowId = _UUID()\n        }\n\n        const newTimestamp = lastTimestamp === 0 || !readOnly || sessionPastMaximumLength ? timestamp : lastTimestamp\n        const sessionStartTimestamp = startTimestamp === 0 ? new Date().getTime() : startTimestamp\n\n        this._setWindowId(windowId)\n        this._setSessionId(sessionId, newTimestamp, sessionStartTimestamp)\n\n        return {\n            sessionId: sessionId,\n            windowId: windowId,\n        }\n    }\n}\n", "/**\n * Integrate Sentry with PostHog. This will add a direct link to the person in Sentry, and an $exception event in PostHog\n *\n * ### Usage\n *\n *     Sentry.init({\n *          dsn: 'https://example',\n *          integrations: [\n *              new posthog.SentryIntegration(posthog)\n *          ]\n *     })\n *\n * @param {Object} [posthog] The posthog object\n * @param {string} [organization] Optional: The Sentry organization, used to send a direct link from PostHog to Sentry\n * @param {Number} [projectId] Optional: The Sentry project id, used to send a direct link from PostHog to Sentry\n * @param {string} [prefix] Optional: Url of a self-hosted sentry instance (default: https://sentry.io/organizations/)\n */\n\nimport { Properties } from '../types'\nimport { PostHog } from '../posthog-core'\nimport { ErrorProperties } from './exceptions/error-conversion'\n\n// NOTE - we can't import from @sentry/types because it changes frequently and causes clashes\n// We only use a small subset of the types, so we can just define the integration overall and use any for the rest\n\n// import {\n//     Event as _SentryEvent,\n//     EventProcessor as _SentryEventProcessor,\n//     Hub as _SentryHub,\n//     Integration as _SentryIntegration,\n// } from '@sentry/types'\n\n// Uncomment the above and comment the below to get type checking for development\n\ntype _SentryEvent = any\ntype _SentryEventProcessor = any\ntype _SentryHub = any\n\ninterface _SentryIntegration {\n    name: string\n    setupOnce(addGlobalEventProcessor: (callback: _SentryEventProcessor) => void, getCurrentHub: () => _SentryHub): void\n}\n\ninterface SentryExceptionProperties {\n    $sentry_event_id: any\n    $sentry_exception: any\n    $sentry_exception_message: any\n    $sentry_exception_type: any\n    $sentry_tags: any\n    $sentry_url?: string\n}\n\nexport class SentryIntegration implements _SentryIntegration {\n    name: string\n\n    setupOnce: (\n        addGlobalEventProcessor: (callback: _SentryEventProcessor) => void,\n        getCurrentHub: () => _SentryHub\n    ) => void\n\n    constructor(_posthog: PostHog, organization?: string, projectId?: number, prefix?: string) {\n        // setupOnce gets called by Sentry when it intializes the plugin\n        this.name = 'posthog-js'\n        this.setupOnce = function (addGlobalEventProcessor: (callback: _SentryEventProcessor) => void) {\n            addGlobalEventProcessor((event: _SentryEvent) => {\n                if (event.level !== 'error' || !_posthog.__loaded) return event\n                if (!event.tags) event.tags = {}\n\n                const host = _posthog.config.ui_host || _posthog.config.api_host\n                event.tags['PostHog Person URL'] = host + '/person/' + _posthog.get_distinct_id()\n                if (_posthog.sessionRecordingStarted()) {\n                    event.tags['PostHog Recording URL'] = _posthog.get_session_replay_url({ withTimestamp: true })\n                }\n\n                const exceptions = event.exception?.values || []\n\n                const data: SentryExceptionProperties & ErrorProperties = {\n                    // PostHog Exception Properties,\n                    $exception_message: exceptions[0]?.value,\n                    $exception_type: exceptions[0]?.type,\n                    $exception_personURL: host + '/person/' + _posthog.get_distinct_id(),\n                    // Sentry Exception Properties\n                    $sentry_event_id: event.event_id,\n                    $sentry_exception: event.exception,\n                    $sentry_exception_message: exceptions[0]?.value,\n                    $sentry_exception_type: exceptions[0]?.type,\n                    $sentry_tags: event.tags,\n                }\n\n                if (organization && projectId)\n                    data['$sentry_url'] =\n                        (prefix || 'https://sentry.io/organizations/') +\n                        organization +\n                        '/issues/?project=' +\n                        projectId +\n                        '&query=' +\n                        event.event_id\n                _posthog.capture('$exception', data)\n                return event\n            })\n        }\n    }\n}\n", "/**\n * Extend Segment with extra PostHog JS functionality. Required for things like Recordings and feature flags to work correctly.\n *\n * ### Usage\n *\n *  ```js\n *  // After your standard segment anyalytics install\n *  analytics.load(\"GOEDfA21zZTtR7clsBuDvmBKAtAdZ6Np\");\n *\n *  analytics.ready(() => {\n *    posthog.init('<posthog-api-key>', {\n *      capture_pageview: false,\n *      segment: window.analytics, // NOTE: Be sure to use window.analytics here!\n *    });\n *    window.analytics.page();\n *  })\n *  ```\n */\nimport { PostHog } from '../posthog-core'\n\n// Loosely based on https://github.com/segmentio/analytics-next/blob/master/packages/core/src/plugins/index.ts\ninterface SegmentPluginContext {\n    event: {\n        event: string\n        userId?: string\n        anonymousId?: string\n        properties: any\n    }\n}\n\ninterface SegmentPlugin {\n    name: string\n    version: string\n    type: 'enrichment'\n    isLoaded: () => boolean\n    load: (ctx: SegmentPluginContext, instance: any, config?: any) => Promise<unknown>\n    unload?: (ctx: SegmentPluginContext, instance: any) => Promise<unknown> | unknown\n    ready?: () => Promise<unknown>\n    track?: (ctx: SegmentPluginContext) => Promise<SegmentPluginContext> | SegmentPluginContext\n    identify?: (ctx: SegmentPluginContext) => Promise<SegmentPluginContext> | SegmentPluginContext\n    page?: (ctx: SegmentPluginContext) => Promise<SegmentPluginContext> | SegmentPluginContext\n    group?: (ctx: SegmentPluginContext) => Promise<SegmentPluginContext> | SegmentPluginContext\n    alias?: (ctx: SegmentPluginContext) => Promise<SegmentPluginContext> | SegmentPluginContext\n    screen?: (ctx: SegmentPluginContext) => Promise<SegmentPluginContext> | SegmentPluginContext\n}\n\nexport const createSegmentIntegration = (posthog: PostHog): SegmentPlugin => {\n    const enrichEvent = (ctx: SegmentPluginContext, eventName: string) => {\n        if (!ctx.event.userId && ctx.event.anonymousId !== posthog.get_distinct_id()) {\n            // This is our only way of detecting that segment's analytics.reset() has been called so we also call it\n            posthog.reset()\n        }\n        if (ctx.event.userId && ctx.event.userId !== posthog.get_distinct_id()) {\n            posthog.register({\n                distinct_id: ctx.event.userId,\n            })\n            posthog.reloadFeatureFlags()\n        }\n\n        const additionalProperties = posthog._calculate_event_properties(eventName, ctx.event.properties)\n        ctx.event.properties = Object.assign({}, additionalProperties, ctx.event.properties)\n        return ctx\n    }\n\n    return {\n        name: 'PostHog JS',\n        type: 'enrichment',\n        version: '1.0.0',\n        isLoaded: () => true,\n        load: () => Promise.resolve(),\n        track: (ctx) => enrichEvent(ctx, ctx.event.event),\n        page: (ctx) => enrichEvent(ctx, '$pageview'),\n        identify: (ctx) => enrichEvent(ctx, '$identify'),\n        screen: (ctx) => enrichEvent(ctx, '$screen'),\n    }\n}\n", "import { _UUID } from './utils'\n\nexport class PageViewIdManager {\n    _pageViewId: string | undefined\n\n    _seenFirstPageView = false\n\n    onPageview(): void {\n        // As the first $pageview event may come after a different event,\n        // we only reset the ID _after_ the second $pageview event.\n        if (this._seenFirstPageView) {\n            this._pageViewId = _UUID()\n        }\n        this._seenFirstPageView = true\n    }\n\n    getPageViewId(): string {\n        if (!this._pageViewId) {\n            this._pageViewId = _UUID()\n        }\n\n        return this._pageViewId\n    }\n}\n", "export function isEvent(candidate: unknown): candidate is Event {\n    return typeof Event !== 'undefined' && isInstanceOf(candidate, Event)\n}\n\nexport function isPlainObject(candidate: unknown): candidate is Record<string, unknown> {\n    return isBuiltin(candidate, 'Object')\n}\n\nexport function isInstanceOf(candidate: unknown, base: any): boolean {\n    try {\n        return candidate instanceof base\n    } catch (_e) {\n        return false\n    }\n}\n\nexport function isPrimitive(\n    candidate: unknown\n): candidate is number | string | boolean | bigint | symbol | null | undefined {\n    return candidate === null || (typeof candidate !== 'object' && typeof candidate !== 'function')\n}\n\nexport function isError(candidate: unknown): candidate is Error {\n    switch (Object.prototype.toString.call(candidate)) {\n        case '[object Error]':\n        case '[object Exception]':\n        case '[object DOMException]':\n            return true\n        default:\n            return isInstanceOf(candidate, Error)\n    }\n}\n\nexport function isErrorEvent(event: string | Error | Event): event is ErrorEvent {\n    return isBuiltin(event, 'ErrorEvent')\n}\n\nexport function isErrorWithStack(candidate: unknown): candidate is Error {\n    return 'stack' in (candidate as Error)\n}\n\nexport function isBuiltin(candidate: unknown, className: string): boolean {\n    return Object.prototype.toString.call(candidate) === `[object ${className}]`\n}\n\nexport function isDOMException(candidate: unknown): boolean {\n    return isBuiltin(candidate, 'DOMException')\n}\n\nexport function isDOMError(candidate: unknown): boolean {\n    return isBuiltin(candidate, 'DOMError')\n}\n", "// copied and adapted from https://github.com/getsentry/sentry-javascript/blob/41fef4b10f3a644179b77985f00f8696c908539f/packages/browser/src/stack-parsers.ts\n// \uD83D\uDC96open source\n\n// This was originally forked from https://github.com/csnover/TraceKit, and was largely\n// re-written as part of raven - js.\n//\n// This code was later copied to the JavaScript mono - repo and further modified and\n// refactored over the years.\n\n// Copyright (c) 2013 Onur Can Cakmak onur.cakmak@gmail.com and all TraceKit contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy of this\n// software and associated documentation files(the 'Software'), to deal in the Software\n// without restriction, including without limitation the rights to use, copy, modify,\n// merge, publish, distribute, sublicense, and / or sell copies of the Software, and to\n// permit persons to whom the Software is furnished to do so, subject to the following\n// conditions:\n//\n// The above copyright notice and this permission notice shall be included in all copies\n// or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\n// INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\n// PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF\n// CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE\n// OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nconst WEBPACK_ERROR_REGEXP = /\\(error: (.*)\\)/\nconst STACKTRACE_FRAME_LIMIT = 50\n\nconst UNKNOWN_FUNCTION = '?'\n\nconst OPERA10_PRIORITY = 10\nconst OPERA11_PRIORITY = 20\nconst CHROME_PRIORITY = 30\nconst WINJS_PRIORITY = 40\nconst GECKO_PRIORITY = 50\n\nexport interface StackFrame {\n    filename?: string\n    function?: string\n    module?: string\n    platform?: string\n    lineno?: number\n    colno?: number\n    abs_path?: string\n    context_line?: string\n    pre_context?: string[]\n    post_context?: string[]\n    in_app?: boolean\n    instruction_addr?: string\n    addr_mode?: string\n    vars?: { [key: string]: any }\n    debug_id?: string\n}\n\nfunction createFrame(filename: string, func: string, lineno?: number, colno?: number): StackFrame {\n    const frame: StackFrame = {\n        filename,\n        function: func,\n        in_app: true, // All browser frames are considered in_app\n    }\n\n    if (lineno !== undefined) {\n        frame.lineno = lineno\n    }\n\n    if (colno !== undefined) {\n        frame.colno = colno\n    }\n\n    return frame\n}\n\nexport type StackParser = (stack: string, skipFirst?: number) => StackFrame[]\nexport type StackLineParserFn = (line: string) => StackFrame | undefined\nexport type StackLineParser = [number, StackLineParserFn]\n\n// Chromium based browsers: Chrome, Brave, new Opera, new Edge\nconst chromeRegex =\n    /^\\s*at (?:(.+?\\)(?: \\[.+\\])?|.*?) ?\\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\\/)?.*?)(?::(\\d+))?(?::(\\d+))?\\)?\\s*$/i\nconst chromeEvalRegex = /\\((\\S*)(?::(\\d+))(?::(\\d+))\\)/\n\nconst chrome: StackLineParserFn = (line) => {\n    const parts = chromeRegex.exec(line)\n\n    if (parts) {\n        const isEval = parts[2] && parts[2].indexOf('eval') === 0 // start of line\n\n        if (isEval) {\n            const subMatch = chromeEvalRegex.exec(parts[2])\n\n            if (subMatch) {\n                // throw out eval line/column and use top-most line/column number\n                parts[2] = subMatch[1] // url\n                parts[3] = subMatch[2] // line\n                parts[4] = subMatch[3] // column\n            }\n        }\n\n        // Kamil: One more hack won't hurt us right? Understanding and adding more rules on top of these regexps right now\n        // would be way too time consuming. (TODO: Rewrite whole RegExp to be more readable)\n        const [func, filename] = extractSafariExtensionDetails(parts[1] || UNKNOWN_FUNCTION, parts[2])\n\n        return createFrame(filename, func, parts[3] ? +parts[3] : undefined, parts[4] ? +parts[4] : undefined)\n    }\n\n    return\n}\n\nexport const chromeStackLineParser: StackLineParser = [CHROME_PRIORITY, chrome]\n\n// gecko regex: `(?:bundle|\\d+\\.js)`: `bundle` is for react native, `\\d+\\.js` also but specifically for ram bundles because it\n// generates filenames without a prefix like `file://` the filenames in the stacktrace are just 42.js\n// We need this specific case for now because we want no other regex to match.\nconst geckoREgex =\n    /^\\s*(.*?)(?:\\((.*?)\\))?(?:^|@)?((?:[-a-z]+)?:\\/.*?|\\[native code\\]|[^@]*(?:bundle|\\d+\\.js)|\\/[\\w\\-. /=]+)(?::(\\d+))?(?::(\\d+))?\\s*$/i\nconst geckoEvalRegex = /(\\S+) line (\\d+)(?: > eval line \\d+)* > eval/i\n\nconst gecko: StackLineParserFn = (line) => {\n    const parts = geckoREgex.exec(line)\n\n    if (parts) {\n        const isEval = parts[3] && parts[3].indexOf(' > eval') > -1\n        if (isEval) {\n            const subMatch = geckoEvalRegex.exec(parts[3])\n\n            if (subMatch) {\n                // throw out eval line/column and use top-most line number\n                parts[1] = parts[1] || 'eval'\n                parts[3] = subMatch[1]\n                parts[4] = subMatch[2]\n                parts[5] = '' // no column when eval\n            }\n        }\n\n        let filename = parts[3]\n        let func = parts[1] || UNKNOWN_FUNCTION\n        ;[func, filename] = extractSafariExtensionDetails(func, filename)\n\n        return createFrame(filename, func, parts[4] ? +parts[4] : undefined, parts[5] ? +parts[5] : undefined)\n    }\n\n    return\n}\n\nexport const geckoStackLineParser: StackLineParser = [GECKO_PRIORITY, gecko]\n\nconst winjsRegex = /^\\s*at (?:((?:\\[object object\\])?.+) )?\\(?((?:[-a-z]+):.*?):(\\d+)(?::(\\d+))?\\)?\\s*$/i\n\nconst winjs: StackLineParserFn = (line) => {\n    const parts = winjsRegex.exec(line)\n\n    return parts\n        ? createFrame(parts[2], parts[1] || UNKNOWN_FUNCTION, +parts[3], parts[4] ? +parts[4] : undefined)\n        : undefined\n}\n\nexport const winjsStackLineParser: StackLineParser = [WINJS_PRIORITY, winjs]\n\nconst opera10Regex = / line (\\d+).*script (?:in )?(\\S+)(?:: in function (\\S+))?$/i\n\nconst opera10: StackLineParserFn = (line) => {\n    const parts = opera10Regex.exec(line)\n    return parts ? createFrame(parts[2], parts[3] || UNKNOWN_FUNCTION, +parts[1]) : undefined\n}\n\nexport const opera10StackLineParser: StackLineParser = [OPERA10_PRIORITY, opera10]\n\nconst opera11Regex = / line (\\d+), column (\\d+)\\s*(?:in (?:<anonymous function: ([^>]+)>|([^)]+))\\(.*\\))? in (.*):\\s*$/i\n\nconst opera11: StackLineParserFn = (line) => {\n    const parts = opera11Regex.exec(line)\n    return parts ? createFrame(parts[5], parts[3] || parts[4] || UNKNOWN_FUNCTION, +parts[1], +parts[2]) : undefined\n}\n\nexport const opera11StackLineParser: StackLineParser = [OPERA11_PRIORITY, opera11]\n\nexport const defaultStackLineParsers = [chromeStackLineParser, geckoStackLineParser, winjsStackLineParser]\n\nexport function reverse(stack: ReadonlyArray<StackFrame>): StackFrame[] {\n    if (!stack.length) {\n        return []\n    }\n\n    const localStack = stack.slice(0, STACKTRACE_FRAME_LIMIT)\n\n    localStack.reverse()\n\n    return localStack.map((frame) => ({\n        ...frame,\n        filename: frame.filename || localStack[localStack.length - 1].filename,\n        function: frame.function || '?',\n    }))\n}\n\nexport function createStackParser(...parsers: StackLineParser[]): StackParser {\n    const sortedParsers = parsers.sort((a, b) => a[0] - b[0]).map((p) => p[1])\n\n    return (stack: string, skipFirst = 0): StackFrame[] => {\n        const frames: StackFrame[] = []\n        const lines = stack.split('\\n')\n\n        for (let i = skipFirst; i < lines.length; i++) {\n            const line = lines[i]\n            // Ignore lines over 1kb as they are unlikely to be stack frames.\n            // Many of the regular expressions use backtracking which results in run time that increases exponentially with\n            // input size. Huge strings can result in hangs/Denial of Service:\n            // https://github.com/getsentry/sentry-javascript/issues/2286\n            if (line.length > 1024) {\n                continue\n            }\n\n            // https://github.com/getsentry/sentry-javascript/issues/5459\n            // Remove webpack (error: *) wrappers\n            const cleanedLine = WEBPACK_ERROR_REGEXP.test(line) ? line.replace(WEBPACK_ERROR_REGEXP, '$1') : line\n\n            // https://github.com/getsentry/sentry-javascript/issues/7813\n            // Skip Error: lines\n            if (cleanedLine.match(/\\S*Error: /)) {\n                continue\n            }\n\n            for (const parser of sortedParsers) {\n                const frame = parser(cleanedLine)\n\n                if (frame) {\n                    frames.push(frame)\n                    break\n                }\n            }\n\n            if (frames.length >= STACKTRACE_FRAME_LIMIT) {\n                break\n            }\n        }\n\n        return reverse(frames)\n    }\n}\n\nexport const defaultStackParser = createStackParser(...defaultStackLineParsers)\n\n/**\n * Safari web extensions, starting version unknown, can produce \"frames-only\" stacktraces.\n * What it means, is that instead of format like:\n *\n * Error: wat\n *   at function@url:row:col\n *   at function@url:row:col\n *   at function@url:row:col\n *\n * it produces something like:\n *\n *   function@url:row:col\n *   function@url:row:col\n *   function@url:row:col\n *\n * Because of that, it won't be captured by `chrome` RegExp and will fall into `Gecko` branch.\n * This function is extracted so that we can use it in both places without duplicating the logic.\n * Unfortunately \"just\" changing RegExp is too complicated now and making it pass all tests\n * and fix this case seems like an impossible, or at least way too time-consuming task.\n */\nconst extractSafariExtensionDetails = (func: string, filename: string): [string, string] => {\n    const isSafariExtension = func.indexOf('safari-extension') !== -1\n    const isSafariWebExtension = func.indexOf('safari-web-extension') !== -1\n\n    return isSafariExtension || isSafariWebExtension\n        ? [\n              func.indexOf('@') !== -1 ? func.split('@')[0] : UNKNOWN_FUNCTION,\n              isSafariExtension ? `safari-extension:${filename}` : `safari-web-extension:${filename}`,\n          ]\n        : [func, filename]\n}\n", "import {\n    isDOMError,\n    isDOMException,\n    isError,\n    isErrorEvent,\n    isErrorWithStack,\n    isEvent,\n    isPlainObject,\n    isPrimitive,\n} from './type-checking'\nimport { defaultStackParser, StackFrame } from './stack-trace'\n\n/**\n * based on the very wonderful MIT licensed Sentry SDK\n */\n\nconst ERROR_TYPES_PATTERN =\n    /^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i\n\nexport type ErrorEventArgs = [\n    event: string | Event,\n    source?: string | undefined,\n    lineno?: number | undefined,\n    colno?: number | undefined,\n    error?: Error | undefined\n]\n\nexport interface ErrorProperties {\n    $exception_type: string\n    $exception_message: string\n    $exception_source?: string\n    $exception_lineno?: number\n    $exception_colno?: number\n    $exception_DOMException_code?: string\n    $exception_is_synthetic?: boolean\n    $exception_stack_trace_raw?: string\n    $exception_handled?: boolean\n    $exception_personURL?: string\n}\n\nconst reactMinifiedRegexp = /Minified React error #\\d+;/i\n\nfunction getPopSize(ex: Error & { framesToPop?: number }): number {\n    if (ex) {\n        if (typeof ex.framesToPop === 'number') {\n            return ex.framesToPop\n        }\n\n        if (reactMinifiedRegexp.test(ex.message)) {\n            return 1\n        }\n    }\n\n    return 0\n}\n\nexport function parseStackFrames(ex: Error & { framesToPop?: number; stacktrace?: string }): StackFrame[] {\n    // Access and store the stacktrace property before doing ANYTHING\n    // else to it because Opera is not very good at providing it\n    // reliably in other circumstances.\n    const stacktrace = ex.stacktrace || ex.stack || ''\n\n    const popSize = getPopSize(ex)\n\n    try {\n        return defaultStackParser(stacktrace, popSize)\n    } catch (e) {\n        // no-empty\n    }\n\n    return []\n}\n\nfunction errorPropertiesFromError(error: Error): ErrorProperties {\n    const frames = parseStackFrames(error)\n\n    return {\n        $exception_type: error.name,\n        $exception_message: error.message,\n        $exception_stack_trace_raw: JSON.stringify(frames),\n    }\n}\n\nfunction errorPropertiesFromString(candidate: string): ErrorProperties {\n    return {\n        $exception_type: 'Error',\n        $exception_message: candidate,\n    }\n}\n\n/**\n * Given any captured exception, extract its keys and create a sorted\n * and truncated list that will be used inside the event message.\n * eg. `Non-error exception captured with keys: foo, bar, baz`\n */\nfunction extractExceptionKeysForMessage(exception: Record<string, unknown>, maxLength = 40): string {\n    const keys = Object.keys(exception)\n    keys.sort()\n\n    if (!keys.length) {\n        return '[object has no keys]'\n    }\n\n    for (let i = keys.length; i > 0; i--) {\n        const serialized = keys.slice(0, i).join(', ')\n        if (serialized.length > maxLength) {\n            continue\n        }\n        if (i === keys.length) {\n            return serialized\n        }\n        return serialized.length <= maxLength ? serialized : `${serialized.slice(0, maxLength)}...`\n    }\n\n    return ''\n}\n\nfunction errorPropertiesFromObject(candidate: Record<string, unknown>): ErrorProperties {\n    return {\n        $exception_type: isEvent(candidate) ? candidate.constructor.name : 'Error',\n        $exception_message: `Non-Error ${'exception'} captured with keys: ${extractExceptionKeysForMessage(candidate)}`,\n    }\n}\n\nexport function errorToProperties([event, source, lineno, colno, error]: ErrorEventArgs): ErrorProperties {\n    // exception type and message are not optional but, it's useful to start off without them enforced\n    let errorProperties: Omit<ErrorProperties, '$exception_type' | '$exception_message'> & {\n        $exception_type?: string\n        $exception_message?: string\n    } = {}\n\n    if (error === undefined && typeof event === 'string') {\n        let name = 'Error'\n        let message = event\n        const groups = event.match(ERROR_TYPES_PATTERN)\n        if (groups) {\n            name = groups[1]\n            message = groups[2]\n        }\n        errorProperties = {\n            $exception_type: name,\n            $exception_message: message,\n        }\n    }\n\n    const candidate = error || event\n\n    if (isErrorEvent(candidate as ErrorEvent) && (candidate as ErrorEvent).error) {\n        errorProperties = errorPropertiesFromError((candidate as ErrorEvent).error as Error)\n    } else if (isDOMError(candidate) || isDOMException(candidate)) {\n        // https://developer.mozilla.org/en-US/docs/Web/API/DOMError\n        // https://developer.mozilla.org/en-US/docs/Web/API/DOMException\n\n        const domException = candidate as unknown as DOMException\n\n        if (isErrorWithStack(candidate)) {\n            errorProperties = errorPropertiesFromError(candidate as Error)\n        } else {\n            const name = domException.name || (isDOMError(domException) ? 'DOMError' : 'DOMException')\n            const message = domException.message ? `${name}: ${domException.message}` : name\n            errorProperties = errorPropertiesFromString(message)\n            errorProperties.$exception_type = errorProperties.$exception_type || 'Error'\n            errorProperties.$exception_message = errorProperties.$exception_message || message\n        }\n        if ('code' in domException) {\n            errorProperties['$exception_DOMException_code'] = `${domException.code}`\n        }\n    } else if (isError(candidate)) {\n        errorProperties = errorPropertiesFromError(candidate)\n    } else if (isPlainObject(candidate) || isEvent(candidate)) {\n        // group these by using the keys available on the object\n        const objectException = candidate as Record<string, unknown>\n        errorProperties = errorPropertiesFromObject(objectException)\n        errorProperties.$exception_is_synthetic = true\n    } else {\n        // If none of previous checks were valid, then it must be a string\n        errorProperties.$exception_type = errorProperties.$exception_type || 'Error'\n        errorProperties.$exception_message = errorProperties.$exception_message || candidate\n        errorProperties.$exception_is_synthetic = true\n    }\n\n    return {\n        ...errorProperties,\n        // now we make sure the mandatory fields that were made optional are present\n        $exception_type: errorProperties.$exception_type || 'UnknownErrorType',\n        $exception_message: errorProperties.$exception_message || '',\n        ...(source\n            ? {\n                  $exception_source: source, // TODO get this from URL if not present\n              }\n            : {}),\n        ...(lineno ? { $exception_lineno: lineno } : {}),\n        ...(colno ? { $exception_colno: colno } : {}),\n    }\n}\n\nexport function unhandledRejectionToProperties([ev]: [ev: PromiseRejectionEvent]): ErrorProperties {\n    // dig the object of the rejection out of known event types\n    let error: unknown = ev\n    try {\n        // PromiseRejectionEvents store the object of the rejection under 'reason'\n        // see https://developer.mozilla.org/en-US/docs/Web/API/PromiseRejectionEvent\n        if ('reason' in ev) {\n            error = ev.reason\n        }\n        // something, somewhere, (likely a browser extension) effectively casts PromiseRejectionEvents\n        // to CustomEvents, moving the `promise` and `reason` attributes of the PRE into\n        // the CustomEvent's `detail` attribute, since they're not part of CustomEvent's spec\n        // see https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent and\n        // https://github.com/getsentry/sentry-javascript/issues/2380\n        else if ('detail' in ev && 'reason' in (ev as any).detail) {\n            error = (ev as any).detail.reason\n        }\n    } catch (_oO) {\n        // no-empty\n    }\n\n    // exception type and message are not optional but, it's useful to start off without them enforced\n    let errorProperties: Omit<ErrorProperties, '$exception_type' | '$exception_message'> & {\n        $exception_type?: string\n        $exception_message?: string\n    } = {}\n    if (isPrimitive(error)) {\n        errorProperties = {\n            $exception_message: `Non-Error promise rejection captured with value: ${String(error)}`,\n        }\n    } else {\n        errorProperties = errorToProperties([error as string | Event])\n    }\n    errorProperties.$exception_handled = false\n\n    return {\n        ...errorProperties,\n        // now we make sure the mandatory fields that were made optional are present\n        $exception_type: (errorProperties.$exception_type = 'UnhandledRejection'),\n        $exception_message: (errorProperties.$exception_message =\n            errorProperties.$exception_message || (ev as any).reason || String(error)),\n    }\n}\n", "import { window } from '../../utils'\nimport { PostHog } from '../../posthog-core'\nimport { DecideResponse, Properties } from '../../types'\nimport { ErrorEventArgs, ErrorProperties, errorToProperties, unhandledRejectionToProperties } from './error-conversion'\n\nconst EXCEPTION_INGESTION_ENDPOINT = '/e/'\n\nexport class ExceptionObserver {\n    instance: PostHog\n    remoteEnabled: boolean | undefined\n    private originalOnErrorHandler: typeof window['onerror'] | null | undefined = undefined\n    private originalOnUnhandledRejectionHandler: typeof window['onunhandledrejection'] | null | undefined = undefined\n\n    constructor(instance: PostHog) {\n        this.instance = instance\n    }\n\n    startCapturing() {\n        if (!this.isEnabled() || (window.onerror as any)?.__POSTHOG_INSTRUMENTED__) {\n            return\n        }\n\n        try {\n            this.originalOnErrorHandler = window.onerror\n\n            window.onerror = function (this: ExceptionObserver, ...args: ErrorEventArgs): boolean {\n                this.captureException(args)\n\n                if (this.originalOnErrorHandler) {\n                    // eslint-disable-next-line prefer-rest-params\n                    return this.originalOnErrorHandler.apply(this, args)\n                }\n\n                return false\n            }.bind(this)\n            ;(window.onerror as any).__POSTHOG_INSTRUMENTED__ = true\n\n            this.originalOnUnhandledRejectionHandler = window.onunhandledrejection\n\n            window.onunhandledrejection = function (\n                this: ExceptionObserver,\n                ...args: [ev: PromiseRejectionEvent]\n            ): boolean {\n                const errorProperties: ErrorProperties = unhandledRejectionToProperties(args)\n                this.sendExceptionEvent(errorProperties)\n\n                if (this.originalOnUnhandledRejectionHandler) {\n                    // eslint-disable-next-line prefer-rest-params\n                    return this.originalOnUnhandledRejectionHandler.apply(window, args)\n                }\n\n                return true\n            }.bind(this)\n            ;(window.onunhandledrejection as any).__POSTHOG_INSTRUMENTED__ = true\n        } catch (e) {\n            console.error('PostHog failed to start exception autocapture', e)\n            this.stopCapturing()\n        }\n    }\n\n    stopCapturing() {\n        if (this.originalOnErrorHandler !== undefined) {\n            window.onerror = this.originalOnErrorHandler\n            this.originalOnErrorHandler = null\n        }\n        delete (window.onerror as any)?.__POSTHOG_INSTRUMENTED__\n\n        if (this.originalOnUnhandledRejectionHandler !== undefined) {\n            window.onunhandledrejection = this.originalOnUnhandledRejectionHandler\n            this.originalOnUnhandledRejectionHandler = null\n        }\n        delete (window.onunhandledrejection as any)?.__POSTHOG_INSTRUMENTED__\n    }\n\n    isCapturing() {\n        return !!(window.onerror as any)?.__POSTHOG_INSTRUMENTED__\n    }\n\n    isEnabled() {\n        return this.remoteEnabled ?? false\n    }\n\n    afterDecideResponse(response: DecideResponse) {\n        this.remoteEnabled = response.autocaptureExceptions || false\n        if (this.isEnabled()) {\n            this.startCapturing()\n        }\n    }\n\n    captureException(args: ErrorEventArgs, properties?: Properties) {\n        const errorProperties = errorToProperties(args)\n        const propertiesToSend = { ...properties, ...errorProperties }\n\n        const posthogHost = this.instance.config.ui_host || this.instance.config.api_host\n        errorProperties.$exception_personURL = posthogHost + '/person/' + this.instance.get_distinct_id()\n\n        this.sendExceptionEvent(propertiesToSend)\n    }\n\n    /**\n     * :TRICKY: Make sure we batch these requests\n     */\n    sendExceptionEvent(properties: { [key: string]: any }) {\n        this.instance.capture('$exception', properties, {\n            transport: 'XHR',\n            method: 'POST',\n            endpoint: EXCEPTION_INGESTION_ENDPOINT,\n            _noTruncate: true,\n            _batchKey: 'exceptionEvent',\n        })\n    }\n}\n", "import Config from './config'\nimport {\n    logger,\n    document,\n    userAgent,\n    window,\n    _isUndefined,\n    _extend,\n    _each,\n    _isObject,\n    _isBlockedUA,\n    _copyAndTruncateStrings,\n    _isArray,\n    _safewrap_class,\n    _register_event,\n    _UUID,\n    _info,\n    _eachArray,\n} from './utils'\nimport { autocapture } from './autocapture'\nimport { PostHogPeople } from './posthog-people'\nimport { PostHogFeatureFlags } from './posthog-featureflags'\nimport { ALIAS_ID_KEY, PEOPLE_DISTINCT_ID_KEY, PostHogPersistence } from './posthog-persistence'\nimport { SessionRecording } from './extensions/sessionrecording'\nimport { WebPerformanceObserver } from './extensions/web-performance'\nimport { Decide } from './decide'\nimport { Toolbar } from './extensions/toolbar'\nimport { clearOptInOut, hasOptedIn, hasOptedOut, optIn, optOut, userOptedOut } from './gdpr-utils'\nimport { cookieStore, localStore } from './storage'\nimport { RequestQueue } from './request-queue'\nimport { CaptureMetrics } from './capture-metrics'\nimport { compressData, decideCompression } from './compression'\nimport { addParamsToURL, encodePostData, xhr } from './send-request'\nimport { RetryQueue } from './retry-queue'\nimport { SessionIdManager } from './sessionid'\nimport {\n    CaptureOptions,\n    CaptureResult,\n    Compression,\n    ToolbarParams,\n    GDPROptions,\n    isFeatureEnabledOptions,\n    JSC,\n    OptInOutCapturingOptions,\n    PostHogConfig,\n    Properties,\n    Property,\n    RequestCallback,\n    SnippetArrayItem,\n    XHROptions,\n    AutocaptureConfig,\n    JsonType,\n    EarlyAccessFeatureCallback,\n} from './types'\nimport { SentryIntegration } from './extensions/sentry-integration'\nimport { createSegmentIntegration } from './extensions/segment-integration'\nimport { PageViewIdManager } from './page-view-id'\nimport { ExceptionObserver } from './extensions/exceptions/exception-autocapture'\n\n/*\nSIMPLE STYLE GUIDE:\n\nthis.x === public function\nthis._x === internal - only use within this file\nthis.__x === private - only use within the class\n\nGlobals should be all caps\n*/\n\nenum InitType {\n    INIT_MODULE = 0,\n    INIT_SNIPPET = 1,\n}\n\nlet init_type: InitType\n\n// TODO: the type of this is very loose. Sometimes it's also PostHogLib itself\nlet posthog_master: Record<string, PostHog> & {\n    init: (token: string, config: Partial<PostHogConfig>, name: string) => void\n}\n\n// some globals for comparisons\nconst __NOOP = () => {}\nconst __NOOPTIONS = {}\n\nconst PRIMARY_INSTANCE_NAME = 'posthog'\n\n/*\n * Dynamic... constants? Is that an oxymoron?\n */\n// http://hacks.mozilla.org/2009/07/cross-site-xmlhttprequest-with-cors/\n// https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest#withCredentials\nconst USE_XHR = window.XMLHttpRequest && 'withCredentials' in new XMLHttpRequest()\n\n// IE<10 does not support cross-origin XHR's but script tags\n// with defer won't block window.onload; ENQUEUE_REQUESTS\n// should only be true for Opera<12\nlet ENQUEUE_REQUESTS = !USE_XHR && userAgent.indexOf('MSIE') === -1 && userAgent.indexOf('Mozilla') === -1\n\nconst defaultConfig = (): PostHogConfig => ({\n    api_host: 'https://app.posthog.com',\n    api_method: 'POST',\n    api_transport: 'XHR',\n    ui_host: null,\n    token: '',\n    autocapture: true,\n    rageclick: true,\n    cross_subdomain_cookie: document?.location?.hostname?.indexOf('herokuapp.com') === -1,\n    persistence: 'cookie',\n    persistence_name: '',\n    cookie_name: '',\n    loaded: __NOOP,\n    store_google: true,\n    custom_campaign_params: [],\n    save_referrer: true,\n    test: false,\n    verbose: false,\n    capture_pageview: true,\n    capture_pageleave: true, // We'll only capture pageleave events if capture_pageview is also true\n    debug: false,\n    cookie_expiration: 365,\n    upgrade: false,\n    disable_session_recording: false,\n    disable_persistence: false,\n    disable_cookie: false,\n    enable_recording_console_log: undefined, // When undefined, it falls back to the server-side setting\n    secure_cookie: window?.location?.protocol === 'https:',\n    ip: true,\n    opt_out_capturing_by_default: false,\n    opt_out_persistence_by_default: false,\n    opt_out_capturing_persistence_type: 'localStorage',\n    opt_out_capturing_cookie_prefix: null,\n    opt_in_site_apps: false,\n    property_blacklist: [],\n    respect_dnt: false,\n    sanitize_properties: null,\n    xhr_headers: {}, // { header: value, header2: value }\n    inapp_protocol: '//',\n    inapp_link_new_window: false,\n    request_batching: true,\n    properties_string_max_length: 65535,\n    session_recording: {\n        // select set of rrweb config options we expose to our users\n        // see https://github.com/rrweb-io/rrweb/blob/master/guide.md\n        blockClass: 'ph-no-capture',\n        blockSelector: null,\n        ignoreClass: 'ph-ignore-input',\n        maskAllInputs: true,\n        maskInputOptions: {},\n        maskInputFn: null,\n        slimDOMOptions: {},\n        collectFonts: false,\n        inlineStylesheet: true,\n    },\n    mask_all_element_attributes: false,\n    mask_all_text: false,\n    advanced_disable_decide: false,\n    advanced_disable_toolbar_metrics: false,\n    on_xhr_error: (req) => {\n        const error = 'Bad HTTP status: ' + req.status + ' ' + req.statusText\n        console.error(error)\n    },\n    get_device_id: (uuid) => uuid,\n    // Used for internal testing\n    _onCapture: __NOOP,\n    _capture_metrics: false,\n    capture_performance: undefined,\n    name: 'posthog',\n    callback_fn: 'posthog._jsc',\n    bootstrap: {},\n    disable_compression: false,\n})\n\n/**\n * create_phlib(token:string, config:object, name:string)\n *\n * This function is used by the init method of PostHogLib objects\n * as well as the main initializer at the end of the JSLib (that\n * initializes document.posthog as well as any additional instances\n * declared before this file has loaded).\n */\nconst create_phlib = function (\n    token: string,\n    config?: Partial<PostHogConfig>,\n    name?: string,\n    createComplete?: (instance: PostHog) => void\n): PostHog {\n    let instance: PostHog\n    const target =\n        name === PRIMARY_INSTANCE_NAME || !posthog_master ? posthog_master : name ? posthog_master[name] : undefined\n    const callbacksHandled = {\n        initComplete: false,\n        syncCode: false,\n    }\n    const handleCallback = (callbackName: keyof typeof callbacksHandled) => (instance: PostHog) => {\n        if (!callbacksHandled[callbackName]) {\n            callbacksHandled[callbackName] = true\n            if (callbacksHandled.initComplete && callbacksHandled.syncCode) {\n                createComplete?.(instance)\n            }\n        }\n    }\n\n    if (target && init_type === InitType.INIT_MODULE) {\n        instance = target as any\n    } else {\n        if (target && !_isArray(target)) {\n            console.error('You have already initialized ' + name)\n            // TODO: throw something instead?\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            return\n        }\n        instance = new PostHog()\n    }\n\n    instance._init(token, config, name, handleCallback('initComplete'))\n    instance.toolbar.maybeLoadToolbar()\n\n    instance.sessionRecording = new SessionRecording(instance)\n    instance.sessionRecording.startRecordingIfEnabled()\n\n    instance.webPerformance = new WebPerformanceObserver(instance)\n    instance.webPerformance.startObservingIfEnabled()\n\n    instance.exceptionAutocapture = new ExceptionObserver(instance)\n\n    instance.__autocapture = instance.get_config('autocapture')\n    autocapture._setIsAutocaptureEnabled(instance)\n    if (autocapture._isAutocaptureEnabled) {\n        instance.__autocapture = instance.get_config('autocapture')\n        const num_buckets = 100\n        const num_enabled_buckets = 100\n        if (!autocapture.enabledForProject(instance.get_config('token'), num_buckets, num_enabled_buckets)) {\n            instance.__autocapture = false\n            logger.log('Not in active bucket: disabling Automatic Event Collection.')\n        } else if (!autocapture.isBrowserSupported()) {\n            instance.__autocapture = false\n            logger.log('Disabling Automatic Event Collection because this browser is not supported')\n        } else {\n            autocapture.init(instance)\n        }\n    }\n\n    // if any instance on the page has debug = true, we set the\n    // global debug to be true\n    Config.DEBUG = Config.DEBUG || instance.get_config('debug')\n\n    // if target is not defined, we called init after the lib already\n    // loaded, so there won't be an array of things to execute\n    if (typeof target !== 'undefined' && _isArray(target)) {\n        // Crunch through the people queue first - we queue this data up &\n        // flush on identify, so it's better to do all these operations first\n        instance._execute_array.call(instance.people, (target as any).people)\n        instance._execute_array(target)\n    }\n\n    handleCallback('syncCode')(instance)\n    return instance\n}\n\n/**\n * PostHog Library Object\n * @constructor\n */\nexport class PostHog {\n    __loaded: boolean\n    __loaded_recorder_version: 'v1' | 'v2' | undefined // flag that keeps track of which version of recorder is loaded\n    config: PostHogConfig\n\n    persistence: PostHogPersistence\n    sessionPersistence: PostHogPersistence\n    sessionManager: SessionIdManager\n    pageViewIdManager: PageViewIdManager\n    people: PostHogPeople\n    featureFlags: PostHogFeatureFlags\n    feature_flags: PostHogFeatureFlags\n    toolbar: Toolbar\n    sessionRecording: SessionRecording | undefined\n    webPerformance: WebPerformanceObserver | undefined\n    exceptionAutocapture: ExceptionObserver | undefined\n\n    _captureMetrics: CaptureMetrics\n    _requestQueue: RequestQueue\n    _retryQueue: RetryQueue\n\n    _triggered_notifs: any\n    compression: Partial<Record<Compression, boolean>>\n    _jsc: JSC\n    __captureHooks: ((eventName: string) => void)[]\n    __request_queue: [url: string, data: Record<string, any>, options: XHROptions, callback?: RequestCallback][]\n    __autocapture: boolean | AutocaptureConfig | undefined\n    decideEndpointWasHit: boolean\n\n    SentryIntegration: typeof SentryIntegration\n    segmentIntegration: () => any\n\n    constructor() {\n        this.config = defaultConfig()\n        this.compression = {}\n        this.decideEndpointWasHit = false\n        this.SentryIntegration = SentryIntegration\n        this.segmentIntegration = () => createSegmentIntegration(this)\n        this.__captureHooks = []\n        this.__request_queue = []\n        this.__loaded = false\n        this.__loaded_recorder_version = undefined\n        this.__autocapture = undefined\n        this._jsc = function () {} as JSC\n        this.people = new PostHogPeople(this)\n        this.featureFlags = new PostHogFeatureFlags(this)\n        this.feature_flags = this.featureFlags\n        this.toolbar = new Toolbar(this)\n        this.pageViewIdManager = new PageViewIdManager()\n\n        // these are created in _init() after we have the config\n        this._captureMetrics = undefined as any\n        this._requestQueue = undefined as any\n        this._retryQueue = undefined as any\n        this.persistence = undefined as any\n        this.sessionPersistence = undefined as any\n        this.sessionManager = undefined as any\n    }\n\n    // Initialization methods\n\n    /**\n     * This function initializes a new instance of the PostHog capturing object.\n     * All new instances are added to the main posthog object as sub properties (such as\n     * posthog.library_name) and also returned by this function. To define a\n     * second instance on the page, you would call:\n     *\n     *     posthog.init('new token', { your: 'config' }, 'library_name');\n     *\n     * and use it like so:\n     *\n     *     posthog.library_name.capture(...);\n     *\n     * @param {String} token   Your PostHog API token\n     * @param {Object} [config]  A dictionary of config options to override. <a href=\"https://github.com/posthog/posthog-js/blob/6e0e873/src/posthog-core.js#L57-L91\">See a list of default config options</a>.\n     * @param {String} [name]    The name for the new posthog instance that you want created\n     */\n    init(token: string, config?: Partial<PostHogConfig>, name?: string): PostHog | void {\n        if (_isUndefined(name)) {\n            console.error('You must name your new library: init(token, config, name)')\n            return\n        }\n        if (name === PRIMARY_INSTANCE_NAME) {\n            console.error('You must initialize the main posthog object right after you include the PostHog js snippet')\n            return\n        }\n\n        const instance: PostHog = create_phlib(token, config, name, (instance: PostHog) => {\n            posthog_master[name] = instance\n            instance._loaded()\n        })\n        posthog_master[name] = instance\n\n        return instance\n    }\n\n    // posthog._init(token:string, config:object, name:string)\n    //\n    // This function sets up the current instance of the posthog\n    // library.  The difference between this method and the init(...)\n    // method is this one initializes the actual instance, whereas the\n    // init(...) method sets up a new library and calls _init on it.\n    //\n    // Note that there are operations that can be asynchronous, so we\n    // accept a callback that is called when all the asynchronous work\n    // is done. Note that we do not use promises because we want to be\n    // IE11 compatible. We could use polyfills, which would make the\n    // code a bit cleaner, but will add some overhead.\n    //\n    _init(\n        token: string,\n        config: Partial<PostHogConfig> = {},\n        name?: string,\n        initComplete?: (instance: PostHog) => void\n    ): void {\n        this.__loaded = true\n        this.config = {} as PostHogConfig // will be set right below\n        this._triggered_notifs = []\n\n        // To avoid using Promises and their helper functions, we instead keep\n        // track of which callbacks have been called, and then call initComplete\n        // when all of them have been called. To add additional async code, add\n        // to `callbacksHandled` and pass updateInitComplete as a callback to\n        // the async code.\n        const callbacksHandled = { segmentRegister: false, syncCode: false }\n        const updateInitComplete = (callbackName: keyof typeof callbacksHandled) => () => {\n            // Update the register of callbacks that have been called, and if\n            // they have all been called, then we are ready to call\n            // initComplete.\n            if (!callbacksHandled[callbackName]) {\n                callbacksHandled[callbackName] = true\n                if (callbacksHandled.segmentRegister && callbacksHandled.syncCode) {\n                    initComplete?.(this)\n                }\n            }\n        }\n\n        this.set_config(\n            _extend({}, defaultConfig(), config, {\n                name: name,\n                token: token,\n                callback_fn: (name === PRIMARY_INSTANCE_NAME ? name : PRIMARY_INSTANCE_NAME + '.' + name) + '._jsc',\n            })\n        )\n\n        this._jsc = function () {} as JSC\n\n        // Check if recorder.js is already loaded\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        if (window?.rrweb?.record || window?.rrwebRecord) {\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            this.__loaded_recorder_version = window?.rrweb?.version\n        }\n\n        this._captureMetrics = new CaptureMetrics(this.get_config('_capture_metrics'))\n        this._requestQueue = new RequestQueue(this._captureMetrics, this._handle_queued_event.bind(this))\n        this._retryQueue = new RetryQueue(this._captureMetrics, this.get_config('on_xhr_error'))\n        this.__captureHooks = []\n        this.__request_queue = []\n\n        this.persistence = new PostHogPersistence(this.config)\n        this.sessionManager = new SessionIdManager(this.config, this.persistence)\n        this.sessionPersistence =\n            this.config.persistence === 'sessionStorage'\n                ? this.persistence\n                : new PostHogPersistence({ ...this.config, persistence: 'sessionStorage' })\n\n        this._gdpr_init()\n\n        if (config.segment) {\n            // Use segments anonymousId instead\n            this.config.get_device_id = () => config.segment.user().anonymousId()\n\n            // If a segment user ID exists, set it as the distinct_id\n            if (config.segment.user().id()) {\n                this.register({\n                    distinct_id: config.segment.user().id(),\n                })\n                this.persistence.set_user_state('identified')\n            }\n\n            config.segment.register(this.segmentIntegration()).then(updateInitComplete('segmentRegister'))\n        } else {\n            updateInitComplete('segmentRegister')()\n        }\n\n        if (config.bootstrap?.distinctID !== undefined) {\n            const uuid = this.get_config('get_device_id')(_UUID())\n            const deviceID = config.bootstrap?.isIdentifiedID ? uuid : config.bootstrap.distinctID\n            this.persistence.set_user_state(config.bootstrap?.isIdentifiedID ? 'identified' : 'anonymous')\n            this.register({\n                distinct_id: config.bootstrap.distinctID,\n                $device_id: deviceID,\n            })\n        }\n\n        if (this._hasBootstrappedFeatureFlags()) {\n            const activeFlags = Object.keys(config.bootstrap?.featureFlags || {})\n                .filter((flag) => !!config.bootstrap?.featureFlags?.[flag])\n                .reduce(\n                    (res: Record<string, string | boolean>, key) => (\n                        (res[key] = config.bootstrap?.featureFlags?.[key] || false), res\n                    ),\n                    {}\n                )\n            const featureFlagPayloads = Object.keys(config.bootstrap?.featureFlagPayloads || {})\n                .filter((key) => activeFlags[key])\n                .reduce((res: Record<string, JsonType>, key) => {\n                    if (config.bootstrap?.featureFlagPayloads?.[key]) {\n                        res[key] = config.bootstrap?.featureFlagPayloads?.[key]\n                    }\n                    return res\n                }, {})\n\n            this.featureFlags.receivedFeatureFlags({ featureFlags: activeFlags, featureFlagPayloads })\n        }\n\n        if (!this.get_distinct_id()) {\n            // There is no need to set the distinct id\n            // or the device id if something was already stored\n            // in the persitence\n            const uuid = this.get_config('get_device_id')(_UUID())\n            this.register_once(\n                {\n                    distinct_id: uuid,\n                    $device_id: uuid,\n                },\n                ''\n            )\n            // distinct id == $device_id is a proxy for anonymous user\n            this.persistence.set_user_state('anonymous')\n        }\n        // Set up event handler for pageleave\n        // Use `onpagehide` if available, see https://calendar.perfplanet.com/2020/beaconing-in-practice/#beaconing-reliability-avoiding-abandons\n        window.addEventListener &&\n            window.addEventListener('onpagehide' in self ? 'pagehide' : 'unload', this._handle_unload.bind(this))\n\n        // Make sure that we also call the initComplete callback at the end of\n        // the synchronous code as well.\n        updateInitComplete('syncCode')()\n    }\n\n    // Private methods\n\n    _loaded(): void {\n        // Pause `reloadFeatureFlags` calls in config.loaded callback.\n        // These feature flags are loaded in the decide call made right\n        // afterwards\n        this.featureFlags.setReloadingPaused(true)\n\n        try {\n            this.get_config('loaded')(this)\n        } catch (err) {\n            console.error('`loaded` function failed', err)\n        }\n\n        this._start_queue_if_opted_in()\n\n        // this happens after so a user can call identify in\n        // the loaded callback\n        if (this.get_config('capture_pageview')) {\n            this.capture('$pageview', {}, { send_instantly: true })\n        }\n\n        // Call decide to get what features are enabled and other settings.\n        // As a reminder, if the /decide endpoint is disabled, feature flags, toolbar, session recording, autocapture,\n        // and compression will not be available.\n        if (!this.get_config('advanced_disable_decide')) {\n            new Decide(this).call()\n        }\n\n        this.featureFlags.resetRequestQueue()\n        this.featureFlags.setReloadingPaused(false)\n    }\n\n    _start_queue_if_opted_in(): void {\n        if (!this.has_opted_out_capturing()) {\n            if (this.get_config('request_batching')) {\n                this._requestQueue.poll()\n            }\n        }\n    }\n\n    _dom_loaded(): void {\n        if (!this.has_opted_out_capturing()) {\n            _eachArray(this.__request_queue, (item) => {\n                this._send_request(...item)\n            })\n        }\n\n        this.__request_queue = []\n\n        this._start_queue_if_opted_in()\n    }\n\n    /**\n     * _prepare_callback() should be called by callers of _send_request for use\n     * as the callback argument.\n     *\n     * If there is no callback, this returns null.\n     * If we are going to make XHR/XDR requests, this returns a function.\n     * If we are going to use script tags, this returns a string to use as the\n     * callback GET param.\n     */\n    // TODO: get rid of the \"| string\"\n    _prepare_callback(callback?: RequestCallback, data?: Properties): RequestCallback | null | string {\n        if (_isUndefined(callback)) {\n            return null\n        }\n\n        if (USE_XHR) {\n            return function (response) {\n                callback(response, data)\n            }\n        } else {\n            // if the user gives us a callback, we store as a random\n            // property on this instances jsc function and update our\n            // callback string to reflect that.\n            const jsc = this._jsc\n            const randomized_cb = '' + Math.floor(Math.random() * 100000000)\n            const callback_string = this.get_config('callback_fn') + '[' + randomized_cb + ']'\n            jsc[randomized_cb] = function (response: any) {\n                delete jsc[randomized_cb]\n                callback(response, data)\n            }\n            return callback_string\n        }\n    }\n\n    _handle_unload(): void {\n        if (!this.get_config('request_batching')) {\n            if (this.get_config('capture_pageview') && this.get_config('capture_pageleave')) {\n                this.capture('$pageleave', null, { transport: 'sendBeacon' })\n            }\n            return\n        }\n\n        if (this.get_config('capture_pageview') && this.get_config('capture_pageleave')) {\n            this.capture('$pageleave')\n        }\n        if (this.get_config('_capture_metrics')) {\n            this._requestQueue.updateUnloadMetrics()\n            this.capture('$capture_metrics', this._captureMetrics.metrics)\n        }\n        this._requestQueue.unload()\n        this._retryQueue.unload()\n    }\n\n    _handle_queued_event(url: string, data: Record<string, any>, options?: XHROptions): void {\n        const jsonData = JSON.stringify(data)\n        this.__compress_and_send_json_request(url, jsonData, options || __NOOPTIONS, __NOOP)\n    }\n\n    __compress_and_send_json_request(\n        url: string,\n        jsonData: string,\n        options: XHROptions,\n        callback?: RequestCallback\n    ): void {\n        const [data, _options] = compressData(decideCompression(this.compression), jsonData, options)\n        this._send_request(url, data, _options, callback)\n    }\n\n    _send_request(url: string, data: Record<string, any>, options: XHROptions, callback?: RequestCallback): void {\n        if (ENQUEUE_REQUESTS) {\n            this.__request_queue.push([url, data, options, callback])\n            return\n        }\n\n        const DEFAULT_OPTIONS = {\n            method: this.get_config('api_method'),\n            transport: this.get_config('api_transport'),\n            verbose: this.get_config('verbose'),\n        }\n\n        options = _extend(DEFAULT_OPTIONS, options || {})\n        if (!USE_XHR) {\n            options.method = 'GET'\n        }\n\n        const useSendBeacon = 'sendBeacon' in window.navigator && options.transport === 'sendBeacon'\n        url = addParamsToURL(url, options.urlQueryArgs || {}, {\n            ip: this.get_config('ip'),\n        })\n\n        if (useSendBeacon) {\n            // beacon documentation https://w3c.github.io/beacon/\n            // beacons format the message and use the type property\n            // also no need to try catch as sendBeacon does not report errors\n            //   and is defined as best effort attempt\n            try {\n                window.navigator.sendBeacon(url, encodePostData(data, { ...options, sendBeacon: true }))\n            } catch (e) {\n                if (this.get_config('debug')) {\n                    console.error(e)\n                }\n            }\n        } else if (USE_XHR) {\n            try {\n                xhr({\n                    url: url,\n                    data: data,\n                    headers: this.get_config('xhr_headers'),\n                    options: options,\n                    captureMetrics: this._captureMetrics,\n                    callback,\n                    retriesPerformedSoFar: 0,\n                    retryQueue: this._retryQueue,\n                    onXHRError: this.get_config('on_xhr_error'),\n                })\n            } catch (e) {\n                console.error(e)\n            }\n        } else {\n            const script = document.createElement('script')\n            script.type = 'text/javascript'\n            script.async = true\n            script.defer = true\n            script.src = url\n            const s = document.getElementsByTagName('script')[0]\n            s.parentNode?.insertBefore(script, s)\n        }\n    }\n\n    /**\n     * _execute_array() deals with processing any posthog function\n     * calls that were called before the PostHog library were loaded\n     * (and are thus stored in an array so they can be called later)\n     *\n     * Note: we fire off all the posthog function calls && user defined\n     * functions BEFORE we fire off posthog capturing calls. This is so\n     * identify/register/set_config calls can properly modify early\n     * capturing calls.\n     *\n     * @param {Array} array\n     */\n    _execute_array(array: SnippetArrayItem[]): void {\n        let fn_name\n        const alias_calls: SnippetArrayItem[] = []\n        const other_calls: SnippetArrayItem[] = []\n        const capturing_calls: SnippetArrayItem[] = []\n        _eachArray(array, (item) => {\n            if (item) {\n                fn_name = item[0]\n                if (_isArray(fn_name)) {\n                    capturing_calls.push(item) // chained call e.g. posthog.get_group().set()\n                } else if (typeof item === 'function') {\n                    ;(item as any).call(this)\n                } else if (_isArray(item) && fn_name === 'alias') {\n                    alias_calls.push(item)\n                } else if (\n                    _isArray(item) &&\n                    fn_name.indexOf('capture') !== -1 &&\n                    typeof (this as any)[fn_name] === 'function'\n                ) {\n                    capturing_calls.push(item)\n                } else {\n                    other_calls.push(item)\n                }\n            }\n        })\n\n        const execute = function (calls: SnippetArrayItem[], thisArg: any) {\n            _eachArray(\n                calls,\n                function (item) {\n                    if (_isArray(item[0])) {\n                        // chained call\n                        let caller = thisArg\n                        _each(item, function (call) {\n                            caller = caller[call[0]].apply(caller, call.slice(1))\n                        })\n                    } else {\n                        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n                        // @ts-ignore\n                        this[item[0]].apply(this, item.slice(1))\n                    }\n                },\n                thisArg\n            )\n        }\n\n        execute(alias_calls, this)\n        execute(other_calls, this)\n        execute(capturing_calls, this)\n    }\n\n    _hasBootstrappedFeatureFlags(): boolean {\n        return (\n            (this.config.bootstrap?.featureFlags && Object.keys(this.config.bootstrap?.featureFlags).length > 0) ||\n            false\n        )\n    }\n\n    /**\n     * push() keeps the standard async-array-push\n     * behavior around after the lib is loaded.\n     * This is only useful for external integrations that\n     * do not wish to rely on our convenience methods\n     * (created in the snippet).\n     *\n     * ### Usage:\n     *     posthog.push(['register', { a: 'b' }]);\n     *\n     * @param {Array} item A [function_name, args...] array to be executed\n     */\n    push(item: SnippetArrayItem): void {\n        this._execute_array([item])\n    }\n\n    /*\n     * PostHog supports exception autocapture, however, this function\n     * is used to manually capture an exception\n     * and can be used to add more context to that exception\n     *\n     * Properties passed as the second option will be merged with the properties\n     * of the exception event.\n     * Where there is a key in both generated exception and passed properties,\n     * the generated exception property takes precedence.\n     */\n    captureException(exception: Error, properties?: Properties): void {\n        this.exceptionAutocapture?.captureException(\n            [exception.name, undefined, undefined, undefined, exception],\n            properties\n        )\n    }\n\n    /**\n     * Capture an event. This is the most important and\n     * frequently used PostHog function.\n     *\n     * ### Usage:\n     *\n     *     // capture an event named 'Registered'\n     *     posthog.capture('Registered', {'Gender': 'Male', 'Age': 21});\n     *\n     *     // capture an event using navigator.sendBeacon\n     *     posthog.capture('Left page', {'duration_seconds': 35}, {transport: 'sendBeacon'});\n     *\n     * @param {String} event_name The name of the event. This can be anything the user does - 'Button Click', 'Sign Up', 'Item Purchased', etc.\n     * @param {Object} [properties] A set of properties to include with the event you're sending. These describe the user who did the event or details about the event itself.\n     * @param {Object} [options] Optional configuration for this capture request.\n     * @param {String} [options.transport] Transport method for network request ('XHR' or 'sendBeacon').\n     * @param {Date} [options.timestamp] Timestamp is a Date object. If not set, it'll automatically be set to the current time.\n     */\n    capture(\n        event_name: string,\n        properties?: Properties | null,\n        options: CaptureOptions = __NOOPTIONS\n    ): CaptureResult | void {\n        // While developing, a developer might purposefully _not_ call init(),\n        // in this case, we would like capture to be a noop.\n        if (!this.__loaded) {\n            return\n        }\n\n        if (userOptedOut(this, false)) {\n            return\n        }\n\n        this._captureMetrics.incr('capture')\n        if (event_name === '$snapshot') {\n            this._captureMetrics.incr('snapshot')\n        }\n\n        options = options || __NOOPTIONS\n        const transport = options['transport'] // external API, don't minify 'transport' prop\n        if (transport) {\n            options.transport = transport // 'transport' prop name can be minified internally\n        }\n\n        // typing doesn't prevent interesting data\n        if (_isUndefined(event_name) || typeof event_name !== 'string') {\n            console.error('No event name provided to posthog.capture')\n            return\n        }\n\n        if (_isBlockedUA(userAgent)) {\n            return\n        }\n\n        // update persistence\n        this.sessionPersistence.update_search_keyword()\n\n        if (this.get_config('store_google')) {\n            this.sessionPersistence.update_campaign_params()\n        }\n        if (this.get_config('save_referrer')) {\n            this.sessionPersistence.update_referrer_info()\n        }\n\n        let data: CaptureResult = {\n            event: event_name,\n            properties: this._calculate_event_properties(event_name, properties || {}),\n        }\n\n        if (event_name === '$identify') {\n            data['$set'] = options['$set']\n            data['$set_once'] = options['$set_once']\n        }\n\n        data = _copyAndTruncateStrings(\n            data,\n            options._noTruncate ? null : this.get_config('properties_string_max_length')\n        )\n        data.timestamp = options.timestamp || new Date()\n\n        if (this.get_config('debug')) {\n            logger.log('PostHog.js send', data)\n        }\n        const jsonData = JSON.stringify(data)\n\n        const url = this.get_config('api_host') + (options.endpoint || '/e/')\n\n        const has_unique_traits = options !== __NOOPTIONS\n\n        if (\n            this.get_config('request_batching') &&\n            (!has_unique_traits || options._batchKey) &&\n            !options.send_instantly\n        ) {\n            this._requestQueue.enqueue(url, data, options)\n        } else {\n            this.__compress_and_send_json_request(url, jsonData, options)\n        }\n\n        this._invokeCaptureHooks(event_name, data)\n\n        return data\n    }\n\n    _addCaptureHook(callback: (eventName: string) => void): void {\n        this.__captureHooks.push(callback)\n    }\n\n    _invokeCaptureHooks(eventName: string, eventData: CaptureResult): void {\n        this.config._onCapture(eventName, eventData)\n        _each(this.__captureHooks, (callback) => callback(eventName))\n    }\n\n    _calculate_event_properties(event_name: string, event_properties: Properties): Properties {\n        // set defaults\n        const start_timestamp = this.persistence.remove_event_timer(event_name)\n        let properties = { ...event_properties }\n        properties['token'] = this.get_config('token')\n\n        if (event_name === '$snapshot') {\n            const persistenceProps = { ...this.persistence.properties(), ...this.sessionPersistence.properties() }\n            properties['distinct_id'] = persistenceProps.distinct_id\n            return properties\n        }\n\n        const infoProperties = _info.properties()\n\n        if (this.sessionManager) {\n            const { sessionId, windowId } = this.sessionManager.checkAndGetSessionAndWindowId()\n            properties['$session_id'] = sessionId\n            properties['$window_id'] = windowId\n        }\n\n        if (this.webPerformance?.isEnabled) {\n            if (event_name === '$pageview') {\n                this.pageViewIdManager.onPageview()\n            }\n            properties = _extend(properties, { $pageview_id: this.pageViewIdManager.getPageViewId() })\n        }\n\n        if (event_name === '$performance_event') {\n            const persistenceProps = this.persistence.properties()\n            // Early exit for $performance_event as we only need session and $current_url\n            properties['distinct_id'] = persistenceProps.distinct_id\n            properties['$current_url'] = infoProperties.$current_url\n            return properties\n        }\n\n        // set $duration if time_event was previously called for this event\n        if (typeof start_timestamp !== 'undefined') {\n            const duration_in_ms = new Date().getTime() - start_timestamp\n            properties['$duration'] = parseFloat((duration_in_ms / 1000).toFixed(3))\n        }\n\n        // note: extend writes to the first object, so lets make sure we\n        // don't write to the persistence properties object and info\n        // properties object by passing in a new object\n\n        // update properties with pageview info and super-properties\n        properties = _extend(\n            {},\n            _info.properties(),\n            this.persistence.properties(),\n            this.sessionPersistence.properties(),\n            properties\n        )\n\n        const property_blacklist = this.get_config('property_blacklist')\n        if (_isArray(property_blacklist)) {\n            _each(property_blacklist, function (blacklisted_prop) {\n                delete properties[blacklisted_prop]\n            })\n        } else {\n            console.error('Invalid value for property_blacklist config: ' + property_blacklist)\n        }\n\n        const sanitize_properties = this.get_config('sanitize_properties')\n        if (sanitize_properties) {\n            properties = sanitize_properties(properties, event_name)\n        }\n\n        return properties\n    }\n\n    /**\n     * Register a set of super properties, which are included with all\n     * events. This will overwrite previous super property values, except\n     * for session properties (see `register_for_session(properties)`).\n     *\n     * ### Usage:\n     *\n     *     // register 'Gender' as a super property\n     *     posthog.register({'Gender': 'Female'});\n     *\n     *     // register several super properties when a user signs up\n     *     posthog.register({\n     *         'Email': 'jdoe@example.com',\n     *         'Account Type': 'Free'\n     *     });\n     *\n     *     // Display the properties\n     *     console.log(posthog.persistence.properties())\n     *\n     * @param {Object} properties An associative array of properties to store about the user\n     * @param {Number} [days] How many days since the user's last visit to store the super properties\n     */\n    register(properties: Properties, days?: number): void {\n        this.persistence.register(properties, days)\n    }\n\n    /**\n     * Register a set of super properties only once. These will not\n     * overwrite previous super property values, unlike register().\n     *\n     * ### Usage:\n     *\n     *     // register a super property for the first time only\n     *     posthog.register_once({\n     *         'First Login Date': new Date().toISOString()\n     *     });\n     *\n     *     // Display the properties\n     *     console.log(posthog.persistence.properties())\n     *\n     * ### Notes:\n     *\n     * If default_value is specified, current super properties\n     * with that value will be overwritten.\n     *\n     * @param {Object} properties An associative array of properties to store about the user\n     * @param {*} [default_value] Value to override if already set in super properties (ex: 'False') Default: 'None'\n     * @param {Number} [days] How many days since the users last visit to store the super properties\n     */\n    register_once(properties: Properties, default_value?: Property, days?: number): void {\n        this.persistence.register_once(properties, default_value, days)\n    }\n\n    /**\n     * Register a set of super properties, which are included with all events, but only\n     * for THIS SESSION. These will overwrite all other super property values.\n     *\n     * Unlike regular super properties, which last in LocalStorage for a long time,\n     * session super properties get cleared after a session ends.\n     *\n     * ### Usage:\n     *\n     *     // register on all events this session\n     *     posthog.register_for_session({'referer': customGetReferer()});\n     *\n     *     // register several session super properties when a user signs up\n     *     posthog.register_for_session({\n     *         'selectedPlan': 'pro',\n     *         'completedSteps': 4,\n     *     });\n     *\n     *     // Display the properties\n     *     console.log(posthog.sessionPersistence.properties())\n     *\n     * @param {Object} properties An associative array of properties to store about the user\n     */\n    register_for_session(properties: Properties): void {\n        this.sessionPersistence.register(properties)\n    }\n\n    /**\n     * Delete a super property stored with the current user.\n     *\n     * @param {String} property The name of the super property to remove\n     */\n    unregister(property: string): void {\n        this.persistence.unregister(property)\n    }\n\n    /**\n     * Delete a session super property stored with the current user.\n     *\n     * @param {String} property The name of the session super property to remove\n     */\n    unregister_for_session(property: string): void {\n        this.sessionPersistence.unregister(property)\n    }\n\n    _register_single(prop: string, value: Property) {\n        this.register({ [prop]: value })\n    }\n\n    /*\n     * Get feature flag value for user (supports multivariate flags).\n     *\n     * ### Usage:\n     *\n     *     if(posthog.getFeatureFlag('beta-feature') === 'some-value') { // do something }\n     *\n     * @param {Object|String} prop Key of the feature flag.\n     * @param {Object|String} options (optional) If {send_event: false}, we won't send an $feature_flag_call event to PostHog.\n     */\n    getFeatureFlag(key: string, options?: { send_event?: boolean }): boolean | string | undefined {\n        return this.featureFlags.getFeatureFlag(key, options)\n    }\n\n    /*\n     * Get feature flag payload value matching key for user (supports multivariate flags).\n     *\n     * ### Usage:\n     *\n     *     if(posthog.getFeatureFlag('beta-feature') === 'some-value') {\n     *          const someValue = posthog.getFeatureFlagPayload('beta-feature')\n     *          // do something\n     *     }\n     *\n     * @param {Object|String} prop Key of the feature flag.\n     */\n    getFeatureFlagPayload(key: string): JsonType {\n        const payload = this.featureFlags.getFeatureFlagPayload(key)\n        try {\n            return JSON.parse(payload as any)\n        } catch {\n            return payload\n        }\n    }\n\n    /*\n     * See if feature flag is enabled for user.\n     *\n     * ### Usage:\n     *\n     *     if(posthog.isFeatureEnabled('beta-feature')) { // do something }\n     *\n     * @param {Object|String} prop Key of the feature flag.\n     * @param {Object|String} options (optional) If {send_event: false}, we won't send an $feature_flag_call event to PostHog.\n     */\n    isFeatureEnabled(key: string, options?: isFeatureEnabledOptions): boolean {\n        return this.featureFlags.isFeatureEnabled(key, options)\n    }\n\n    reloadFeatureFlags(): void {\n        this.featureFlags.reloadFeatureFlags()\n    }\n\n    /** Opt the user in or out of an early access feature. */\n    updateEarlyAccessFeatureEnrollment(key: string, isEnrolled: boolean): void {\n        this.featureFlags.updateEarlyAccessFeatureEnrollment(key, isEnrolled)\n    }\n\n    /** Get the list of early access features. To check enrollment status, use `isFeatureEnabled`. */\n    getEarlyAccessFeatures(callback: EarlyAccessFeatureCallback, force_reload = false): void {\n        return this.featureFlags.getEarlyAccessFeatures(callback, force_reload)\n    }\n\n    /*\n     * Register an event listener that runs when feature flags become available or when they change.\n     * If there are flags, the listener is called immediately in addition to being called on future changes.\n     *\n     * ### Usage:\n     *\n     *     posthog.onFeatureFlags(function(featureFlags) { // do something })\n     *\n     * @param {Function} [callback] The callback function will be called once the feature flags are ready or when they are updated.\n     *                              It'll return a list of feature flags enabled for the user.\n     * @returns {Function} A function that can be called to unsubscribe the listener. Used by useEffect when the component unmounts.\n     */\n    onFeatureFlags(callback: (flags: string[], variants: Record<string, string | boolean>) => void): () => void {\n        return this.featureFlags.onFeatureFlags(callback)\n    }\n\n    /**\n     * Identify a user with a unique ID instead of a PostHog\n     * randomly generated distinct_id. If the method is never called,\n     * then unique visitors will be identified by a UUID that is generated\n     * the first time they visit the site.\n     *\n     * If user properties are passed, they are also sent to posthog.\n     *\n     * ### Usage:\n     *\n     *      posthog.identify('[user unique id]')\n     *      posthog.identify('[user unique id]', { email: 'john@example.com' })\n     *      posthog.identify('[user unique id]', {}, { referral_code: '12345' })\n     *\n     * ### Notes:\n     *\n     * You can call this function to overwrite a previously set\n     * unique ID for the current user.\n     *\n     * If the user has been identified ($user_state in persistence is set to 'identified'),\n     * then capture of $identify is skipped to avoid merging users. For example,\n     * if your system allows an admin user to impersonate another user.\n     *\n     * Then a single browser instance can have:\n     *\n     *  `identify('a') -> capture(1) -> identify('b') -> capture(2)`\n     *\n     * and capture 1 and capture 2 will have the correct distinct_id.\n     * but users a and b will NOT be merged in posthog.\n     *\n     * However, if reset is called then:\n     *\n     *  `identify('a') -> capture(1) -> reset() -> capture(2) -> identify('b') -> capture(3)`\n     *\n     * users a and b are not merged.\n     * Capture 1 is associated with user a.\n     * A new distinct id is generated for capture 2.\n     * which is merged with user b.\n     * So, capture 2 and 3 are associated with user b.\n     *\n     * If you want to merge two identified users, you can call posthog.alias\n     *\n     * @param {String} [new_distinct_id] A string that uniquely identifies a user. If not provided, the distinct_id currently in the persistent store (cookie or localStorage) will be used.\n     * @param {Object} [userPropertiesToSet] Optional: An associative array of properties to store about the user\n     * @param {Object} [userPropertiesToSetOnce] Optional: An associative array of properties to store about the user. If property is previously set, this does not override that value.\n     */\n    identify(new_distinct_id?: string, userPropertiesToSet?: Properties, userPropertiesToSetOnce?: Properties): void {\n        //if the new_distinct_id has not been set ignore the identify event\n        if (!new_distinct_id) {\n            console.error('Unique user id has not been set in posthog.identify')\n            return\n        }\n\n        this._captureMetrics.incr('identify')\n\n        const previous_distinct_id = this.get_distinct_id()\n        this.register({ $user_id: new_distinct_id })\n\n        if (!this.get_property('$device_id')) {\n            // The persisted distinct id might not actually be a device id at all\n            // it might be a distinct id of the user from before\n            const device_id = previous_distinct_id\n            this.register_once(\n                {\n                    $had_persisted_distinct_id: true,\n                    $device_id: device_id,\n                },\n                ''\n            )\n        }\n\n        // if the previous distinct id had an alias stored, then we clear it\n        if (new_distinct_id !== previous_distinct_id && new_distinct_id !== this.get_property(ALIAS_ID_KEY)) {\n            this.unregister(ALIAS_ID_KEY)\n            this.register({ distinct_id: new_distinct_id })\n        }\n\n        const isKnownAnonymous = this.persistence.get_user_state() === 'anonymous'\n\n        // send an $identify event any time the distinct_id is changing and the old ID is an anoymous ID\n        // - logic on the server will determine whether or not to do anything with it.\n        if (new_distinct_id !== previous_distinct_id && isKnownAnonymous) {\n            this.persistence.set_user_state('identified')\n            this.capture(\n                '$identify',\n                {\n                    distinct_id: new_distinct_id,\n                    $anon_distinct_id: previous_distinct_id,\n                },\n                { $set: userPropertiesToSet || {}, $set_once: userPropertiesToSetOnce || {} }\n            )\n            // let the reload feature flag request know to send this previous distinct id\n            // for flag consistency\n            this.featureFlags.setAnonymousDistinctId(previous_distinct_id)\n        } else {\n            if (userPropertiesToSet) {\n                this.people.set(userPropertiesToSet)\n            }\n            if (userPropertiesToSetOnce) {\n                this.people.set_once(userPropertiesToSetOnce)\n            }\n        }\n\n        // Reload active feature flags if the user identity changes.\n        // Note we don't reload this on property changes as these get processed async\n        if (new_distinct_id !== previous_distinct_id) {\n            this.reloadFeatureFlags()\n        }\n    }\n\n    /**\n     * Alpha feature: don't use unless you know what you're doing!\n     *\n     * Sets group analytics information for subsequent events and reloads feature flags.\n     *\n     * @param {String} groupType Group type (example: 'organization')\n     * @param {String} groupKey Group key (example: 'org::5')\n     * @param {Object} groupPropertiesToSet Optional properties to set for group\n     */\n    group(groupType: string, groupKey: string, groupPropertiesToSet?: Properties): void {\n        if (!groupType || !groupKey) {\n            console.error('posthog.group requires a group type and group key')\n            return\n        }\n\n        this._captureMetrics.incr('group')\n\n        const existingGroups = this.getGroups()\n\n        // if group key changes, remove stored group properties\n        if (existingGroups[groupType] !== groupKey) {\n            this.resetGroupPropertiesForFlags(groupType)\n        }\n\n        this.register({ $groups: { ...existingGroups, [groupType]: groupKey } })\n\n        if (groupPropertiesToSet) {\n            this.capture('$groupidentify', {\n                $group_type: groupType,\n                $group_key: groupKey,\n                $group_set: groupPropertiesToSet,\n            })\n            this.setGroupPropertiesForFlags({ [groupType]: groupPropertiesToSet })\n        }\n\n        // If groups change and no properties change, reload feature flags.\n        // The property change reload case is handled in setGroupPropertiesForFlags.\n        if (existingGroups[groupType] !== groupKey && !groupPropertiesToSet) {\n            this.reloadFeatureFlags()\n        }\n    }\n\n    /**\n     * Resets only the group properties of the user currently logged in.\n     */\n    resetGroups(): void {\n        this.register({ $groups: {} })\n        this.resetGroupPropertiesForFlags()\n\n        // If groups changed, reload feature flags.\n        this.reloadFeatureFlags()\n    }\n\n    /**\n     * Set override person properties for feature flags.\n     * This is used when dealing with new persons / where you don't want to wait for ingestion\n     * to update user properties.\n     */\n    setPersonPropertiesForFlags(properties: Properties, reloadFeatureFlags = true): void {\n        this.featureFlags.setPersonPropertiesForFlags(properties, reloadFeatureFlags)\n    }\n\n    resetPersonPropertiesForFlags(): void {\n        this.featureFlags.resetPersonPropertiesForFlags()\n    }\n\n    /**\n     * Set override group properties for feature flags.\n     * This is used when dealing with new groups / where you don't want to wait for ingestion\n     * to update properties.\n     * Takes in an object, the key of which is the group type.\n     * For example:\n     *     setGroupPropertiesForFlags({'organization': { name: 'CYZ', employees: '11' } })\n     */\n    setGroupPropertiesForFlags(properties: { [type: string]: Properties }, reloadFeatureFlags = true): void {\n        this.featureFlags.setGroupPropertiesForFlags(properties, reloadFeatureFlags)\n    }\n\n    resetGroupPropertiesForFlags(group_type?: string): void {\n        this.featureFlags.resetGroupPropertiesForFlags(group_type)\n    }\n\n    /**\n     * Clears super properties and generates a new random distinct_id for this instance.\n     * Useful for clearing data when a user logs out.\n     */\n    reset(reset_device_id?: boolean): void {\n        const device_id = this.get_property('$device_id')\n        this.persistence.clear()\n        this.sessionPersistence.clear()\n        this.persistence.set_user_state('anonymous')\n        this.sessionManager.resetSessionId()\n        const uuid = this.get_config('get_device_id')(_UUID())\n        this.register_once(\n            {\n                distinct_id: uuid,\n                $device_id: reset_device_id ? uuid : device_id,\n            },\n            ''\n        )\n    }\n\n    /**\n     * Returns the current distinct id of the user. This is either the id automatically\n     * generated by the library or the id that has been passed by a call to identify().\n     *\n     * ### Notes:\n     *\n     * get_distinct_id() can only be called after the PostHog library has finished loading.\n     * init() has a loaded function available to handle this automatically. For example:\n     *\n     *     // set distinct_id after the posthog library has loaded\n     *     posthog.init('YOUR PROJECT TOKEN', {\n     *         loaded: function(posthog) {\n     *             distinct_id = posthog.get_distinct_id();\n     *         }\n     *     });\n     */\n    get_distinct_id(): string {\n        return this.get_property('distinct_id')\n    }\n\n    getGroups(): Record<string, any> {\n        return this.get_property('$groups') || {}\n    }\n\n    /**\n     * Returns the current session_id.\n     *\n     * NOTE: This should only be used for informative purposes.\n     * Any actual internal use case for the session_id should be handled by the sessionManager.\n     */\n\n    get_session_id(): string {\n        return this.sessionManager.checkAndGetSessionAndWindowId(true).sessionId\n    }\n\n    /**\n     * Returns the Replay url for the current session.\n     *\n     * @param options Options for the url\n     * @param options.withTimestamp Whether to include the timestamp in the url (defaults to false)\n     * @param options.timestampLookBack How many seconds to look back for the timestamp (defaults to 10)\n     */\n    get_session_replay_url(options?: { withTimestamp?: boolean; timestampLookBack?: number }): string {\n        const host = this.config.ui_host || this.config.api_host\n        let url = host + '/replay/' + this.get_session_id()\n        if (options?.withTimestamp && this.sessionManager._sessionStartTimestamp) {\n            const LOOK_BACK = options.timestampLookBack ?? 10\n            if (!this.sessionManager._sessionStartTimestamp) {\n                return url\n            }\n            const recordingStartTime = Math.max(\n                Math.floor((new Date().getTime() - (this.sessionManager._sessionStartTimestamp || 0)) / 1000) -\n                    LOOK_BACK,\n                0\n            )\n            url += `?t=${recordingStartTime}`\n        }\n\n        return url\n    }\n\n    /**\n     * Create an alias, which PostHog will use to link two distinct_ids going forward (not retroactively).\n     * Multiple aliases can map to the same original ID, but not vice-versa. Aliases can also be chained - the\n     * following is a valid scenario:\n     *\n     *     posthog.alias('new_id', 'existing_id');\n     *     ...\n     *     posthog.alias('newer_id', 'new_id');\n     *\n     * If the original ID is not passed in, we will use the current distinct_id - probably the auto-generated GUID.\n     *\n     * ### Notes:\n     *\n     * The best practice is to call alias() when a unique ID is first created for a user\n     * (e.g., when a user first registers for an account and provides an email address).\n     * alias() should never be called more than once for a given user, except to\n     * chain a newer ID to a previously new ID, as described above.\n     *\n     * @param {String} alias A unique identifier that you want to use for this user in the future.\n     * @param {String} [original] The current identifier being used for this user.\n     */\n    alias(alias: string, original?: string): CaptureResult | void | number {\n        // If the $people_distinct_id key exists in persistence, there has been a previous\n        // posthog.people.identify() call made for this user. It is VERY BAD to make an alias with\n        // this ID, as it will duplicate users.\n        if (alias === this.get_property(PEOPLE_DISTINCT_ID_KEY)) {\n            logger.critical('Attempting to create alias for existing People user - aborting.')\n            return -2\n        }\n\n        if (_isUndefined(original)) {\n            original = this.get_distinct_id()\n        }\n        if (alias !== original) {\n            this._register_single(ALIAS_ID_KEY, alias)\n            return this.capture('$create_alias', { alias: alias, distinct_id: original })\n        } else {\n            console.error('alias matches current distinct_id - skipping api call.')\n            this.identify(alias)\n            return -1\n        }\n    }\n\n    /**\n     * Update the configuration of a posthog library instance.\n     *\n     * The default config is:\n     *\n     *     {\n     *       // PostHog API host\n     *       api_host: 'https://app.posthog.com',\n     *\n     *       // HTTP method for capturing requests\n     *       api_method: 'POST'\n     *\n     *       // PostHog web app host, currently only used by the Sentry integration.\n     *       // This will only be different from api_host when using a reverse-proxied API host \u2013 in that case\n     *       // the original web app host needs to be passed here so that links to the web app are still convenient.\n     *       ui_host: 'https://app.posthog.com',\n     *\n     *       // Automatically capture clicks, form submissions and change events\n     *       autocapture: true\n     *\n     *       // Capture rage clicks\n     *       rageclick: true\n     *\n     *       // transport for sending requests ('XHR' or 'sendBeacon')\n     *       // NB: sendBeacon should only be used for scenarios such as\n     *       // page unload where a \"best-effort\" attempt to send is\n     *       // acceptable; the sendBeacon API does not support callbacks\n     *       // or any way to know the result of the request. PostHog\n     *       // capturing via sendBeacon will not support any event-\n     *       // batching or retry mechanisms.\n     *       api_transport: 'XHR'\n     *\n     *       // super properties cookie expiration (in days)\n     *       cookie_expiration: 365\n     *\n     *       // super properties span subdomains\n     *       cross_subdomain_cookie: true\n     *\n     *       // debug mode\n     *       debug: false\n     *\n     *       // if this is true, the posthog cookie or localStorage entry\n     *       // will be deleted, and no user persistence will take place\n     *       disable_persistence: false\n     *\n     *       // if this is true, PostHog will automatically determine\n     *       // City, Region and Country data using the IP address of\n     *       //the client\n     *       ip: true\n     *\n     *       // opt users out of capturing by this PostHog instance by default\n     *       opt_out_capturing_by_default: false\n     *\n     *       // opt users out of browser data storage by this PostHog instance by default\n     *       opt_out_persistence_by_default: false\n     *\n     *       // persistence mechanism used by opt-in/opt-out methods - cookie\n     *       // or localStorage - falls back to cookie if localStorage is unavailable\n     *       opt_out_capturing_persistence_type: 'localStorage'\n     *\n     *       // customize the name of cookie/localStorage set by opt-in/opt-out methods\n     *       opt_out_capturing_cookie_prefix: null\n     *\n     *       // type of persistent store for super properties (cookie/\n     *       // localStorage) if set to 'localStorage', any existing\n     *       // posthog cookie value with the same persistence_name\n     *       // will be transferred to localStorage and deleted\n     *       persistence: 'cookie'\n     *\n     *       // name for super properties persistent store\n     *       persistence_name: ''\n     *\n     *       // names of properties/superproperties which should never\n     *       // be sent with capture() calls\n     *       property_blacklist: []\n     *\n     *       // if this is true, posthog cookies will be marked as\n     *       // secure, meaning they will only be transmitted over https\n     *       secure_cookie: false\n     *\n     *       // should we capture a page view on page load\n     *       capture_pageview: true\n     *\n     *       // if you set upgrade to be true, the library will check for\n     *       // a cookie from our old js library and import super\n     *       // properties from it, then the old cookie is deleted\n     *       // The upgrade config option only works in the initialization,\n     *       // so make sure you set it when you create the library.\n     *       upgrade: false\n     *\n     *       // if this is true, session recording is always disabled.\n     *       disable_session_recording: false,\n     *\n     *       // extra HTTP request headers to set for each API request, in\n     *       // the format {'Header-Name': value}\n     *       xhr_headers: {}\n     *\n     *       // protocol for fetching in-app message resources, e.g.\n     *       // 'https://' or 'http://'; defaults to '//' (which defers to the\n     *       // current page's protocol)\n     *       inapp_protocol: '//'\n     *\n     *       // whether to open in-app message link in new tab/window\n     *       inapp_link_new_window: false\n     *\n     *      // a set of rrweb config options that PostHog users can configure\n     *      // see https://github.com/rrweb-io/rrweb/blob/master/guide.md\n     *      session_recording: {\n     *         blockClass: 'ph-no-capture',\n     *         blockSelector: null,\n     *         ignoreClass: 'ph-ignore-input',\n     *         maskAllInputs: true,\n     *         maskInputOptions: {},\n     *         maskInputFn: null,\n     *         slimDOMOptions: {},\n     *         collectFonts: false\n     *      }\n     *\n     *      // prevent autocapture from capturing any attribute names on elements\n     *      mask_all_element_attributes: false\n     *\n     *      // prevent autocapture from capturing textContent on all elements\n     *      mask_all_text: false\n     *\n     *      // Anonymous users get a random UUID as their device by default.\n     *      // This option allows overriding that option.\n     *      get_device_id: (uuid) => uuid\n     *     }\n     *\n     *\n     * @param {Object} config A dictionary of new configuration values to update\n     */\n\n    set_config(config: Partial<PostHogConfig>): void {\n        const oldConfig = { ...this.config }\n        if (_isObject(config)) {\n            _extend(this.config, config)\n\n            if (!this.get_config('persistence_name')) {\n                this.config.persistence_name = this.config.cookie_name\n            }\n            if (!this.get_config('disable_persistence')) {\n                this.config.disable_persistence = this.config.disable_cookie\n            }\n\n            if (this.persistence) {\n                this.persistence.update_config(this.config)\n            }\n            if (this.sessionPersistence) {\n                this.sessionPersistence.update_config(this.config)\n            }\n            if (localStore.is_supported() && localStore.get('ph_debug') === 'true') {\n                this.config.debug = true\n            }\n            if (this.get_config('debug')) {\n                Config.DEBUG = true\n            }\n\n            if (this.sessionRecording && typeof config.disable_session_recording !== 'undefined') {\n                if (oldConfig.disable_session_recording !== config.disable_session_recording) {\n                    if (config.disable_session_recording) {\n                        this.sessionRecording.stopRecording()\n                    } else {\n                        this.sessionRecording.startRecordingIfEnabled()\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * turns session recording on, and updates the config option\n     * disable_session_recording to false\n     */\n    startSessionRecording(): void {\n        this.set_config({ disable_session_recording: false })\n    }\n\n    /**\n     * turns session recording off, and updates the config option\n     * disable_session_recording to true\n     */\n    stopSessionRecording(): void {\n        this.set_config({ disable_session_recording: true })\n    }\n\n    /**\n     * returns a boolean indicating whether session recording\n     * is currently running\n     */\n    sessionRecordingStarted(): boolean {\n        return !!this.sessionRecording?.started()\n    }\n\n    /**\n     * returns a boolean indicating whether the toolbar loaded\n     * @param toolbarParams\n     */\n\n    loadToolbar(params: ToolbarParams): boolean {\n        return this.toolbar.loadToolbar(params)\n    }\n\n    /**\n     * returns the current config object for the library.\n     */\n    get_config<K extends keyof PostHogConfig>(prop_name: K): PostHogConfig[K] {\n        return this.config?.[prop_name]\n    }\n\n    /**\n     * Returns the value of the super property named property_name. If no such\n     * property is set, get_property() will return the undefined value.\n     *\n     * ### Notes:\n     *\n     * get_property() can only be called after the PostHog library has finished loading.\n     * init() has a loaded function available to handle this automatically. For example:\n     *\n     *     // grab value for '$user_id' after the posthog library has loaded\n     *     posthog.init('YOUR PROJECT TOKEN', {\n     *         loaded: function(posthog) {\n     *             user_id = posthog.get_property('$user_id');\n     *         }\n     *     });\n     *\n     * @param {String} property_name The name of the super property you want to retrieve\n     */\n    get_property(property_name: string): Property | undefined {\n        return this.persistence['props'][property_name]\n    }\n\n    /**\n     * Returns the value of the session super property named property_name. If no such\n     * property is set, getSessionProperty() will return the undefined value.\n     *\n     * ### Notes:\n     *\n     * This is based on browser-level `sessionStorage`, NOT the PostHog session.\n     * getSessionProperty() can only be called after the PostHog library has finished loading.\n     * init() has a loaded function available to handle this automatically. For example:\n     *\n     *     // grab value for 'user_id' after the posthog library has loaded\n     *     posthog.init('YOUR PROJECT TOKEN', {\n     *         loaded: function(posthog) {\n     *             user_id = posthog.getSessionProperty('user_id');\n     *         }\n     *     });\n     *\n     * @param {String} property_name The name of the session super property you want to retrieve\n     */\n    getSessionProperty(property_name: string): Property | undefined {\n        return this.sessionPersistence['props'][property_name]\n    }\n\n    toString(): string {\n        let name = this.get_config('name') ?? PRIMARY_INSTANCE_NAME\n        if (name !== PRIMARY_INSTANCE_NAME) {\n            name = PRIMARY_INSTANCE_NAME + '.' + name\n        }\n        return name\n    }\n\n    // perform some housekeeping around GDPR opt-in/out state\n    _gdpr_init(): void {\n        const is_localStorage_requested = this.get_config('opt_out_capturing_persistence_type') === 'localStorage'\n\n        // try to convert opt-in/out cookies to localStorage if possible\n        if (is_localStorage_requested && localStore.is_supported()) {\n            if (!this.has_opted_in_capturing() && this.has_opted_in_capturing({ persistence_type: 'cookie' })) {\n                this.opt_in_capturing({ enable_persistence: false })\n            }\n            if (!this.has_opted_out_capturing() && this.has_opted_out_capturing({ persistence_type: 'cookie' })) {\n                this.opt_out_capturing({ clear_persistence: false })\n            }\n            this.clear_opt_in_out_capturing({\n                persistence_type: 'cookie',\n                enable_persistence: false,\n            })\n        }\n\n        // check whether the user has already opted out - if so, clear & disable persistence\n        if (this.has_opted_out_capturing()) {\n            this._gdpr_update_persistence({ clear_persistence: true })\n\n            // check whether we should opt out by default\n            // note: we don't clear persistence here by default since opt-out default state is often\n            //       used as an initial state while GDPR information is being collected\n        } else if (\n            !this.has_opted_in_capturing() &&\n            (this.get_config('opt_out_capturing_by_default') || cookieStore.get('ph_optout'))\n        ) {\n            cookieStore.remove('ph_optout')\n            this.opt_out_capturing({\n                clear_persistence: this.get_config('opt_out_persistence_by_default'),\n            })\n        }\n    }\n\n    /**\n     * Enable or disable persistence based on options\n     * only enable/disable if persistence is not already in this state\n     * @param {boolean} [options.clear_persistence] If true, will delete all data stored by the sdk in persistence and disable it\n     * @param {boolean} [options.enable_persistence] If true, will re-enable sdk persistence\n     */\n    _gdpr_update_persistence(options: Partial<OptInOutCapturingOptions>): void {\n        let disabled\n        if (options && options['clear_persistence']) {\n            disabled = true\n        } else if (options && options['enable_persistence']) {\n            disabled = false\n        } else {\n            return\n        }\n\n        if (!this.get_config('disable_persistence') && this.persistence.disabled !== disabled) {\n            this.persistence.set_disabled(disabled)\n        }\n        if (!this.get_config('disable_persistence') && this.sessionPersistence.disabled !== disabled) {\n            this.sessionPersistence.set_disabled(disabled)\n        }\n    }\n\n    // call a base gdpr function after constructing the appropriate token and options args\n    _gdpr_call_func<R = any>(\n        func: (token: string, options: GDPROptions) => R,\n        options?: Partial<OptInOutCapturingOptions>\n    ): R {\n        options = _extend(\n            {\n                capture: this.capture.bind(this),\n                persistence_type: this.get_config('opt_out_capturing_persistence_type'),\n                cookie_prefix: this.get_config('opt_out_capturing_cookie_prefix'),\n                cookie_expiration: this.get_config('cookie_expiration'),\n                cross_subdomain_cookie: this.get_config('cross_subdomain_cookie'),\n                secure_cookie: this.get_config('secure_cookie'),\n            },\n            options || {}\n        )\n\n        // check if localStorage can be used for recording opt out status, fall back to cookie if not\n        if (!localStore.is_supported() && options['persistence_type'] === 'localStorage') {\n            options['persistence_type'] = 'cookie'\n        }\n\n        return func(this.get_config('token'), {\n            capture: options['capture'],\n            captureEventName: options['capture_event_name'],\n            captureProperties: options['capture_properties'],\n            persistenceType: options['persistence_type'],\n            persistencePrefix: options['cookie_prefix'],\n            cookieExpiration: options['cookie_expiration'],\n            crossSubdomainCookie: options['cross_subdomain_cookie'],\n            secureCookie: options['secure_cookie'],\n        })\n    }\n\n    /**\n     * Opt the user in to data capturing and cookies/localstorage for this PostHog instance\n     *\n     * ### Usage\n     *\n     *     // opt user in\n     *     posthog.opt_in_capturing();\n     *\n     *     // opt user in with specific event name, properties, cookie configuration\n     *     posthog.opt_in_capturing({\n     *         capture_event_name: 'User opted in',\n     *         capture_event_properties: {\n     *             'Email': 'jdoe@example.com'\n     *         },\n     *         cookie_expiration: 30,\n     *         secure_cookie: true\n     *     });\n     *\n     * @param {Object} [options] A dictionary of config options to override\n     * @param {function} [options.capture] Function used for capturing a PostHog event to record the opt-in action (default is this PostHog instance's capture method)\n     * @param {string} [options.capture_event_name=$opt_in] Event name to be used for capturing the opt-in action\n     * @param {Object} [options.capture_properties] Set of properties to be captured along with the opt-in action\n     * @param {boolean} [options.enable_persistence=true] If true, will re-enable sdk persistence\n     * @param {string} [options.persistence_type=localStorage] Persistence mechanism used - cookie or localStorage - falls back to cookie if localStorage is unavailable\n     * @param {string} [options.cookie_prefix=__ph_opt_in_out] Custom prefix to be used in the cookie/localstorage name\n     * @param {Number} [options.cookie_expiration] Number of days until the opt-in cookie expires (overrides value specified in this PostHog instance's config)\n     * @param {boolean} [options.cross_subdomain_cookie] Whether the opt-in cookie is set as cross-subdomain or not (overrides value specified in this PostHog instance's config)\n     * @param {boolean} [options.secure_cookie] Whether the opt-in cookie is set as secure or not (overrides value specified in this PostHog instance's config)\n     */\n    opt_in_capturing(options?: Partial<OptInOutCapturingOptions>): void {\n        options = _extend(\n            {\n                enable_persistence: true,\n            },\n            options || {}\n        )\n\n        this._gdpr_call_func(optIn, options)\n        this._gdpr_update_persistence(options)\n    }\n\n    /**\n     * Opt the user out of data capturing and cookies/localstorage for this PostHog instance\n     *\n     * ### Usage\n     *\n     *     // opt user out\n     *     posthog.opt_out_capturing();\n     *\n     *     // opt user out with different cookie configuration from PostHog instance\n     *     posthog.opt_out_capturing({\n     *         cookie_expiration: 30,\n     *         secure_cookie: true\n     *     });\n     *\n     * @param {Object} [options] A dictionary of config options to override\n     * @param {boolean} [options.clear_persistence=true] If true, will delete all data stored by the sdk in persistence\n     * @param {string} [options.persistence_type=localStorage] Persistence mechanism used - cookie or localStorage - falls back to cookie if localStorage is unavailable\n     * @param {string} [options.cookie_prefix=__ph_opt_in_out] Custom prefix to be used in the cookie/localstorage name\n     * @param {Number} [options.cookie_expiration] Number of days until the opt-in cookie expires (overrides value specified in this PostHog instance's config)\n     * @param {boolean} [options.cross_subdomain_cookie] Whether the opt-in cookie is set as cross-subdomain or not (overrides value specified in this PostHog instance's config)\n     * @param {boolean} [options.secure_cookie] Whether the opt-in cookie is set as secure or not (overrides value specified in this PostHog instance's config)\n     */\n    opt_out_capturing(options?: Partial<OptInOutCapturingOptions>): void {\n        const _options = _extend(\n            {\n                clear_persistence: true,\n            },\n            options || {}\n        )\n\n        this._gdpr_call_func(optOut, _options)\n        this._gdpr_update_persistence(_options)\n    }\n\n    /**\n     * Check whether the user has opted in to data capturing and cookies/localstorage for this PostHog instance\n     *\n     * ### Usage\n     *\n     *     const has_opted_in = posthog.has_opted_in_capturing();\n     *     // use has_opted_in value\n     *\n     * @param {Object} [options] A dictionary of config options to override\n     * @param {string} [options.persistence_type=localStorage] Persistence mechanism used - cookie or localStorage - falls back to cookie if localStorage is unavailable\n     * @param {string} [options.cookie_prefix=__ph_opt_in_out] Custom prefix to be used in the cookie/localstorage name\n     * @returns {boolean} current opt-in status\n     */\n    has_opted_in_capturing(options?: Partial<OptInOutCapturingOptions>): boolean {\n        return this._gdpr_call_func(hasOptedIn, options)\n    }\n\n    /**\n     * Check whether the user has opted out of data capturing and cookies/localstorage for this PostHog instance\n     *\n     * ### Usage\n     *\n     *     const has_opted_out = posthog.has_opted_out_capturing();\n     *     // use has_opted_out value\n     *\n     * @param {Object} [options] A dictionary of config options to override\n     * @param {string} [options.persistence_type=localStorage] Persistence mechanism used - cookie or localStorage - falls back to cookie if localStorage is unavailable\n     * @param {string} [options.cookie_prefix=__ph_opt_in_out] Custom prefix to be used in the cookie/localstorage name\n     * @returns {boolean} current opt-out status\n     */\n    has_opted_out_capturing(options?: Partial<OptInOutCapturingOptions>): boolean {\n        return this._gdpr_call_func(hasOptedOut, options)\n    }\n\n    /**\n     * Clear the user's opt in/out status of data capturing and cookies/localstorage for this PostHog instance\n     *\n     * ### Usage\n     *\n     *     // clear user's opt-in/out status\n     *     posthog.clear_opt_in_out_capturing();\n     *\n     *     // clear user's opt-in/out status with specific cookie configuration - should match\n     *     // configuration used when opt_in_capturing/opt_out_capturing methods were called.\n     *     posthog.clear_opt_in_out_capturing({\n     *         cookie_expiration: 30,\n     *         secure_cookie: true\n     *     });\n     *\n     * @param {Object} [options] A dictionary of config options to override\n     * @param {boolean} [options.enable_persistence=true] If true, will re-enable sdk persistence\n     * @param {string} [options.persistence_type=localStorage] Persistence mechanism used - cookie or localStorage - falls back to cookie if localStorage is unavailable\n     * @param {string} [options.cookie_prefix=__ph_opt_in_out] Custom prefix to be used in the cookie/localstorage name\n     * @param {Number} [options.cookie_expiration] Number of days until the opt-in cookie expires (overrides value specified in this PostHog instance's config)\n     * @param {boolean} [options.cross_subdomain_cookie] Whether the opt-in cookie is set as cross-subdomain or not (overrides value specified in this PostHog instance's config)\n     * @param {boolean} [options.secure_cookie] Whether the opt-in cookie is set as secure or not (overrides value specified in this PostHog instance's config)\n     */\n    clear_opt_in_out_capturing(options?: Partial<OptInOutCapturingOptions>): void {\n        const _options: Partial<OptInOutCapturingOptions> = _extend(\n            {\n                enable_persistence: true,\n            },\n            options ?? {}\n        )\n        this._gdpr_call_func(clearOptInOut, _options)\n        this._gdpr_update_persistence(_options)\n    }\n\n    debug(debug?: boolean): void {\n        if (debug === false) {\n            window.console.log(\"You've disabled debug mode.\")\n            localStorage && localStorage.removeItem('ph_debug')\n            this.set_config({ debug: false })\n        } else {\n            window.console.log(\n                \"You're now in debug mode. All calls to PostHog will be logged in your console.\\nYou can disable this with `posthog.debug(false)`.\"\n            )\n            localStorage && localStorage.setItem('ph_debug', 'true')\n            this.set_config({ debug: true })\n        }\n    }\n}\n\n_safewrap_class(PostHog, ['identify'])\n\nconst instances: Record<string, PostHog> = {}\nconst extend_mp = function () {\n    // add all the sub posthog instances\n    _each(instances, function (instance, name) {\n        if (name !== PRIMARY_INSTANCE_NAME) {\n            posthog_master[name] = instance\n        }\n    })\n}\n\nconst override_ph_init_func = function () {\n    // we override the snippets init function to handle the case where a\n    // user initializes the posthog library after the script loads & runs\n    posthog_master['init'] = function (token?: string, config?: Partial<PostHogConfig>, name?: string) {\n        if (name) {\n            // initialize a sub library\n            if (!posthog_master[name]) {\n                posthog_master[name] = instances[name] = create_phlib(\n                    token || '',\n                    config || {},\n                    name,\n                    (instance: PostHog) => {\n                        posthog_master[name] = instances[name] = instance\n                        instance._loaded()\n                    }\n                )\n            }\n            return posthog_master[name]\n        } else {\n            let instance: PostHog = posthog_master as any as PostHog\n\n            if (instances[PRIMARY_INSTANCE_NAME]) {\n                // main posthog lib already initialized\n                instance = instances[PRIMARY_INSTANCE_NAME]\n            } else if (token) {\n                // intialize the main posthog lib\n                instance = create_phlib(token, config || {}, PRIMARY_INSTANCE_NAME, (instance: PostHog) => {\n                    instances[PRIMARY_INSTANCE_NAME] = instance\n                    instance._loaded()\n                })\n                instances[PRIMARY_INSTANCE_NAME] = instance\n            }\n\n            ;(posthog_master as any) = instance\n            if (init_type === InitType.INIT_SNIPPET) {\n                ;(window as any)[PRIMARY_INSTANCE_NAME] = posthog_master\n            }\n            extend_mp()\n            return instance\n        }\n    }\n}\n\nconst add_dom_loaded_handler = function () {\n    // Cross browser DOM Loaded support\n    function dom_loaded_handler() {\n        // function flag since we only want to execute this once\n        if ((dom_loaded_handler as any).done) {\n            return\n        }\n        ;(dom_loaded_handler as any).done = true\n\n        ENQUEUE_REQUESTS = false\n\n        _each(instances, function (inst: PostHog) {\n            inst._dom_loaded()\n        })\n    }\n\n    if (document.addEventListener) {\n        if (document.readyState === 'complete') {\n            // safari 4 can fire the DOMContentLoaded event before loading all\n            // external JS (including this file). you will see some copypasta\n            // on the internet that checks for 'complete' and 'loaded', but\n            // 'loaded' is an IE thing\n            dom_loaded_handler()\n        } else {\n            document.addEventListener('DOMContentLoaded', dom_loaded_handler, false)\n        }\n    }\n\n    // fallback handler, always will work\n    _register_event(window, 'load', dom_loaded_handler, true)\n}\n\nexport function init_from_snippet(): void {\n    init_type = InitType.INIT_SNIPPET\n    if (_isUndefined((window as any).posthog)) {\n        ;(window as any).posthog = []\n    }\n    posthog_master = (window as any).posthog\n\n    if (posthog_master['__loaded'] || (posthog_master['config'] && posthog_master['persistence'])) {\n        // lib has already been loaded at least once; we don't want to override the global object this time so bomb early\n        console.error('PostHog library has already been downloaded at least once.')\n        return\n    }\n\n    // Load instances of the PostHog Library\n    _each(posthog_master['_i'], function (item: [token: string, config: Partial<PostHogConfig>, name: string]) {\n        if (item && _isArray(item)) {\n            instances[item[2]] = create_phlib(...item)\n        }\n    })\n\n    override_ph_init_func()\n    ;(posthog_master['init'] as any)()\n\n    // Fire loaded events after updating the window's posthog object\n    _each(instances, function (instance) {\n        instance._loaded()\n    })\n\n    add_dom_loaded_handler()\n}\n\nexport function init_as_module(): PostHog {\n    init_type = InitType.INIT_MODULE\n    ;(posthog_master as any) = new PostHog()\n\n    override_ph_init_func()\n    ;(posthog_master['init'] as any)()\n    add_dom_loaded_handler()\n\n    return posthog_master as any\n}\n", "import { gzipSync, strToU8 } from 'fflate'\nimport { _base64Encode } from './utils'\nimport { Compression, CompressionData, XHROptions } from './types'\n\nexport function decideCompression(compressionSupport: Partial<Record<Compression, boolean>>): Compression {\n    if (compressionSupport[Compression.GZipJS]) {\n        return Compression.GZipJS\n    } else {\n        return Compression.Base64\n    }\n}\n\nexport function compressData(\n    compression: Compression,\n    jsonData: string,\n    options: XHROptions\n): [CompressionData | Uint8Array, XHROptions] {\n    if (compression === Compression.GZipJS) {\n        // :TRICKY: This returns an UInt8Array. We don't encode this to a string - returning a blob will do this for us.\n        return [\n            gzipSync(strToU8(jsonData), { mtime: 0 }),\n            { ...options, blob: true, urlQueryArgs: { compression: Compression.GZipJS } },\n        ]\n    } else {\n        return [{ data: _base64Encode(jsonData) }, options]\n    }\n}\n", "import { init_as_module } from './posthog-core'\nexport { PostHog } from './posthog-core'\nexport * from './types'\nexport const posthog = init_as_module()\nexport default posthog\n", "import d from \"./node_modules/posthog-js/dist/es.js\";export default d;\nexport * from \"./node_modules/posthog-js/dist/es.js\""],
  "mappings": "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",
  "names": ["Config", "DEBUG", "LIB_VERSION", "ArrayProto", "Array", "prototype", "ObjProto", "Object", "toString", "hasOwnProperty", "win", "window", "navigator", "userAgent", "document", "localDomains", "nativeForEach", "forEach", "nativeIndexOf", "indexOf", "nativeIsArray", "isArray", "breaker", "logger", "log", "_isUndefined", "console", "_len", "arguments", "length", "args", "_key", "apply", "err", "_eachArray", "arg", "error", "_len2", "_args", "_key2", "critical", "_len3", "_key3", "_trim", "str", "replace", "obj", "iterator", "thisArg", "i", "l", "call", "_each", "key", "_extend", "_len4", "_key5", "source", "prop", "_isArray", "_isFunction", "f", "test", "x", "_includes", "needle", "_isObject", "_isString", "_isNumber", "_encodeDates", "v", "k", "_formatDate", "d", "pad", "n", "getUTCFullYear", "getUTCMonth", "getUTCDate", "getUTCHours", "getUTCMinutes", "getUTCSeconds", "_safewrap", "_len5", "_key7", "this", "e", "_strip_empty_properties", "p", "ret", "LONG_STRINGS_ALLOW_LIST", "_copyAndTruncateStrings", "object", "maxStringLength", "value", "customizer", "slice", "COPY_IN_PROGRESS_SET", "Set", "internalDeepCircularCopy", "has", "add", "result", "it", "push", "val", "_base64Encode", "data", "h1", "h2", "h3", "h4", "bits", "b64", "ac", "enc", "tmp_arr", "_utf8Encode", "charCodeAt", "charAt", "join", "T", "string", "start", "end", "stringl", "utftext", "c1", "String", "fromCharCode", "substring", "_UUID", "Date", "valueOf", "se", "screen", "height", "width", "Math", "random", "ch", "ua", "buffer", "xor", "byte_array", "j", "tmp", "unshift", "UA", "_isBlockedUA", "_getQueryParam", "url", "param", "cleanParam", "results", "RegExp", "exec", "decodeURIComponent", "_getHashParam", "hash", "matches", "match", "_register_event", "fixEvent", "event", "preventDefault", "stopPropagation", "returnValue", "cancelBubble", "element", "type", "handler", "oldSchool", "useCapture", "addEventListener", "ontype", "old_handler", "new_handler", "old_handlers", "old_result", "new_result", "loadScript", "scriptUrlToLoad", "callback", "addScript", "scriptTag", "createElement", "src", "onload", "onerror", "_scripts$0$parentNode", "scripts", "querySelectorAll", "parentNode", "insertBefore", "body", "appendChild", "_info", "campaignParams", "customParams", "campaign_keywords", "concat", "params", "kwkey", "kw", "URL", "searchEngine", "referrer", "search", "searchInfo", "keyword", "browser", "user_agent", "vendor", "opera", "browserVersion", "regex", "Chrome", "Safari", "Opera", "Firefox", "Konqueror", "BlackBerry", "Mozilla", "parseFloat", "browserLanguage", "language", "userLanguage", "os", "os_name", "os_version", "device", "deviceType", "referringDomain", "parser", "href", "host", "properties", "_info$os", "$os", "$os_version", "$browser", "$device", "$device_type", "$current_url", "location", "$host", "$pathname", "pathname", "$browser_version", "$browser_language", "$screen_height", "$screen_width", "$viewport_height", "innerHeight", "$viewport_width", "innerWidth", "$lib", "$lib_version", "$insert_id", "$time", "now", "people_properties", "_info$os2", "getClassName", "el", "className", "baseVal", "getAttribute", "getSafeText", "elText", "shouldCaptureElement", "isSensitiveElement", "childNodes", "child", "isTextNode", "textContent", "split", "filter", "shouldCaptureValue", "isElementNode", "nodeType", "isTag", "tag", "tagName", "toLowerCase", "isDocumentFragment", "autocaptureCompatibleElements", "curEl", "classes", "name", "id", "includes", "getDirectAndNestedSpanText", "target", "text", "getNestedSpanText", "trim", "_child$tagName", "spanText", "RageClick", "enabled", "_classCallCheck", "clicks", "y", "timestamp", "lastClick", "abs", "DOMAIN_MATCH_REGEX", "cookieStore", "is_supported", "msg", "get", "nameEQ", "ca", "cookie", "c", "parse", "JSON", "set", "days", "cross_subdomain", "is_secure", "cdomain", "expires", "secure", "hostname", "domain", "date", "setTime", "getTime", "toUTCString", "new_cookie_val", "encodeURIComponent", "stringify", "remove", "_localStorage_supported", "localStore", "supported", "localStorage", "getItem", "setItem", "removeItem", "localPlusCookieStore", "_objectSpread", "extend", "distinct_id", "memoryStorage", "memoryStore", "sessionStorageSupported", "sessionStore", "sessionStorage", "PEOPLE_DISTINCT_ID_KEY", "ALIAS_ID_KEY", "EVENT_TIMERS_KEY", "AUTOCAPTURE_DISABLED_SERVER_SIDE", "SESSION_RECORDING_ENABLED_SERVER_SIDE", "CONSOLE_LOG_RECORDING_ENABLED_SERVER_SIDE", "SESSION_RECORDING_RECORDER_VERSION_SERVER_SIDE", "SESSION_ID", "ENABLED_FEATURE_FLAGS", "PERSISTENCE_EARLY_ACCESS_FEATURES", "STORED_PERSON_PROPERTIES_KEY", "STORED_GROUP_PROPERTIES_KEY", "USER_STATE", "RESERVED_PROPERTIES", "CASE_INSENSITIVE_PERSISTENCE_TYPES", "PostHogPersistence", "config", "token", "props", "campaign_params_saved", "custom_campaign_params", "storage_type", "storage", "user_state", "load", "update_config", "save", "_createClass", "_typeof", "keys", "found", "disabled", "entry", "expire_days", "default_value", "_this", "default_expiry", "hasChanges", "_this2", "register", "$referrer", "$referring_domain", "set_disabled", "set_cross_subdomain", "set_secure", "event_name", "timers", "state", "autocapture", "_initializedTokens", "_isAutocaptureEnabled", "_setIsAutocaptureEnabled", "instance", "disabled_server_side", "get_property", "enabled_client_side", "get_config", "_previousElementSibling", "previousElementSibling", "_el", "previousSibling", "_getAugmentPropertiesFromElement", "elem", "attributes", "attr", "propertyKey", "propertyValue", "_getPropertiesFromElement", "maskInputs", "maskText", "tag_name", "attributeName", "nthChild", "nthOfType", "currentElem", "_getDefaultProperties", "eventType", "$event_type", "$ce_version", "_extractCustomPropertyValue", "customProperty", "propValues", "matchedElem", "_getCustomProperties", "targetElementList", "_customProperties", "eventSelector", "eventElement", "_getEventTarget", "srcElement", "_e$target", "shadowRoot", "composedPath", "_captureEvent", "_this$rageclicks", "eventName", "MouseEvent", "rageclicks", "isRageClick", "clientX", "clientY", "autocaptureConfig", "url_allowlist", "allowlist", "some", "dom_event_allowlist", "element_allowlist", "elementType", "css_selector_allowlist", "selector", "parentIsUsefulElement", "compStyles", "getComputedStyle", "getPropertyValue", "elementsJson", "autocaptureAugmentProperties", "explicitNoCapture", "shouldCaptureEl", "augmentProperties", "$elements", "capture", "_navigate", "_addDomEventHandlers", "_this3", "init", "_this$config", "__autocapture", "map", "afterDecideResponse", "response", "persistence", "enabledForProject", "numBuckets", "numEnabledBuckets", "charCodeSum", "isBrowserSupported", "func", "bind", "GDPR_DEFAULT_PERSISTENCE_PREFIX", "optIn", "options", "_optInOut", "optOut", "hasOptedIn", "_getStorageValue", "hasOptedOut", "respectDnt", "nav", "hasDntOn", "dntValue", "clearOptInOut", "_getStorage", "_getStorageKey", "crossSubdomainCookie", "persistenceType", "persistencePrefix", "optValue", "cookieExpiration", "secureCookie", "captureEventName", "captureProperties", "send_instantly", "userOptedOut", "posthog", "silenceErrors", "optedOut", "addOptOutCheck", "method", "SET_ACTION", "PostHogPeople", "_posthog", "to", "set_action", "setPersonPropertiesForFlags", "_get_config", "sessionPersistence", "update_referrer_info", "get_referrer_info", "_send_request", "set_once", "set_once_action", "get_distinct_id", "device_id", "user_id", "had_persisted_distinct_id", "date_encoded_data", "truncated_data", "encoded_data", "_prepare_callback", "conf_var", "apiActionParser", "actionType", "_is_reserved_property", "PERSISTENCE_ACTIVE_FEATURE_FLAGS", "PERSISTENCE_OVERRIDE_FEATURE_FLAGS", "PERSISTENCE_FEATURE_FLAG_PAYLOADS", "filterActiveFeatureFlags", "featureFlags", "_step", "activeFeatureFlags", "_iterator", "_createForOfIteratorHelper", "ownProps", "resArray", "s", "done", "_step$value", "_slicedToArray", "PostHogFeatureFlags", "_override_warning", "flagCallReported", "featureFlagEventHandlers", "reloadFeatureFlagsQueued", "reloadFeatureFlagsInAction", "getFlagVariants", "enabledFlags", "overriddenFlags", "finalFlags", "overriddenKeys", "warn", "_startReloadTimer", "anon_distinct_id", "$anon_distinct_id", "isPaused", "setTimeout", "_reloadFeatureFlagsRequest", "setReloadingPaused", "personProperties", "groupProperties", "groups", "getGroups", "person_properties", "group_properties", "receivedFeatureFlags", "getFlags", "flagValue", "send_event", "$feature_flag", "$feature_flag_response", "getFlagPayloads", "getFeatureFlag", "h", "decideEndpointWasHit", "currentFlags", "currentFlagPayloads", "flags", "flagPayloads", "_persistence$register", "$enabled_feature_flags", "_persistence$register2", "newFeatureFlags", "newFeatureFlagPayloads", "errorsWhileComputingFlags", "_fireFeatureFlagsCallbacks", "unregister", "flagsObj", "addFeatureFlagsHandler", "_this$_prepareFeature", "_prepareFeatureFlagsForCallbacks", "flagVariants", "removeFeatureFlagsHandler", "isEnrolled", "_this$instance$persis3", "enrollmentPersonProp", "_defineProperty", "$feature_enrollment", "$set", "newFlags", "_this4", "force_reload", "existing_early_access_features", "earlyAccessFeatures", "flag", "variantKey", "reduce", "res", "_this$_prepareFeature2", "reloadFeatureFlags", "existingProperties", "groupType", "group_type", "replacementImageURI", "FULL_SNAPSHOT_EVENT_TYPE", "META_EVENT_TYPE", "PLUGIN_EVENT_TYPE", "CONSOLE_LOG_PLUGIN_NAME", "IncrementalSource", "BASE_ENDPOINT", "ACTIVE_SOURCES", "MouseMove", "MouseInteraction", "Scroll", "ViewportResize", "Input", "TouchMove", "MediaInteraction", "Drag", "SessionRecording", "captureStarted", "snapshots", "emit", "endpoint", "stopRrweb", "windowId", "sessionId", "receivedDecide", "isRecordingEnabled", "startCaptureAndTrySendingQueuedSnapshots", "stopRecording", "enabled_server_side", "_this$instance$get_co", "recordingVersion_server_side", "recorderVersion", "_response$sessionReco3", "_response$sessionReco5", "_response$sessionReco", "_response$sessionReco2", "_this$instance$persis", "_response$sessionReco4", "sessionRecording", "consoleLogRecordingEnabled", "startRecordingIfEnabled", "_captureSnapshot", "_startCapture", "assign", "sessionManager", "checkAndGetSessionAndWindowId", "recorderJS", "getRecordingVersion", "__loaded_recorder_version", "_onScriptLoaded", "_event$data", "isUserInteraction", "_isInteractiveEvent", "isIdle", "lastActivityTimestamp", "_tryTakeFullSnapshot", "_this$instance$sessio", "_this$rrwebRecord", "rrwebRecord", "takeFullSnapshot", "sessionRecordingOptions", "blockClass", "blockSelector", "ignoreClass", "maskTextClass", "maskTextSelector", "maskAllInputs", "maskInputOptions", "maskInputFn", "slimDOMOptions", "collectFonts", "inlineStylesheet", "recordCrossOriginIframes", "rrweb", "record", "userSessionRecordingOptions", "entries", "_i", "_Object$entries", "_Object$entries$_i", "onRRwebEmit", "plugins", "rrwebConsoleRecord", "isConsoleLogCaptureEnabled", "getRecordConsolePlugin", "_addCaptureHook", "_this3$rrwebRecord", "addCustomEvent", "plugin", "payload", "updatedPayload", "stringifiedData", "matchAll", "toLocaleLowerCase", "_updateWindowAndSessionIds", "$snapshot_data", "$session_id", "$window_id", "_captureMetrics", "incr", "transport", "_noTruncate", "_batchKey", "_metrics", "rrweb_full_snapshot", "PERFORMANCE_EVENTS_MAPPING", "entryType", "timeOrigin", "startTime", "redirectStart", "redirectEnd", "workerStart", "fetchStart", "domainLookupStart", "domainLookupEnd", "connectStart", "secureConnectionStart", "connectEnd", "requestStart", "responseStart", "responseEnd", "decodedBodySize", "encodedBodySize", "initiatorType", "nextHopProtocol", "renderBlockingStatus", "responseStatus", "transferSize", "renderTime", "loadTime", "size", "domComplete", "domContentLoadedEvent", "domInteractive", "loadEventEnd", "loadEventStart", "redirectCount", "navigationType", "unloadEventEnd", "unloadEventStart", "duration", "ENTRY_TYPES_TO_OBSERVE", "POSTHOG_PATHS_TO_IGNORE", "WebPerformanceObserver", "isEnabled", "startObserving", "stopObserving", "_window", "_window$PerformanceOb", "observer", "supportedEntryTypes", "PerformanceObserver", "_forceAllowLocalhost", "list", "getEntries", "_capturePerformanceEvent", "entryTypes", "_this$observer", "observe", "buffered", "disconnect", "_ref", "remoteEnabled", "capturePerformance", "path", "find", "networkRequest", "maskNetworkRequestFn", "eventJson", "toJSON", "floor", "performance", "capturePerformanceEvent", "exposesServerTiming", "serverTiming", "_this$capturePerforma", "timing", "Decide", "_hasBootstrappedFeatureFlags", "verbose", "parseDecideResponse", "_this$instance$webPer", "_this$instance$except", "status", "toolbar", "webPerformance", "exceptionAutocapture", "compression", "_step2", "apiHost", "_loop", "_step2$value", "scriptUrl", "_iterator2", "POSTHOG_MANAGED_HOSTS", "Toolbar", "toolbarParams", "toolbarVersion", "loadToolbar", "history", "stateHash", "replaceState", "title", "userIntent", "timestampToNearestThirtySeconds", "toolbarUrl", "endsWith", "disableToolbarMetrics", "apiURL", "instrument", "paramsToPersist", "_objectWithoutProperties", "_excluded", "maybeLoadToolbar", "RequestQueueScaffold", "pollInterval", "isPolling", "_event_queue", "_empty_queue_count", "_poller", "_pollInterval", "interval", "poll", "RequestQueue", "_RequestQueueScaffold", "_inherits", "_super", "_createSuper", "captureMetrics", "handlePollRequest", "clearTimeout", "requests", "formatQueue", "_", "dataKey", "requestValues", "values", "r", "request", "CaptureMetrics", "metrics", "by", "u8", "Uint8Array", "u16", "Uint16Array", "u32", "Uint32Array", "fleb", "fdeb", "clim", "freb", "eb", "b", "_a", "fl", "revfl", "revfd", "rev", "hMap", "cd", "mb", "co", "le", "rvb", "sv", "r_1", "m", "flt", "fdt", "flm", "Compression", "fdm", "shft", "slc", "subarray", "wbits", "o", "wbits16", "hTree", "t", "t2", "sort", "a", "i0", "i1", "i2", "maxSym", "tr", "mbt", "ln", "dt", "lft", "cst", "i2_1", "i2_2", "i2_3", "max", "lc", "cl", "cli", "cln", "cls", "w", "clen", "cf", "wfblk", "out", "pos", "dat", "wblk", "final", "syms", "lf", "df", "li", "bs", "bl", "dlt", "mlb", "_b", "ddt", "mdb", "_c", "lclt", "nlc", "_d", "lcdt", "ndc", "lcfreq", "_e", "lct", "mlcb", "nlcc", "lm", "ll", "dm", "dl", "flen", "ftlen", "dtlen", "llm", "lcts", "clct", "len", "dst", "deo", "et", "crct", "crc", "cr", "dopt", "opt", "pre", "post", "st", "lvl", "plvl", "lst", "msk_1", "prev", "head", "bs1_1", "ceil", "bs2_1", "hsh", "lc_1", "wi", "hv", "imod", "pimod", "rem", "ch_1", "dif", "maxn", "min", "maxd", "ml", "nl", "mmd", "md", "ti", "lin", "din", "level", "mem", "wbytes", "gzh", "fn", "filename", "mtime", "gzhl", "gzipSync", "opts", "strToU8", "latin1", "TextEncoder", "encode", "ar", "ai", "addParamsToURL", "urlQueryArgs", "parameterOptions", "halves", "argSeparator", "formdata", "use_val", "use_key", "arg_separator", "tph_arr", "encodePostData", "blob", "Blob", "sendBeacon", "body_data", "xhr", "headers", "retriesPerformedSoFar", "retryQueue", "onXHRError", "_ref$timeout", "timeout", "req", "XMLHttpRequest", "open", "headerValue", "headerName", "setRequestHeader", "withCredentials", "onreadystatechange", "readyState", "decr", "responseText", "enqueue", "send", "RetryQueue", "queue", "areWeOnline", "onLine", "_handleWeAreNowOnline", "requestData", "msToNextRetry", "pow", "retryAt", "flush", "toFlush", "_ref2", "_executeXhrRequest", "_ref3", "SESSION_CHANGE_THRESHOLD", "SESSION_LENGTH_LIMIT", "SessionIdManager", "_windowId", "_sessionId", "_sessionStartTimestamp", "_sessionActivityTimestamp", "persistenceName", "window_id_storage_key", "primary_window_exists_storage_key", "_canUseSessionStorage", "lastWindowId", "primaryWindowExists", "_listenToReloadWindow", "sessionActivityTimestamp", "sessionStartTimestamp", "_setSessionId", "readOnly", "_this$_getSessionId2", "_getSessionId", "lastTimestamp", "startTimestamp", "_getWindowId", "sessionPastMaximumLength", "newTimestamp", "_setWindowId", "SentryIntegration", "organization", "projectId", "prefix", "setupOnce", "addGlobalEventProcessor", "_event$exception", "_exceptions$", "_exceptions$2", "_exceptions$3", "_exceptions$4", "__loaded", "tags", "ui_host", "api_host", "sessionRecordingStarted", "get_session_replay_url", "withTimestamp", "exceptions", "exception", "$exception_message", "$exception_type", "$exception_personURL", "$sentry_event_id", "event_id", "$sentry_exception", "$sentry_exception_message", "$sentry_exception_type", "u", "$sentry_tags", "createSegmentIntegration", "enrichEvent", "ctx", "userId", "anonymousId", "reset", "additionalProperties", "_calculate_event_properties", "version", "isLoaded", "Promise", "resolve", "track", "page", "identify", "PageViewIdManager", "_seenFirstPageView", "_pageViewId", "isEvent", "candidate", "Event", "isInstanceOf", "base", "isBuiltin", "isDOMError", "WEBPACK_ERROR_REGEXP", "STACKTRACE_FRAME_LIMIT", "UNKNOWN_FUNCTION", "createFrame", "lineno", "colno", "frame", "function", "in_app", "chromeRegex", "chromeEvalRegex", "geckoREgex", "geckoEvalRegex", "winjsRegex", "defaultStackParser", "parsers", "sortedParsers", "stack", "skipFirst", "frames", "lines", "line", "cleanedLine", "localStack", "reverse", "parts", "subMatch", "_extractSafariExtensi2", "extractSafariExtensionDetails", "undefined", "_extractSafariExtensi4", "isSafariExtension", "isSafariWebExtension", "ERROR_TYPES_PATTERN", "reactMinifiedRegexp", "parseStackFrames", "ex", "stacktrace", "popSize", "framesToPop", "message", "errorPropertiesFromError", "$exception_stack_trace_raw", "extractExceptionKeysForMessage", "maxLength", "serialized", "errorToProperties", "errorProperties", "domException", "code", "Error", "constructor", "$exception_is_synthetic", "$exception_source", "$exception_lineno", "$exception_colno", "unhandledRejectionToProperties", "ev", "reason", "detail", "_oO", "$exception_handled", "InitType", "init_type", "posthog_master", "ExceptionObserver", "_window$onerror", "__POSTHOG_INSTRUMENTED__", "originalOnErrorHandler", "captureException", "originalOnUnhandledRejectionHandler", "onunhandledrejection", "sendExceptionEvent", "stopCapturing", "_window$onerror2", "_window$onunhandledre", "_window$onerror3", "_this$remoteEnabled", "autocaptureExceptions", "startCapturing", "propertiesToSend", "posthogHost", "__NOOP", "__NOOPTIONS", "PRIMARY_INSTANCE_NAME", "USE_XHR", "ENQUEUE_REQUESTS", "defaultConfig", "_document$location", "_document$location$ho", "_window$location", "api_method", "api_transport", "rageclick", "cross_subdomain_cookie", "persistence_name", "cookie_name", "loaded", "store_google", "save_referrer", "capture_pageview", "capture_pageleave", "debug", "cookie_expiration", "upgrade", "disable_session_recording", "disable_persistence", "disable_cookie", "enable_recording_console_log", "secure_cookie", "protocol", "ip", "opt_out_capturing_by_default", "opt_out_persistence_by_default", "opt_out_capturing_persistence_type", "opt_out_capturing_cookie_prefix", "opt_in_site_apps", "property_blacklist", "respect_dnt", "sanitize_properties", "xhr_headers", "inapp_protocol", "inapp_link_new_window", "request_batching", "properties_string_max_length", "session_recording", "mask_all_element_attributes", "mask_all_text", "advanced_disable_decide", "advanced_disable_toolbar_metrics", "on_xhr_error", "statusText", "get_device_id", "uuid", "_onCapture", "_capture_metrics", "capture_performance", "callback_fn", "bootstrap", "disable_compression", "create_phlib", "createComplete", "callbacksHandled", "initComplete", "syncCode", "handleCallback", "callbackName", "INIT_MODULE", "PostHog", "_init", "startObservingIfEnabled", "_execute_array", "people", "segmentIntegration", "__captureHooks", "__request_queue", "_jsc", "feature_flags", "pageViewIdManager", "_requestQueue", "_retryQueue", "_loaded", "_window$rrweb", "_config$bootstrap", "_triggered_notifs", "_window$rrweb2", "segmentRegister", "updateInitComplete", "set_config", "_handle_queued_event", "_gdpr_init", "segment", "user", "set_user_state", "then", "distinctID", "_config$bootstrap2", "_config$bootstrap3", "deviceID", "isIdentifiedID", "$device_id", "_config$bootstrap4", "_config$bootstrap7", "activeFlags", "_config$bootstrap5", "_config$bootstrap5$fe", "_config$bootstrap6", "_config$bootstrap6$fe", "featureFlagPayloads", "g", "_config$bootstrap8", "_config$bootstrap8$fe", "_config$bootstrap9", "_config$bootstrap9$fe", "register_once", "self", "_handle_unload", "_start_queue_if_opted_in", "resetRequestQueue", "has_opted_out_capturing", "item", "_toConsumableArray", "jsc", "randomized_cb", "callback_string", "updateUnloadMetrics", "unload", "jsonData", "__compress_and_send_json_request", "compressData", "GZipJS", "Base64", "_compressData2", "_compressData", "_options", "DEFAULT_OPTIONS", "useSendBeacon", "_s$parentNode", "script", "async", "defer", "getElementsByTagName", "array", "fn_name", "alias_calls", "other_calls", "capturing_calls", "execute", "calls", "caller", "_this$config$bootstra", "_this$config$bootstra2", "_this$exceptionAutoca", "update_search_keyword", "update_campaign_params", "has_unique_traits", "_invokeCaptureHooks", "eventData", "event_properties", "_this$webPerformance", "start_timestamp", "remove_event_timer", "persistenceProps", "infoProperties", "_this$sessionManager$", "onPageview", "$pageview_id", "getPageViewId", "duration_in_ms", "toFixed", "blacklisted_prop", "property", "getFeatureFlagPayload", "_unused", "isFeatureEnabled", "updateEarlyAccessFeatureEnrollment", "getEarlyAccessFeatures", "onFeatureFlags", "new_distinct_id", "userPropertiesToSet", "userPropertiesToSetOnce", "previous_distinct_id", "$user_id", "$had_persisted_distinct_id", "isKnownAnonymous", "get_user_state", "$set_once", "setAnonymousDistinctId", "groupKey", "groupPropertiesToSet", "existingGroups", "resetGroupPropertiesForFlags", "$groups", "$group_type", "$group_key", "$group_set", "setGroupPropertiesForFlags", "resetPersonPropertiesForFlags", "reset_device_id", "clear", "resetSessionId", "get_session_id", "_options$timestampLoo", "LOOK_BACK", "timestampLookBack", "recordingStartTime", "alias", "original", "_register_single", "oldConfig", "_this$sessionRecordin", "started", "prop_name", "property_name", "_this$get_config", "has_opted_in_capturing", "persistence_type", "opt_in_capturing", "enable_persistence", "opt_out_capturing", "clear_persistence", "clear_opt_in_out_capturing", "_gdpr_update_persistence", "cookie_prefix", "_gdpr_call_func", "klass", "functions", "instances", "override_ph_init_func", "INIT_SNIPPET", "add_dom_loaded_handler", "dom_loaded_handler", "inst", "_dom_loaded"]
}
